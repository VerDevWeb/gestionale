var GR=Object.defineProperty,Y$=Object.defineProperties;var J$=Object.getOwnPropertyDescriptors;var zR=Object.getOwnPropertySymbols,X$=Object.getPrototypeOf,Z$=Object.prototype.hasOwnProperty,e3=Object.prototype.propertyIsEnumerable,t3=Reflect.get;var qR=(n,e,t)=>e in n?GR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,q=(n,e)=>{for(var t in e||={})Z$.call(e,t)&&qR(n,t,e[t]);if(zR)for(var t of zR(e))e3.call(e,t)&&qR(n,t,e[t]);return n},Qe=(n,e)=>Y$(n,J$(e));var n3=(n,e)=>{for(var t in e)GR(n,t,{get:e[t],enumerable:!0})};var Xr=(n,e,t)=>t3(X$(n),t,e);var g=(n,e,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(n,e)).next())});var WR=null;var Jv=1,Xv=Symbol("SIGNAL");function Fe(n){let e=WR;return WR=n,e}var KR={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function r3(n){if(!(tw(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Jv)){if(!n.producerMustRecompute(n)&&!Zv(n)){n.dirty=!1,n.lastCleanEpoch=Jv;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Jv}}function QR(n){return n&&(n.nextProducerIndex=0),Fe(n)}function YR(n,e){if(Fe(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(tw(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)ew(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Zv(n){op(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(r3(t),r!==t.version))return!0}return!1}function JR(n){if(op(n),tw(n))for(let e=0;e<n.producerNode.length;e++)ew(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function ew(n,e){if(i3(n),op(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)ew(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];op(i),i.producerIndexOfThis[r]=e}}function tw(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function op(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function i3(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function s3(){throw new Error}var o3=s3;function XR(n){o3=n}function ge(n){return typeof n=="function"}function sc(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ap=sc(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function $u(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var $t=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ge(r))try{r()}catch(s){e=s instanceof ap?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{ZR(s)}catch(o){e=e??[],o instanceof ap?e=[...e,...o.errors]:e.push(o)}}if(e)throw new ap(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ZR(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&$u(t,e)}remove(e){let{_finalizers:t}=this;t&&$u(t,e),e instanceof n&&e._removeParent(this)}};$t.EMPTY=(()=>{let n=new $t;return n.closed=!0,n})();var nw=$t.EMPTY;function cp(n){return n instanceof $t||n&&"closed"in n&&ge(n.remove)&&ge(n.add)&&ge(n.unsubscribe)}function ZR(n){ge(n)?n():n.unsubscribe()}var Rr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var oc={setTimeout(n,e,...t){let{delegate:r}=oc;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=oc;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function lp(n){oc.setTimeout(()=>{let{onUnhandledError:e}=Rr;if(e)e(n);else throw n})}function Hu(){}var ek=rw("C",void 0,void 0);function tk(n){return rw("E",void 0,n)}function nk(n){return rw("N",n,void 0)}function rw(n,e,t){return{kind:n,value:e,error:t}}var ko=null;function ac(n){if(Rr.useDeprecatedSynchronousErrorHandling){let e=!ko;if(e&&(ko={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ko;if(ko=null,t)throw r}}else n()}function rk(n){Rr.useDeprecatedSynchronousErrorHandling&&ko&&(ko.errorThrown=!0,ko.error=n)}var No=class extends $t{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,cp(e)&&e.add(this)):this.destination=l3}static create(e,t,r){return new cc(e,t,r)}next(e){this.isStopped?sw(nk(e),this):this._next(e)}error(e){this.isStopped?sw(tk(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?sw(ek,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},a3=Function.prototype.bind;function iw(n,e){return a3.call(n,e)}var ow=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){up(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){up(r)}else up(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){up(t)}}},cc=class extends No{constructor(e,t,r){super();let i;if(ge(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Rr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&iw(e.next,s),error:e.error&&iw(e.error,s),complete:e.complete&&iw(e.complete,s)}):i=e}this.destination=new ow(i)}};function up(n){Rr.useDeprecatedSynchronousErrorHandling?rk(n):lp(n)}function c3(n){throw n}function sw(n,e){let{onStoppedNotification:t}=Rr;t&&oc.setTimeout(()=>t(n,e))}var l3={closed:!0,next:Hu,error:c3,complete:Hu};var lc=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Xn(n){return n}function aw(...n){return cw(n)}function cw(n){return n.length===0?Xn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Le=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=d3(t)?t:new cc(t,r,i);return ac(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=ik(r),new r((i,s)=>{let o=new cc({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[lc](){return this}pipe(...t){return cw(t)(this)}toPromise(t){return t=ik(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function ik(n){var e;return(e=n??Rr.Promise)!==null&&e!==void 0?e:Promise}function u3(n){return n&&ge(n.next)&&ge(n.error)&&ge(n.complete)}function d3(n){return n&&n instanceof No||u3(n)&&cp(n)}function lw(n){return ge(n?.lift)}function Pe(n){return e=>{if(lw(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function De(n,e,t,r,i){return new uw(n,e,t,r,i)}var uw=class extends No{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function uc(){return Pe((n,e)=>{let t=null;n._refCount++;let r=De(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var dc=class extends Le{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,lw(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new $t;let t=this.getSubject();e.add(this.source.subscribe(De(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=$t.EMPTY)}return e}refCount(){return uc()(this)}};var sk=sc(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ln=(()=>{class n extends Le{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new dp(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new sk}next(t){ac(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){ac(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ac(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?nw:(this.currentObservers=null,s.push(t),new $t(()=>{this.currentObservers=null,$u(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Le;return t.source=this,t}}return n.create=(e,t)=>new dp(e,t),n})(),dp=class extends ln{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:nw}};var Ae=class extends ln{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Zn=new Le(n=>n.complete());function ok(n){return n&&ge(n.schedule)}function ak(n){return n[n.length-1]}function hp(n){return ge(ak(n))?n.pop():void 0}function ws(n){return ok(ak(n))?n.pop():void 0}function fp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function lk(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{l(r.next(d))}catch(h){o(h)}}function c(d){try{l(r.throw(d))}catch(h){o(h)}}function l(d){d.done?s(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function ck(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Po(n){return this instanceof Po?(this.v=n,this):new Po(n)}function uk(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(E){return Promise.resolve(E).then(_,h)}}function a(_,E){r[_]&&(i[_]=function(A){return new Promise(function(R,U){s.push([_,A,R,U])>1||c(_,A)})},E&&(i[_]=E(i[_])))}function c(_,E){try{l(r[_](E))}catch(A){p(s[0][3],A)}}function l(_){_.value instanceof Po?Promise.resolve(_.value.v).then(d,h):p(s[0][2],_)}function d(_){c("next",_)}function h(_){c("throw",_)}function p(_,E){_(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function dk(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ck=="function"?ck(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var pp=n=>n&&typeof n.length=="number"&&typeof n!="function";function mp(n){return ge(n?.then)}function gp(n){return ge(n[lc])}function _p(n){return Symbol.asyncIterator&&ge(n?.[Symbol.asyncIterator])}function yp(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function h3(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var vp=h3();function wp(n){return ge(n?.[vp])}function Ep(n){return uk(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Po(t.read());if(i)return yield Po(void 0);yield yield Po(r)}}finally{t.releaseLock()}})}function Ip(n){return ge(n?.getReader)}function Rt(n){if(n instanceof Le)return n;if(n!=null){if(gp(n))return f3(n);if(pp(n))return p3(n);if(mp(n))return m3(n);if(_p(n))return hk(n);if(wp(n))return g3(n);if(Ip(n))return _3(n)}throw yp(n)}function f3(n){return new Le(e=>{let t=n[lc]();if(ge(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function p3(n){return new Le(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function m3(n){return new Le(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,lp)})}function g3(n){return new Le(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function hk(n){return new Le(e=>{y3(n,e).catch(t=>e.error(t))})}function _3(n){return hk(Ep(n))}function y3(n,e){var t,r,i,s;return lk(this,void 0,void 0,function*(){try{for(t=dk(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Vn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function bp(n,e=0){return Pe((t,r)=>{t.subscribe(De(r,i=>Vn(r,n,()=>r.next(i),e),()=>Vn(r,n,()=>r.complete(),e),i=>Vn(r,n,()=>r.error(i),e)))})}function Cp(n,e=0){return Pe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function fk(n,e){return Rt(n).pipe(Cp(e),bp(e))}function pk(n,e){return Rt(n).pipe(Cp(e),bp(e))}function mk(n,e){return new Le(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function gk(n,e){return new Le(t=>{let r;return Vn(t,e,()=>{r=n[vp](),Vn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ge(r?.return)&&r.return()})}function Tp(n,e){if(!n)throw new Error("Iterable cannot be null");return new Le(t=>{Vn(t,e,()=>{let r=n[Symbol.asyncIterator]();Vn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function _k(n,e){return Tp(Ep(n),e)}function yk(n,e){if(n!=null){if(gp(n))return fk(n,e);if(pp(n))return mk(n,e);if(mp(n))return pk(n,e);if(_p(n))return Tp(n,e);if(wp(n))return gk(n,e);if(Ip(n))return _k(n,e)}throw yp(n)}function ft(n,e){return e?yk(n,e):Rt(n)}function pe(...n){let e=ws(n);return ft(n,e)}function hc(n,e){let t=ge(n)?n:()=>n,r=i=>i.error(t());return new Le(e?i=>e.schedule(r,0,i):r)}function dw(n){return!!n&&(n instanceof Le||ge(n.lift)&&ge(n.subscribe))}var zi=sc(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function xe(n,e){return Pe((t,r)=>{let i=0;t.subscribe(De(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:v3}=Array;function w3(n,e){return v3(e)?n(...e):n(e)}function Sp(n){return xe(e=>w3(n,e))}var{isArray:E3}=Array,{getPrototypeOf:I3,prototype:b3,keys:C3}=Object;function Dp(n){if(n.length===1){let e=n[0];if(E3(e))return{args:e,keys:null};if(T3(e)){let t=C3(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function T3(n){return n&&typeof n=="object"&&I3(n)===b3}function Ap(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function zu(...n){let e=ws(n),t=hp(n),{args:r,keys:i}=Dp(n);if(r.length===0)return ft([],e);let s=new Le(S3(r,e,i?o=>Ap(i,o):Xn));return t?s.pipe(Sp(t)):s}function S3(n,e,t=Xn){return r=>{vk(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)vk(e,()=>{let l=ft(n[c],e),d=!1;l.subscribe(De(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function vk(n,e,t){n?Vn(t,n,e):e()}function wk(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,h=!1,p=()=>{h&&!c.length&&!l&&e.complete()},_=A=>l<r?E(A):c.push(A),E=A=>{s&&e.next(A),l++;let R=!1;Rt(t(A,d++)).subscribe(De(e,U=>{i?.(U),s?_(U):e.next(U)},()=>{R=!0},void 0,()=>{if(R)try{for(l--;c.length&&l<r;){let U=c.shift();o?Vn(e,o,()=>E(U)):E(U)}p()}catch(U){e.error(U)}}))};return n.subscribe(De(e,_,()=>{h=!0,p()})),()=>{a?.()}}function kt(n,e,t=1/0){return ge(e)?kt((r,i)=>xe((s,o)=>e(r,s,i,o))(Rt(n(r,i))),t):(typeof e=="number"&&(t=e),Pe((r,i)=>wk(r,i,n,t)))}function fc(n=1/0){return kt(Xn,n)}function Ek(){return fc(1)}function pc(...n){return Ek()(ft(n,ws(n)))}function xp(n){return new Le(e=>{Rt(n()).subscribe(e)})}function hw(...n){let e=hp(n),{args:t,keys:r}=Dp(n),i=new Le(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let d=0;d<o;d++){let h=!1;Rt(t[d]).subscribe(De(s,p=>{h||(h=!0,l--),a[d]=p},()=>c--,void 0,()=>{(!c||!h)&&(l||s.next(r?Ap(r,a):a),s.complete())}))}});return e?i.pipe(Sp(e)):i}function ur(n,e){return Pe((t,r)=>{let i=0;t.subscribe(De(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Es(n){return Pe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(De(t,void 0,void 0,o=>{s=Rt(n(o,Es(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function Ik(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(De(o,d=>{let h=l++;c=a?n(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function Mo(n,e){return ge(e)?kt(n,e,1):kt(n,1)}function Is(n){return Pe((e,t)=>{let r=!1;e.subscribe(De(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function qi(n){return n<=0?()=>Zn:Pe((e,t)=>{let r=0;e.subscribe(De(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function fw(n){return xe(()=>n)}function Rp(n=D3){return Pe((e,t)=>{let r=!1;e.subscribe(De(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function D3(){return new zi}function qu(n){return Pe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Zr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ur((i,s)=>n(i,s,r)):Xn,qi(1),t?Is(e):Rp(()=>new zi))}function mc(n){return n<=0?()=>Zn:Pe((e,t)=>{let r=[];e.subscribe(De(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function pw(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ur((i,s)=>n(i,s,r)):Xn,mc(1),t?Is(e):Rp(()=>new zi))}function mw(n,e){return Pe(Ik(n,e,arguments.length>=2,!0))}function gw(...n){let e=ws(n);return Pe((t,r)=>{(e?pc(n,t,e):pc(n,t)).subscribe(r)})}function dr(n,e){return Pe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(De(r,c=>{i?.unsubscribe();let l=0,d=s++;Rt(n(c,d)).subscribe(i=De(r,h=>r.next(e?e(c,h,d,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function _w(n){return Pe((e,t)=>{Rt(n).subscribe(De(t,()=>t.complete(),Hu)),!t.closed&&e.subscribe(t)})}function tn(n,e,t){let r=ge(n)||e||t?{next:n,error:e,complete:t}:n;return r?Pe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(De(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Xn}var aN="https://g.co/ng/security#xss",oe=class extends Error{constructor(e,t){super(v0(e,t)),this.code=e}};function v0(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function id(n){return{toString:n}.toString()}var kp="__parameters__";function A3(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function cN(n,e,t){return id(()=>{let r=A3(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let h=c.hasOwnProperty(kp)?c[kp]:Object.defineProperty(c,kp,{value:[]})[kp];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var bn=globalThis;function Xe(n){for(let e in n)if(n[e]===Xe)return e;throw Error("Could not find renamed property on target object.")}function x3(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Cn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Cn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function bk(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var R3=Xe({__forward_ref__:Xe});function qo(n){return n.__forward_ref__=qo,n.toString=function(){return Cn(this())},n}function In(n){return lN(n)?n():n}function lN(n){return typeof n=="function"&&n.hasOwnProperty(R3)&&n.__forward_ref__===qo}function ce(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function jn(n){return{providers:n.providers||[],imports:n.imports||[]}}function hm(n){return Ck(n,dN)||Ck(n,hN)}function uN(n){return hm(n)!==null}function Ck(n,e){return n.hasOwnProperty(e)?n[e]:null}function k3(n){let e=n&&(n[dN]||n[hN]);return e||null}function Tk(n){return n&&(n.hasOwnProperty(Sk)||n.hasOwnProperty(N3))?n[Sk]:null}var dN=Xe({\u0275prov:Xe}),Sk=Xe({\u0275inj:Xe}),hN=Xe({ngInjectableDef:Xe}),N3=Xe({ngInjectorDef:Xe}),de=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ce({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function fN(n){return n&&!!n.\u0275providers}var P3=Xe({\u0275cmp:Xe}),M3=Xe({\u0275dir:Xe}),O3=Xe({\u0275pipe:Xe}),F3=Xe({\u0275mod:Xe}),jp=Xe({\u0275fac:Xe}),Gu=Xe({__NG_ELEMENT_ID__:Xe}),Dk=Xe({__NG_ENV_ID__:Xe});function Gt(n){return typeof n=="string"?n:n==null?"":String(n)}function L3(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Gt(n)}function V3(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new oe(-200,n)}function w0(n,e){throw new oe(-201,!1)}var Ce=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ce||{}),Nw;function pN(){return Nw}function Un(n){let e=Nw;return Nw=n,e}function mN(n,e,t){let r=hm(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Ce.Optional)return null;if(e!==void 0)return e;w0(n,"Injector")}var U3={},Ku=U3,Pw="__NG_DI_FLAG__",$p="ngTempTokenPath",B3="ngTokenPath",j3=/\n/gm,$3="\u0275",Ak="__source",wc;function H3(){return wc}function bs(n){let e=wc;return wc=n,e}function z3(n,e=Ce.Default){if(wc===void 0)throw new oe(-203,!1);return wc===null?mN(n,void 0,e):wc.get(n,e&Ce.Optional?null:void 0,e)}function le(n,e=Ce.Default){return(pN()||z3)(In(n),e)}function X(n,e=Ce.Default){return le(n,fm(e))}function fm(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Mw(n){let e=[];for(let t=0;t<n.length;t++){let r=In(n[t]);if(Array.isArray(r)){if(r.length===0)throw new oe(900,!1);let i,s=Ce.Default;for(let o=0;o<r.length;o++){let a=r[o],c=q3(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(le(i,s))}else e.push(le(r))}return e}function gN(n,e){return n[Pw]=e,n.prototype[Pw]=e,n}function q3(n){return n[Pw]}function G3(n,e,t,r){let i=n[$p];throw e[Ak]&&i.unshift(e[Ak]),n.message=W3(`
`+n.message,i,t,r),n[B3]=i,n[$p]=null,n}function W3(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==$3?n.slice(2):n;let i=Cn(e);if(Array.isArray(e))i=e.map(Cn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Cn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(j3,`
  `)}`}var pm=gN(cN("Optional"),8);var E0=gN(cN("SkipSelf"),4);function Lo(n,e){let t=n.hasOwnProperty(jp);return t?n[jp]:null}function I0(n,e){n.forEach(t=>Array.isArray(t)?I0(t,e):e(t))}function _N(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Hp(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function K3(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function Q3(n,e,t){let r=sd(n,e);return r>=0?n[r|1]=t:(r=~r,K3(n,r,e,t)),r}function yw(n,e){let t=sd(n,e);if(t>=0)return n[t|1]}function sd(n,e){return Y3(n,e,1)}function Y3(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var Ic={},hr=[],bc=new de(""),yN=new de("",-1),vN=new de(""),zp=class{get(e,t=Ku){if(t===Ku){let r=new Error(`NullInjectorError: No provider for ${Cn(e)}!`);throw r.name="NullInjectorError",r}return t}},wN=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(wN||{}),ni=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(ni||{}),Tn=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Tn||{});function J3(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Ow(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];X3(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function EN(n){return n===3||n===4||n===6}function X3(n){return n.charCodeAt(0)===64}function Qu(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?xk(n,t,i,null,e[++r]):xk(n,t,i,null,null))}}return n}function xk(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var IN="ng-template";function Z3(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&J3(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(b0(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function b0(n){return n.type===4&&n.value!==IN}function e4(n,e,t){let r=n.type===4&&!t?IN:n.value;return e===r}function t4(n,e,t){let r=4,i=n.attrs,s=i!==null?i4(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!kr(r)&&!kr(c))return!1;if(o&&kr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!e4(n,c,t)||c===""&&e.length===1){if(kr(r))return!1;o=!0}}else if(r&8){if(i===null||!Z3(n,i,c,t)){if(kr(r))return!1;o=!0}}else{let l=e[++a],d=n4(c,i,b0(n),t);if(d===-1){if(kr(r))return!1;o=!0;continue}if(l!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(kr(r))return!1;o=!0}}}}return kr(r)||o}function kr(n){return(n&1)===0}function n4(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return s4(e,n)}function r4(n,e,t=!1){for(let r=0;r<e.length;r++)if(t4(n,e[r],t))return!0;return!1}function i4(n){for(let e=0;e<n.length;e++){let t=n[e];if(EN(t))return e}return n.length}function s4(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Rk(n,e){return n?":not("+e.trim()+")":e}function o4(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!kr(o)&&(e+=Rk(s,i),i=""),r=o,s=s||!kr(r);t++}return i!==""&&(e+=Rk(s,i)),e}function a4(n){return n.map(o4).join(",")}function c4(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!kr(i))break;i=s}r++}return{attrs:e,classes:t}}function $e(n){return id(()=>{let e=AN(n),t=Qe(q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===wN.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ni.Emulated,styles:n.styles||hr,_:null,schemas:n.schemas||null,tView:null,id:""});xN(t);let r=n.dependencies;return t.directiveDefs=Nk(r,!1),t.pipeDefs=Nk(r,!0),t.id=d4(t),t})}function l4(n){return Ts(n)||CN(n)}function u4(n){return n!==null}function $n(n){return id(()=>({type:n.type,bootstrap:n.bootstrap||hr,declarations:n.declarations||hr,imports:n.imports||hr,exports:n.exports||hr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function kk(n,e){if(n==null)return Ic;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=Tn.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==Tn.None?[r,a]:r,e[s]=o):t[s]=r}return t}function dn(n){return id(()=>{let e=AN(n);return xN(e),e})}function bN(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ts(n){return n[P3]||null}function CN(n){return n[M3]||null}function TN(n){return n[O3]||null}function SN(n){let e=Ts(n)||CN(n)||TN(n);return e!==null?e.standalone:!1}function DN(n,e){let t=n[F3]||null;if(!t&&e===!0)throw new Error(`Type ${Cn(n)} does not have '\u0275mod' property.`);return t}function AN(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Ic,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||hr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:kk(n.inputs,e),outputs:kk(n.outputs),debugInfo:null}}function xN(n){n.features?.forEach(e=>e(n))}function Nk(n,e){if(!n)return null;let t=e?TN:l4;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(u4)}function d4(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function h4(...n){return{\u0275providers:RN(!0,n),\u0275fromNgModule:!0}}function RN(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return I0(e,o=>{let a=o;Fw(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&kN(i,s),t}function kN(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];C0(i,s=>{e(s,r)})}}function Fw(n,e,t,r){if(n=In(n),!n)return!1;let i=null,s=Tk(n),o=!s&&Ts(n);if(!s&&!o){let c=n.ngModule;if(s=Tk(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Fw(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{I0(s.imports,d=>{Fw(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&kN(l,e)}if(!a){let l=Lo(i)||(()=>new i);e({provide:i,useFactory:l,deps:hr},i),e({provide:vN,useValue:i,multi:!0},i),e({provide:bc,useValue:()=>le(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;C0(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function C0(n,e){for(let t of n)fN(t)&&(t=t.\u0275providers),Array.isArray(t)?C0(t,e):e(t)}var f4=Xe({provide:String,useValue:Xe});function NN(n){return n!==null&&typeof n=="object"&&f4 in n}function p4(n){return!!(n&&n.useExisting)}function m4(n){return!!(n&&n.useFactory)}function Cc(n){return typeof n=="function"}function g4(n){return!!n.useClass}var mm=new de(""),Fp={},_4={},vw;function T0(){return vw===void 0&&(vw=new zp),vw}var Bn=class{},Yu=class extends Bn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vw(e,o=>this.processProvider(o)),this.records.set(yN,gc(void 0,this)),i.has("environment")&&this.records.set(Bn,gc(void 0,this));let s=this.records.get(mm);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(vN,hr,Ce.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Fe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Fe(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=bs(this),r=Un(void 0),i;try{return e()}finally{bs(t),Un(r)}}get(e,t=Ku,r=Ce.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Dk))return e[Dk](this);r=fm(r);let i,s=bs(this),o=Un(void 0);try{if(!(r&Ce.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=I4(e)&&hm(e);l&&this.injectableDefInScope(l)?c=gc(Lw(e),Fp):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&Ce.Self?T0():this.parent;return t=r&Ce.Optional&&t===Ku?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[$p]=a[$p]||[]).unshift(Cn(e)),s)throw a;return G3(a,e,"R3InjectorError",this.source)}else throw a}finally{Un(o),bs(s)}}resolveInjectorInitializers(){let e=Fe(null),t=bs(this),r=Un(void 0),i;try{let s=this.get(bc,hr,Ce.Self);for(let o of s)o()}finally{bs(t),Un(r),Fe(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Cn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new oe(205,!1)}processProvider(e){e=In(e);let t=Cc(e)?e:In(e&&e.provide),r=v4(e);if(!Cc(e)&&e.multi===!0){let i=this.records.get(t);i||(i=gc(void 0,Fp,!0),i.factory=()=>Mw(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Fe(null);try{return t.value===Fp&&(t.value=_4,t.value=t.factory()),typeof t.value=="object"&&t.value&&E4(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Fe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=In(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Lw(n){let e=hm(n),t=e!==null?e.factory:Lo(n);if(t!==null)return t;if(n instanceof de)throw new oe(204,!1);if(n instanceof Function)return y4(n);throw new oe(204,!1)}function y4(n){if(n.length>0)throw new oe(204,!1);let t=k3(n);return t!==null?()=>t.factory(n):()=>new n}function v4(n){if(NN(n))return gc(void 0,n.useValue);{let e=PN(n);return gc(e,Fp)}}function PN(n,e,t){let r;if(Cc(n)){let i=In(n);return Lo(i)||Lw(i)}else if(NN(n))r=()=>In(n.useValue);else if(m4(n))r=()=>n.useFactory(...Mw(n.deps||[]));else if(p4(n))r=()=>le(In(n.useExisting));else{let i=In(n&&(n.useClass||n.provide));if(w4(n))r=()=>new i(...Mw(n.deps));else return Lo(i)||Lw(i)}return r}function gc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function w4(n){return!!n.deps}function E4(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function I4(n){return typeof n=="function"||typeof n=="object"&&n instanceof de}function Vw(n,e){for(let t of n)Array.isArray(t)?Vw(t,e):t&&fN(t)?Vw(t.\u0275providers,e):e(t)}function Wi(n,e){n instanceof Yu&&n.assertNotDestroyed();let t,r=bs(n),i=Un(void 0);try{return e()}finally{bs(r),Un(i)}}function MN(){return pN()!==void 0||H3()!=null}function b4(n){if(!MN())throw new oe(-203,!1)}function C4(n){let e=bn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function T4(n){return typeof n=="function"}var Ki=0,Re=1,me=2,un=3,Nr=4,Or=5,qp=6,Ju=7,Pr=8,Tc=9,Mr=10,Nt=11,Xu=12,Pk=13,Rc=14,ri=15,gm=16,_c=17,Sc=18,_m=19,ON=20,Cs=21,ww=22,Vo=23,ii=25,FN=1;var Uo=7,Gp=8,Wp=9,fr=10,S0=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(S0||{});function Oo(n){return Array.isArray(n)&&typeof n[FN]=="object"}function Qi(n){return Array.isArray(n)&&n[FN]===!0}function LN(n){return(n.flags&4)!==0}function ym(n){return n.componentOffset>-1}function D0(n){return(n.flags&1)===1}function Ss(n){return!!n.template}function S4(n){return(n[me]&512)!==0}var Uw=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function VN(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Go(){return UN}function UN(n){return n.type.prototype.ngOnChanges&&(n.setInput=A4),D4}Go.ngInherit=!0;function D4(){let n=jN(this),e=n?.current;if(e){let t=n.previous;if(t===Ic)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function A4(n,e,t,r,i){let s=this.declaredInputs[r],o=jN(n)||x4(n,{previous:Ic,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Uw(l&&l.currentValue,t,c===Ic),VN(n,e,i,t)}var BN="__ngSimpleChanges__";function jN(n){return n[BN]||null}function x4(n,e){return n[BN]=e}var Mk=null;var ei=function(n,e,t){Mk?.(n,e,t)},R4="svg",k4="math",N4=!1;function P4(){return N4}function si(n){for(;Array.isArray(n);)n=n[Ki];return n}function $N(n,e){return si(e[n])}function pr(n,e){return si(e[n.index])}function HN(n,e){return n.data[e]}function M4(n,e){return n[e]}function As(n,e){let t=e[n];return Oo(t)?t:t[Ki]}function A0(n){return(n[me]&128)===128}function O4(n){return Qi(n[un])}function Kp(n,e){return e==null?null:n[e]}function zN(n){n[_c]=0}function F4(n){n[me]&1024||(n[me]|=1024,A0(n)&&Zu(n))}function L4(n,e){for(;n>0;)e=e[Rc],n--;return e}function x0(n){return!!(n[me]&9216||n[Vo]?.dirty)}function Bw(n){n[Mr].changeDetectionScheduler?.notify(1),x0(n)?Zu(n):n[me]&64&&(P4()?(n[me]|=1024,Zu(n)):n[Mr].changeDetectionScheduler?.notify())}function Zu(n){n[Mr].changeDetectionScheduler?.notify();let e=ed(n);for(;e!==null&&!(e[me]&8192||(e[me]|=8192,!A0(e)));)e=ed(e)}function qN(n,e){if((n[me]&256)===256)throw new oe(911,!1);n[Cs]===null&&(n[Cs]=[]),n[Cs].push(e)}function V4(n,e){if(n[Cs]===null)return;let t=n[Cs].indexOf(e);t!==-1&&n[Cs].splice(t,1)}function ed(n){let e=n[un];return Qi(e)?e[un]:e}var Te={lFrame:XN(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function U4(){return Te.lFrame.elementDepthCount}function B4(){Te.lFrame.elementDepthCount++}function j4(){Te.lFrame.elementDepthCount--}function GN(){return Te.bindingsEnabled}function $4(){return Te.skipHydrationRootTNode!==null}function H4(n){return Te.skipHydrationRootTNode===n}function z4(){Te.skipHydrationRootTNode=null}function je(){return Te.lFrame.lView}function Sn(){return Te.lFrame.tView}function Ve(n){return Te.lFrame.contextLView=n,n[Pr]}function Ue(n){return Te.lFrame.contextLView=null,n}function Hn(){let n=WN();for(;n!==null&&n.type===64;)n=n.parent;return n}function WN(){return Te.lFrame.currentTNode}function q4(){let n=Te.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function od(n,e){let t=Te.lFrame;t.currentTNode=n,t.isParent=e}function KN(){return Te.lFrame.isParent}function G4(){Te.lFrame.isParent=!1}function W4(){let n=Te.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function vm(){return Te.lFrame.bindingIndex}function K4(n){return Te.lFrame.bindingIndex=n}function wm(){return Te.lFrame.bindingIndex++}function ad(n){let e=Te.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Q4(){return Te.lFrame.inI18n}function Y4(n,e){let t=Te.lFrame;t.bindingIndex=t.bindingRootIndex=n,jw(e)}function J4(){return Te.lFrame.currentDirectiveIndex}function jw(n){Te.lFrame.currentDirectiveIndex=n}function X4(n){let e=Te.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function QN(n){Te.lFrame.currentQueryIndex=n}function Z4(n){let e=n[Re];return e.type===2?e.declTNode:e.type===1?n[Or]:null}function YN(n,e,t){if(t&Ce.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Ce.Host);)if(i=Z4(s),i===null||(s=s[Rc],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Te.lFrame=JN();return r.currentTNode=e,r.lView=n,!0}function R0(n){let e=JN(),t=n[Re];Te.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function JN(){let n=Te.lFrame,e=n===null?null:n.child;return e===null?XN(n):e}function XN(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function ZN(){let n=Te.lFrame;return Te.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var eP=ZN;function k0(){let n=ZN();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function eH(n){return(Te.lFrame.contextLView=L4(n,Te.lFrame.contextLView))[Pr]}function ci(){return Te.lFrame.selectedIndex}function Bo(n){Te.lFrame.selectedIndex=n}function Em(){let n=Te.lFrame;return HN(n.tView,n.selectedIndex)}function tH(){return Te.lFrame.currentNamespace}var tP=!0;function N0(){return tP}function P0(n){tP=n}function nH(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=UN(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function M0(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Lp(n,e,t){nP(n,e,3,t)}function Vp(n,e,t,r){(n[me]&3)===t&&nP(n,e,t,r)}function Ew(n,e){let t=n[me];(t&3)===e&&(t&=16383,t+=1,n[me]=t)}function nP(n,e,t,r){let i=r!==void 0?n[_c]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[_c]+=65536),(a<s||s==-1)&&(rH(n,t,e,c),n[_c]=(n[_c]&4294901760)+c+2),c++}function Ok(n,e){ei(4,n,e);let t=Fe(null);try{e.call(n)}finally{Fe(t),ei(5,n,e)}}function rH(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[me]>>14<n[_c]>>16&&(n[me]&3)===e&&(n[me]+=16384,Ok(a,s)):Ok(a,s)}var Ec=-1,jo=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function iH(n){return n instanceof jo}function sH(n){return(n.flags&8)!==0}function oH(n){return(n.flags&16)!==0}function rP(n){return n!==Ec}function Qp(n){return n&32767}function aH(n){return n>>16}function Yp(n,e){let t=aH(n),r=e;for(;t>0;)r=r[Rc],t--;return r}var $w=!0;function Jp(n){let e=$w;return $w=n,e}var cH=256,iP=cH-1,sP=5,lH=0,ti={};function uH(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Gu)&&(r=t[Gu]),r==null&&(r=t[Gu]=lH++);let i=r&iP,s=1<<i;e.data[n+(i>>sP)]|=s}function Xp(n,e){let t=oP(n,e);if(t!==-1)return t;let r=e[Re];r.firstCreatePass&&(n.injectorIndex=e.length,Iw(r.data,n),Iw(e,null),Iw(r.blueprint,null));let i=O0(n,e),s=n.injectorIndex;if(rP(i)){let o=Qp(i),a=Yp(i,e),c=a[Re].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Iw(n,e){n.push(0,0,0,0,0,0,0,0,e)}function oP(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function O0(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=dP(i),r===null)return Ec;if(t++,i=i[Rc],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ec}function Hw(n,e,t){uH(n,e,t)}function dH(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(EN(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function aP(n,e,t){if(t&Ce.Optional||n!==void 0)return n;w0(e,"NodeInjector")}function cP(n,e,t,r){if(t&Ce.Optional&&r===void 0&&(r=null),!(t&(Ce.Self|Ce.Host))){let i=n[Tc],s=Un(void 0);try{return i?i.get(e,r,t&Ce.Optional):mN(e,r,t&Ce.Optional)}finally{Un(s)}}return aP(r,e,t)}function lP(n,e,t,r=Ce.Default,i){if(n!==null){if(e[me]&2048&&!(r&Ce.Self)){let o=gH(n,e,t,r,ti);if(o!==ti)return o}let s=uP(n,e,t,r,ti);if(s!==ti)return s}return cP(e,t,r,i)}function uP(n,e,t,r,i){let s=pH(t);if(typeof s=="function"){if(!YN(e,n,r))return r&Ce.Host?aP(i,t,r):cP(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Ce.Optional))w0(t);else return o}finally{eP()}}else if(typeof s=="number"){let o=null,a=oP(n,e),c=Ec,l=r&Ce.Host?e[ri][Or]:null;for((a===-1||r&Ce.SkipSelf)&&(c=a===-1?O0(n,e):e[a+8],c===Ec||!Lk(r,!1)?a=-1:(o=e[Re],a=Qp(c),e=Yp(c,e)));a!==-1;){let d=e[Re];if(Fk(s,a,d.data)){let h=hH(a,e,t,o,r,l);if(h!==ti)return h}c=e[a+8],c!==Ec&&Lk(r,e[Re].data[a+8]===l)&&Fk(s,a,e)?(o=d,a=Qp(c),e=Yp(c,e)):a=-1}}return i}function hH(n,e,t,r,i,s){let o=e[Re],a=o.data[n+8],c=r==null?ym(a)&&$w:r!=o&&(a.type&3)!==0,l=i&Ce.Host&&s===a,d=fH(a,o,t,c,l);return d!==null?Dc(e,o,d,a):ti}function fH(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,h=r?a:a+d,p=i?a+d:l;for(let _=h;_<p;_++){let E=o[_];if(_<c&&t===E||_>=c&&E.type===t)return _}if(i){let _=o[c];if(_&&Ss(_)&&_.type===t)return c}return null}function Dc(n,e,t,r){let i=n[t],s=e.data;if(iH(i)){let o=i;o.resolving&&V3(L3(s[t]));let a=Jp(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Un(o.injectImpl):null,d=YN(n,r,Ce.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&nH(t,s[t],e)}finally{l!==null&&Un(l),Jp(a),o.resolving=!1,eP()}}return i}function pH(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Gu)?n[Gu]:void 0;return typeof e=="number"?e>=0?e&iP:mH:e}function Fk(n,e,t){let r=1<<n;return!!(t[e+(n>>sP)]&r)}function Lk(n,e){return!(n&Ce.Self)&&!(n&Ce.Host&&e)}var Fo=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return lP(this._tNode,this._lView,e,fm(r),t)}};function mH(){return new Fo(Hn(),je())}function Wo(n){return id(()=>{let e=n.prototype.constructor,t=e[jp]||zw(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[jp]||zw(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function zw(n){return lN(n)?()=>{let e=zw(In(n));return e&&e()}:Lo(n)}function gH(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[me]&2048&&!(o[me]&512);){let a=uP(s,o,t,r|Ce.Self,ti);if(a!==ti)return a;let c=s.parent;if(!c){let l=o[ON];if(l){let d=l.get(t,ti,r);if(d!==ti)return d}c=dP(o),o=o[Rc]}s=c}return i}function dP(n){let e=n[Re],t=e.type;return t===2?e.declTNode:t===1?n[Or]:null}function F0(n){return dH(Hn(),n)}function Vk(n,e=null,t=null,r){let i=hP(n,e,t,r);return i.resolveInjectorInitializers(),i}function hP(n,e=null,t=null,r,i=new Set){let s=[t||hr,h4(n)];return r=r||(typeof n=="object"?void 0:Cn(n)),new Yu(s,e||T0(),r||null,i)}var Fr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return Vk({name:""},i,r,"");{let s=r.name??"";return Vk({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Ku,e.NULL=new zp,e.\u0275prov=ce({token:e,providedIn:"any",factory:()=>le(yN)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var _H="ngOriginalError";function bw(n){return n[_H]}var oi=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&bw(e);for(;t&&bw(t);)t=bw(t);return t||null}},fP=new de("",{providedIn:"root",factory:()=>X(oi).handleError.bind(void 0)}),L0=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=yH,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),qw=class extends L0{constructor(e){super(),this._lView=e}onDestroy(e){return qN(this._lView,e),()=>V4(this._lView,e)}};function yH(){return new qw(je())}function vH(){return Im(Hn(),je())}function Im(n,e){return new li(pr(n,e))}var li=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=vH;let n=e;return n})();var Gw=class extends ln{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,MN()&&(this.destroyRef=X(L0,{optional:!0})??void 0)}emit(e){let t=Fe(null);try{super.next(e)}finally{Fe(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Cw(s),i&&(i=Cw(i)),o&&(o=Cw(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof $t&&e.add(a),a}};function Cw(n){return e=>{setTimeout(n,void 0,e)}}var Ht=Gw;function pP(n){return(n.flags&128)===128}var mP=new Map,wH=0;function EH(){return wH++}function IH(n){mP.set(n[_m],n)}function bH(n){mP.delete(n[_m])}var Uk="__ngContext__";function $o(n,e){Oo(e)?(n[Uk]=e[_m],IH(e)):n[Uk]=e}function gP(n){return yP(n[Xu])}function _P(n){return yP(n[Nr])}function yP(n){for(;n!==null&&!Qi(n);)n=n[Nr];return n}var Ww;function vP(n){Ww=n}function CH(){if(Ww!==void 0)return Ww;if(typeof document<"u")return document;throw new oe(210,!1)}var bm=new de("",{providedIn:"root",factory:()=>TH}),TH="ng",V0=new de(""),xs=new de("",{providedIn:"platform",factory:()=>"unknown"});var U0=new de("",{providedIn:"root",factory:()=>CH().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var SH="h",DH="b";var AH=()=>null;function B0(n,e,t=!1){return AH(n,e,t)}var wP=!1,xH=new de("",{providedIn:"root",factory:()=>wP});var Np;function RH(){if(Np===void 0&&(Np=null,bn.trustedTypes))try{Np=bn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Np}function Bk(n){return RH()?.createScriptURL(n)||n}var Zp=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${aN})`}};function cd(n){return n instanceof Zp?n.changingThisBreaksApplicationSecurity:n}function j0(n,e){let t=kH(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${aN})`)}return t===e}function kH(n){return n instanceof Zp&&n.getTypeName()||null}var NH=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function EP(n){return n=String(n),n.match(NH)?n:"unsafe:"+n}var Cm=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Cm||{});function Yi(n){let e=bP();return e?e.sanitize(Cm.URL,n)||"":j0(n,"URL")?cd(n):EP(Gt(n))}function PH(n){let e=bP();if(e)return Bk(e.sanitize(Cm.RESOURCE_URL,n)||"");if(j0(n,"ResourceURL"))return Bk(cd(n));throw new oe(904,!1)}function MH(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?PH:Yi}function IP(n,e,t){return MH(e,t)(n)}function bP(){let n=je();return n&&n[Mr].sanitizer}function CP(n){return n instanceof Function?n():n}function OH(n){return(n??X(Fr)).get(xs)==="browser"}var Gi=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Gi||{}),FH;function $0(n,e){return FH(n,e)}function yc(n,e,t,r,i){if(r!=null){let s,o=!1;Qi(r)?s=r:Oo(r)&&(o=!0,r=r[Ki]);let a=si(r);n===0&&t!==null?i==null?xP(e,t,a):em(e,t,a,i||null,!0):n===1&&t!==null?em(e,t,a,i||null,!0):n===2?ZH(e,a,o):n===3&&e.destroyNode(a),s!=null&&tz(e,n,s,t,i)}}function LH(n,e){return n.createText(e)}function VH(n,e,t){n.setValue(e,t)}function TP(n,e,t){return n.createElement(e,t)}function UH(n,e){SP(n,e),e[Ki]=null,e[Or]=null}function BH(n,e,t,r,i,s){r[Ki]=i,r[Or]=e,Tm(n,r,t,1,i,s)}function SP(n,e){e[Mr].changeDetectionScheduler?.notify(1),Tm(n,e,e[Nt],2,null,null)}function jH(n){let e=n[Xu];if(!e)return Tw(n[Re],n);for(;e;){let t=null;if(Oo(e))t=e[Xu];else{let r=e[fr];r&&(t=r)}if(!t){for(;e&&!e[Nr]&&e!==n;)Oo(e)&&Tw(e[Re],e),e=e[un];e===null&&(e=n),Oo(e)&&Tw(e[Re],e),t=e&&e[Nr]}e=t}}function $H(n,e,t,r){let i=fr+r,s=t.length;r>0&&(t[i-1][Nr]=e),r<s-fr?(e[Nr]=t[i],_N(t,fr+r,e)):(t.push(e),e[Nr]=null),e[un]=t;let o=e[gm];o!==null&&t!==o&&HH(o,e);let a=e[Sc];a!==null&&a.insertView(n),Bw(e),e[me]|=128}function HH(n,e){let t=n[Wp],i=e[un][un][ri];e[ri]!==i&&(n[me]|=S0.HasTransplantedViews),t===null?n[Wp]=[e]:t.push(e)}function DP(n,e){let t=n[Wp],r=t.indexOf(e);t.splice(r,1)}function Kw(n,e){if(n.length<=fr)return;let t=fr+e,r=n[t];if(r){let i=r[gm];i!==null&&i!==n&&DP(i,r),e>0&&(n[t-1][Nr]=r[Nr]);let s=Hp(n,fr+e);UH(r[Re],r);let o=s[Sc];o!==null&&o.detachView(s[Re]),r[un]=null,r[Nr]=null,r[me]&=-129}return r}function AP(n,e){if(!(e[me]&256)){let t=e[Nt];t.destroyNode&&Tm(n,e,t,3,null,null),jH(e)}}function Tw(n,e){if(e[me]&256)return;let t=Fe(null);try{e[me]&=-129,e[me]|=256,e[Vo]&&JR(e[Vo]),qH(n,e),zH(n,e),e[Re].type===1&&e[Nt].destroy();let r=e[gm];if(r!==null&&Qi(e[un])){r!==e[un]&&DP(r,e);let i=e[Sc];i!==null&&i.detachView(n)}bH(e)}finally{Fe(t)}}function zH(n,e){let t=n.cleanup,r=e[Ju];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[Ju]=null);let i=e[Cs];if(i!==null){e[Cs]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function qH(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof jo)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];ei(4,a,c);try{c.call(a)}finally{ei(5,a,c)}}else{ei(4,i,s);try{s.call(i)}finally{ei(5,i,s)}}}}}function GH(n,e,t){return WH(n,e.parent,t)}function WH(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Ki];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===ni.None||s===ni.Emulated)return null}return pr(r,t)}}function em(n,e,t,r,i){n.insertBefore(e,t,r,i)}function xP(n,e,t){n.appendChild(e,t)}function jk(n,e,t,r,i){r!==null?em(n,e,t,r,i):xP(n,e,t)}function KH(n,e,t,r){n.removeChild(e,t,r)}function H0(n,e){return n.parentNode(e)}function QH(n,e){return n.nextSibling(e)}function YH(n,e,t){return XH(n,e,t)}function JH(n,e,t){return n.type&40?pr(n,t):null}var XH=JH,$k;function z0(n,e,t,r){let i=GH(n,r,e),s=e[Nt],o=r.parent||e[Or],a=YH(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)jk(s,i,t[c],a,!1);else jk(s,i,t,a,!1);$k!==void 0&&$k(s,r,e,t,i)}function Up(n,e){if(e!==null){let t=e.type;if(t&3)return pr(e,n);if(t&4)return Qw(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Up(n,r);{let i=n[e.index];return Qi(i)?Qw(-1,i):si(i)}}else{if(t&32)return $0(e,n)()||si(n[e.index]);{let r=RP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=ed(n[ri]);return Up(i,r)}else return Up(n,e.next)}}}return null}function RP(n,e){if(e!==null){let r=n[ri][Or],i=e.projection;return r.projection[i]}return null}function Qw(n,e){let t=fr+n+1;if(t<e.length){let r=e[t],i=r[Re].firstChild;if(i!==null)return Up(r,i)}return e[Uo]}function ZH(n,e,t){let r=H0(n,e);r&&KH(n,r,e,t)}function q0(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&$o(si(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)q0(n,e,t.child,r,i,s,!1),yc(e,n,i,a,s);else if(c&32){let l=$0(t,r),d;for(;d=l();)yc(e,n,i,d,s);yc(e,n,i,a,s)}else c&16?ez(n,e,r,t,i,s):yc(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Tm(n,e,t,r,i,s){q0(t,r,n.firstChild,e,i,s,!1)}function ez(n,e,t,r,i,s){let o=t[ri],c=o[Or].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];yc(e,n,i,d,s)}else{let l=c,d=o[un];pP(r)&&(l.flags|=128),q0(n,e,l,d,i,s,!0)}}function tz(n,e,t,r,i){let s=t[Uo],o=si(t);s!==o&&yc(e,n,r,s,i);for(let a=fr;a<t.length;a++){let c=t[a];Tm(c[Re],c,n,e,r,s)}}function nz(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Gi.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Gi.Important),n.setStyle(t,r,i,s))}}function rz(n,e,t){n.setAttribute(e,"style",t)}function kP(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function NP(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Ow(n,e,r),i!==null&&kP(n,e,i),s!==null&&rz(n,e,s)}var hn={};function F(n=1){PP(Sn(),je(),ci()+n,!1)}function PP(n,e,t,r){if(!r)if((e[me]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Lp(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Vp(e,s,0,t)}Bo(t)}function Z(n,e=Ce.Default){let t=je();if(t===null)return le(n,e);let r=Hn();return lP(r,t,In(n),e)}function MP(){let n="invalid";throw new Error(n)}function OP(n,e,t,r,i,s){let o=Fe(null);try{let a=null;i&Tn.SignalBased&&(a=e[r][Xv]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Tn.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):VN(e,a,r,s)}finally{Fe(o)}}function iz(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Bo(~i);else{let s=i,o=t[++r],a=t[++r];Y4(o,s);let c=e[s];a(2,c)}}}finally{Bo(-1)}}function Sm(n,e,t,r,i,s,o,a,c,l,d){let h=e.blueprint.slice();return h[Ki]=i,h[me]=r|4|128|8|64,(l!==null||n&&n[me]&2048)&&(h[me]|=2048),zN(h),h[un]=h[Rc]=n,h[Pr]=t,h[Mr]=o||n&&n[Mr],h[Nt]=a||n&&n[Nt],h[Tc]=c||n&&n[Tc]||null,h[Or]=s,h[_m]=EH(),h[qp]=d,h[ON]=l,h[ri]=e.type==2?n[ri]:h,h}function Dm(n,e,t,r,i){let s=n.data[e];if(s===null)s=sz(n,e,t,r,i),Q4()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=q4();s.injectorIndex=o===null?-1:o.injectorIndex}return od(s,!0),s}function sz(n,e,t,r,i){let s=WN(),o=KN(),a=o?s:s&&s.parent,c=n.data[e]=uz(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function FP(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function LP(n,e,t,r,i){let s=ci(),o=r&2;try{Bo(-1),o&&e.length>ii&&PP(n,e,ii,!1),ei(o?2:0,i),t(r,i)}finally{Bo(s),ei(o?3:1,i)}}function VP(n,e,t){if(LN(e)){let r=Fe(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Fe(r)}}}function UP(n,e,t){GN()&&(gz(n,e,t,pr(t,e)),(t.flags&64)===64&&zP(n,e,t))}function BP(n,e,t=pr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function jP(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=G0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function G0(n,e,t,r,i,s,o,a,c,l,d){let h=ii+r,p=h+i,_=oz(h,p),E=typeof l=="function"?l():l;return _[Re]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:p,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:E,incompleteFirstPass:!1,ssrId:d}}function oz(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:hn);return t}function az(n,e,t,r){let s=r.get(xH,wP)||t===ni.ShadowDom,o=n.selectRootElement(e,s);return cz(o),o}function cz(n){lz(n)}var lz=()=>null;function uz(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return $4()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Hk(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Tn.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?zk(r,t,l,a,c):zk(r,t,l,a)}return r}function zk(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function dz(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let h=s[d],p=t?t.get(h):null,_=p?p.inputs:null,E=p?p.outputs:null;c=Hk(0,h.inputs,d,c,_),l=Hk(1,h.outputs,d,l,E);let A=c!==null&&o!==null&&!b0(e)?Dz(c,d,o):null;a.push(A)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function hz(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function W0(n,e,t,r,i,s,o,a){let c=pr(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(K0(n,t,d,r,i),ym(e)&&fz(t,e.index)):e.type&3?(r=hz(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function fz(n,e){let t=As(e,n);t[me]&16||(t[me]|=64)}function $P(n,e,t,r){if(GN()){let i=r===null?null:{"":-1},s=yz(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&HP(n,e,t,o,i,a),i&&vz(t,r,i)}t.mergedAttrs=Qu(t.mergedAttrs,t.attrs)}function HP(n,e,t,r,i,s){for(let l=0;l<r.length;l++)Hw(Xp(t,e),n,r[l].type);Ez(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=FP(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=Qu(t.mergedAttrs,d.hostAttrs),Iz(n,t,e,c,d),wz(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}dz(n,t,s)}function pz(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;mz(o)!=a&&o.push(a),o.push(t,r,s)}}function mz(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function gz(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;ym(t)&&bz(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Xp(t,e),$o(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=Dc(e,n,a,t);if($o(l,e),o!==null&&Sz(e,a-i,l,c,t,o),Ss(c)){let d=As(t.index,e);d[Pr]=Dc(e,n,a,t)}}}function zP(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=J4();try{Bo(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];jw(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&_z(c,l)}}finally{Bo(-1),jw(o)}}function _z(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function yz(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(r4(e,o.selectors,!1))if(r||(r=[]),Ss(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;Yw(n,e,c)}else r.unshift(o),Yw(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Yw(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function vz(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new oe(-301,!1);r.push(e[i],s)}}}function wz(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Ss(e)&&(t[""]=n)}}function Ez(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Iz(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Lo(i.type,!0)),o=new jo(s,Ss(i),Z);n.blueprint[r]=o,t[r]=o,pz(n,e,r,FP(n,t,i.hostVars,hn),i)}function bz(n,e,t){let r=pr(e,n),i=jP(t),s=n[Mr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=Am(n,Sm(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function Cz(n,e,t,r,i,s){let o=pr(n,e);Tz(e[Nt],o,s,n.value,t,r,i)}function Tz(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?Gt(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function Sz(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],h=o[a++];OP(r,t,c,l,d,h)}}function Dz(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function qP(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function GP(n,e){let t=n.contentQueries;if(t!==null){let r=Fe(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];QN(s),a.contentQueries(2,e[o],o)}}}finally{Fe(r)}}}function Am(n,e){return n[Xu]?n[Pk][Nr]=e:n[Xu]=e,n[Pk]=e,e}function Jw(n,e,t){QN(0);let r=Fe(null);try{e(n,t)}finally{Fe(r)}}function Az(n){return n[Ju]||(n[Ju]=[])}function xz(n){return n.cleanup||(n.cleanup=[])}function WP(n,e){let t=n[Tc],r=t?t.get(oi,null):null;r&&r.handleError(e)}function K0(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];OP(d,l,r,a,c,i)}}function ld(n,e,t){let r=$N(e,n);VH(n[Nt],r,t)}function Rz(n,e){let t=As(e,n),r=t[Re];kz(r,t);let i=t[Ki];i!==null&&t[qp]===null&&(t[qp]=B0(i,t[Tc])),Q0(r,t,t[Pr])}function kz(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Q0(n,e,t){R0(e);try{let r=n.viewQuery;r!==null&&Jw(1,r,t);let i=n.template;i!==null&&LP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Sc]?.finishViewCreation(n),n.staticContentQueries&&GP(n,e),n.staticViewQueries&&Jw(2,n.viewQuery,t);let s=n.components;s!==null&&Nz(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[me]&=-5,k0()}}function Nz(n,e){for(let t=0;t<e.length;t++)Rz(n,e[t])}function Pz(n,e,t,r){let i=Fe(null);try{let s=e.tView,a=n[me]&4096?4096:16,c=Sm(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[gm]=l;let d=n[Sc];return d!==null&&(c[Sc]=d.createEmbeddedView(s)),Q0(s,c,t),c}finally{Fe(i)}}function qk(n,e){return!e||e.firstChild===null||pP(n)}function Mz(n,e,t,r=!0){let i=e[Re];if($H(i,e,n,t),r){let o=Qw(t,n),a=e[Nt],c=H0(a,n[Uo]);c!==null&&BH(i,n[Or],a,e,c,o)}let s=e[qp];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function tm(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(si(s)),Qi(s)&&Oz(s,r);let o=t.type;if(o&8)tm(n,e,t.child,r);else if(o&32){let a=$0(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=RP(e,t);if(Array.isArray(a))r.push(...a);else{let c=ed(e[ri]);tm(c[Re],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Oz(n,e){for(let t=fr;t<n.length;t++){let r=n[t],i=r[Re].firstChild;i!==null&&tm(r[Re],r,i,e)}n[Uo]!==n[Ki]&&e.push(n[Uo])}var KP=[];function Fz(n){return n[Vo]??Lz(n)}function Lz(n){let e=KP.pop()??Object.create(Uz);return e.lView=n,e}function Vz(n){n.lView[Vo]!==n&&(n.lView=null,KP.push(n))}var Uz=Qe(q({},KR),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Zu(n.lView)},consumerOnSignalRead(){this.lView[Vo]=this}}),QP=100;function YP(n,e=!0,t=0){let r=n[Mr],i=r.rendererFactory,s=!1;s||i.begin?.();try{Bz(n,t)}catch(o){throw e&&WP(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function Bz(n,e){Xw(n,e);let t=0;for(;x0(n);){if(t===QP)throw new oe(103,!1);t++,Xw(n,1)}}function jz(n,e,t,r){let i=e[me];if((i&256)===256)return;let s=!1;!s&&e[Mr].inlineEffectRunner?.flush(),R0(e);let o=null,a=null;!s&&$z(n)&&(a=Fz(e),o=QR(a));try{zN(e),K4(n.bindingStartIndex),t!==null&&LP(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let h=n.preOrderCheckHooks;h!==null&&Lp(e,h,null)}else{let h=n.preOrderHooks;h!==null&&Vp(e,h,0,null),Ew(e,0)}if(Hz(e),JP(e,0),n.contentQueries!==null&&GP(n,e),!s)if(c){let h=n.contentCheckHooks;h!==null&&Lp(e,h)}else{let h=n.contentHooks;h!==null&&Vp(e,h,1),Ew(e,1)}iz(n,e);let l=n.components;l!==null&&ZP(e,l,0);let d=n.viewQuery;if(d!==null&&Jw(2,d,r),!s)if(c){let h=n.viewCheckHooks;h!==null&&Lp(e,h)}else{let h=n.viewHooks;h!==null&&Vp(e,h,2),Ew(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[ww]){for(let h of e[ww])h();e[ww]=null}s||(e[me]&=-73)}catch(c){throw Zu(e),c}finally{a!==null&&(YR(a,o),Vz(a)),k0()}}function $z(n){return n.type!==2}function JP(n,e){for(let t=gP(n);t!==null;t=_P(t))for(let r=fr;r<t.length;r++){let i=t[r];XP(i,e)}}function Hz(n){for(let e=gP(n);e!==null;e=_P(e)){if(!(e[me]&S0.HasTransplantedViews))continue;let t=e[Wp];for(let r=0;r<t.length;r++){let i=t[r],s=i[un];F4(i)}}}function zz(n,e,t){let r=As(e,n);XP(r,t)}function XP(n,e){A0(n)&&Xw(n,e)}function Xw(n,e){let r=n[Re],i=n[me],s=n[Vo],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Zv(s)),s&&(s.dirty=!1),n[me]&=-9217,o)jz(r,n,r.template,n[Pr]);else if(i&8192){JP(n,1);let a=r.components;a!==null&&ZP(n,a,1)}}function ZP(n,e,t){for(let r=0;r<e.length;r++)zz(n,e[r],t)}function Y0(n){for(n[Mr].changeDetectionScheduler?.notify();n;){n[me]|=64;let e=ed(n);if(S4(n)&&!e)return n;n=e}return null}var Ho=class{get rootNodes(){let e=this._lView,t=e[Re];return tm(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Pr]}set context(e){this._lView[Pr]=e}get destroyed(){return(this._lView[me]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[un];if(Qi(e)){let t=e[Gp],r=t?t.indexOf(this):-1;r>-1&&(Kw(e,r),Hp(t,r))}this._attachedToViewContainer=!1}AP(this._lView[Re],this._lView)}onDestroy(e){qN(this._lView,e)}markForCheck(){Y0(this._cdRefInjectingView||this._lView)}detach(){this._lView[me]&=-129}reattach(){Bw(this._lView),this._lView[me]|=128}detectChanges(){this._lView[me]|=1024,YP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new oe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,SP(this._lView[Re],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new oe(902,!1);this._appRef=e,Bw(this._lView)}},xm=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Wz;let n=e;return n})(),qz=xm,Gz=class extends qz{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=Pz(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Ho(i)}};function Wz(){return Kz(Hn(),je())}function Kz(n,e){return n.type&4?new Gz(e,n,Im(n,e)):null}var $ce=new RegExp(`^(\\d+)*(${DH}|${SH})*(.*)`);var Qz=()=>null;function Gk(n,e){return Qz(n,e)}var nm=class{},Zw=class{},rm=class{};function Yz(n){let e=Error(`No component factory found for ${Cn(n)}.`);return e[Jz]=n,e}var Jz="ngComponent";var e0=class{resolveComponentFactory(e){throw Yz(e)}},Rm=(()=>{let e=class e{};e.NULL=new e0;let n=e;return n})(),td=class{},Ji=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>Xz();let n=e;return n})();function Xz(){let n=je(),e=Hn(),t=As(e.index,n);return(Oo(t)?t:n)[Nt]}var Zz=(()=>{let e=class e{};e.\u0275prov=ce({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Sw={};var Wk=new Set;function J0(n){Wk.has(n)||(Wk.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function Kk(...n){}function eq(){let n=typeof bn.requestAnimationFrame=="function",e=bn[n?"requestAnimationFrame":"setTimeout"],t=bn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var nt=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ht(!1),this.onMicrotaskEmpty=new Ht(!1),this.onStable=new Ht(!1),this.onError=new Ht(!1),typeof Zone>"u")throw new oe(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=eq().nativeRequestAnimationFrame,rq(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new oe(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new oe(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,tq,Kk,Kk);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},tq={};function X0(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function nq(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(bn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,t0(n),n.isCheckStableRunning=!0,X0(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),t0(n))}function rq(n){let e=()=>{nq(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(iq(a))return t.invokeTask(i,s,o,a);try{return Qk(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Yk(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return Qk(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),Yk(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,t0(n),X0(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function t0(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Qk(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Yk(n){n._nesting--,X0(n)}var n0=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ht,this.onMicrotaskEmpty=new Ht,this.onStable=new Ht,this.onError=new Ht}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function iq(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function sq(n="zone.js",e){return n==="noop"?new n0:n==="zone.js"?new nt(e):n}var vc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(vc||{}),oq={destroy(){}};function km(n,e){!e&&b4(km);let t=e?.injector??X(Fr);if(!OH(t))return oq;J0("NgAfterNextRender");let r=t.get(Z0),i=r.handler??=new i0,s=e?.phase??vc.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(L0).onDestroy(o),c=Wi(t,()=>new r0(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var r0=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=X(nt),this.errorHandler=X(oi,{optional:!0}),X(nm,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},i0=class{constructor(){this.executingCallbacks=!1,this.buckets={[vc.EarlyRead]:new Set,[vc.Write]:new Set,[vc.MixedReadWrite]:new Set,[vc.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Z0=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ce({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function s0(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=bk(i,a);else if(s==2){let c=a,l=e[++o];r=bk(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var im=class extends Rm{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Ts(e);return new Ac(t,this.ngModule)}};function Jk(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function aq(n){let e=n.toLowerCase();return e==="svg"?R4:e==="math"?k4:null}var o0=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=fm(r);let i=this.injector.get(e,Sw,r);return i!==Sw||t===Sw?i:this.parentInjector.get(e,t,r)}},Ac=class extends rm{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=Jk(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return Jk(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=a4(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Fe(null);try{i=i||this.ngModule;let o=i instanceof Bn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new o0(e,o):e,c=a.get(td,null);if(c===null)throw new oe(407,!1);let l=a.get(Zz,null),d=a.get(Z0,null),h=a.get(nm,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},_=c.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",A=r?az(_,r,this.componentDef.encapsulation,a):TP(_,E,aq(E)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let U=null;A!==null&&(U=B0(A,a,!0));let J=G0(0,null,null,1,0,null,null,null,null,null,null),H=Sm(null,J,null,R,null,null,p,_,a,null,U);R0(H);let ee,fe;try{let re=this.componentDef,S,b=null;re.findHostDirectiveDefs?(S=[],b=new Map,re.findHostDirectiveDefs(re,S,b),S.push(re)):S=[re];let C=cq(H,A),D=lq(C,A,re,S,H,p,_);fe=HN(J,ii),A&&hq(_,re,A,r),t!==void 0&&fq(fe,this.ngContentSelectors,t),ee=dq(D,re,S,b,H,[pq]),Q0(J,H,null)}finally{k0()}return new a0(this.componentType,ee,Im(fe,H),H,fe)}finally{Fe(s)}}},a0=class extends Zw{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Ho(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;K0(s[Re],s,i,e,t),this.previousInputValues.set(e,t);let o=As(this._tNode.index,s);Y0(o)}}get injector(){return new Fo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function cq(n,e){let t=n[Re],r=ii;return n[r]=e,Dm(t,r,2,"#host",null)}function lq(n,e,t,r,i,s,o){let a=i[Re];uq(r,n,e,o);let c=null;e!==null&&(c=B0(e,i[Tc]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let h=Sm(i,jP(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&Yw(a,n,r.length-1),Am(i,h),i[n.index]=h}function uq(n,e,t,r){for(let i of n)e.mergedAttrs=Qu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(s0(e,e.mergedAttrs,!0),t!==null&&NP(r,t,e))}function dq(n,e,t,r,i,s){let o=Hn(),a=i[Re],c=pr(o,i);HP(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let h=o.directiveStart+d,p=Dc(i,a,h,o);$o(p,i)}zP(a,i,o),c&&$o(c,i);let l=Dc(i,a,o.directiveStart+o.componentOffset,o);if(n[Pr]=i[Pr]=l,s!==null)for(let d of s)d(l,e);return VP(a,o,i),l}function hq(n,e,t,r){if(r)Ow(n,t,["ng-version","17.3.11"]);else{let{attrs:i,classes:s}=c4(e.selectors[0]);i&&Ow(n,t,i),s&&s.length>0&&kP(n,t,s.join(" "))}}function fq(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function pq(){let n=Hn();M0(je()[Re],n)}var kc=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=mq;let n=e;return n})();function mq(){let n=Hn();return _q(n,je())}var gq=kc,e1=class extends gq{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Im(this._hostTNode,this._hostLView)}get injector(){return new Fo(this._hostTNode,this._hostLView)}get parentInjector(){let e=O0(this._hostTNode,this._hostLView);if(rP(e)){let t=Yp(e,this._hostLView),r=Qp(e),i=t[Re].data[r+8];return new Fo(i,t)}else return new Fo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Xk(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-fr}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Gk(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,qk(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!T4(e),a;if(o)a=t;else{let E=t||{};a=E.index,r=E.injector,i=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}let c=o?e:new Ac(Ts(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let A=(o?l:this.parentInjector).get(Bn,null);A&&(s=A)}let d=Ts(c.componentType??{}),h=Gk(this._lContainer,d?.id??null),p=h?.firstChild??null,_=c.create(l,i,p,s);return this.insertImpl(_.hostView,a,qk(this._hostTNode,h)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(O4(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[un],l=new e1(c,c[Or],c[un]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return Mz(o,i,s,r),e.attachToViewContainerRef(),_N(Dw(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Xk(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Kw(this._lContainer,t);r&&(Hp(Dw(this._lContainer),t),AP(r[Re],r))}detach(e){let t=this._adjustIndex(e,-1),r=Kw(this._lContainer,t);return r&&Hp(Dw(this._lContainer),t)!=null?new Ho(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Xk(n){return n[Gp]}function Dw(n){return n[Gp]||(n[Gp]=[])}function _q(n,e){let t,r=e[n.index];return Qi(r)?t=r:(t=qP(r,e,null,n),e[n.index]=t,Am(e,t)),vq(t,e,n,r),new e1(t,n,e)}function yq(n,e){let t=n[Nt],r=t.createComment(""),i=pr(e,n),s=H0(t,i);return em(t,s,r,QH(t,i),!1),r}var vq=Iq,wq=()=>!1;function Eq(n,e,t){return wq(n,e,t)}function Iq(n,e,t,r){if(n[Uo])return;let i;t.type&8?i=si(r):i=yq(e,t),n[Uo]=i}function bq(n){return typeof n=="function"&&n[Xv]!==void 0}function t1(n){return bq(n)&&typeof n.set=="function"}function Cq(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Aq))}return s}return sm.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((h,p)=>{a.push(""),o.push(r(h).then(_=>{a[l+p]=_,d.splice(d.indexOf(h),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>xq(s));e.push(c)}),Sq(),Promise.all(e).then(()=>{})}var sm=new Map,Tq=new Set;function Sq(){let n=sm;return sm=new Map,n}function Dq(){return sm.size===0}function Aq(n){return typeof n=="string"?n:n.text()}function xq(n){Tq.delete(n)}function Rq(n){return Object.getPrototypeOf(n.prototype).constructor}function Rs(n){let e=Rq(n.type),t=!0,r=[n];for(;e;){let i;if(Ss(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new oe(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=Pp(n.inputs),o.inputTransforms=Pp(n.inputTransforms),o.declaredInputs=Pp(n.declaredInputs),o.outputs=Pp(n.outputs);let a=i.hostBindings;a&&Oq(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&Pq(n,c),l&&Mq(n,l),kq(n,i),x3(n.outputs,i.outputs),Ss(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Rs&&(t=!1)}}e=Object.getPrototypeOf(e)}Nq(r)}function kq(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function Nq(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Qu(i.hostAttrs,t=Qu(t,i.hostAttrs))}}function Pp(n){return n===Ic?{}:n===hr?[]:n}function Pq(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function Mq(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function Oq(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function eE(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var Ds=class{},nd=class{};var om=class extends Ds{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new im(this);let i=DN(e);this._bootstrapComponents=CP(i.bootstrap),this._r3Injector=hP(e,t,[{provide:Ds,useValue:this},{provide:Rm,useValue:this.componentFactoryResolver},...r],Cn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},am=class extends nd{constructor(e){super(),this.moduleType=e}create(e){return new om(this.moduleType,e,[])}};function Fq(n,e,t){return new om(n,e,t)}var c0=class extends Ds{constructor(e){super(),this.componentFactoryResolver=new im(this),this.instance=null;let t=new Yu([...e.providers,{provide:Ds,useValue:this},{provide:Rm,useValue:this.componentFactoryResolver}],e.parent||T0(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Nm(n,e,t=null){return new c0({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Pm=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ae(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function n1(n){return Vq(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Lq(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function Vq(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Uq(n,e,t){return n[e]=t}function ai(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function cm(n,e,t,r){let i=ai(n,e,t);return ai(n,e+1,r)||i}function Bq(n,e,t,r,i){let s=cm(n,e,t,r);return ai(n,e+2,i)||s}function r1(n,e,t,r,i,s){let o=cm(n,e,t,r);return cm(n,e+2,i,s)||o}function jq(n){return(n.flags&32)===32}function $q(n,e,t,r,i,s,o,a,c){let l=e.consts,d=Dm(e,n,4,o||null,Kp(l,a));$P(e,t,d,Kp(l,c)),M0(e,d);let h=d.tView=G0(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function he(n,e,t,r,i,s,o,a){let c=je(),l=Sn(),d=n+ii,h=l.firstCreatePass?$q(d,l,c,e,t,r,i,s,o):l.data[d];od(h,!1);let p=Hq(l,c,h,n);N0()&&z0(l,c,p,h),$o(p,c);let _=qP(p,c,p,h);return c[d]=_,Am(c,_),Eq(_,h,c),D0(h)&&UP(l,c,h),o!=null&&BP(c,h,a),he}var Hq=zq;function zq(n,e,t,r){return P0(!0),e[Nt].createComment("")}function Mm(n,e,t,r){let i=je(),s=wm();if(ai(i,s,e)){let o=Sn(),a=Em();Cz(a,i,n,e,t,r)}return Mm}function i1(n,e,t,r){return ai(n,wm(),t)?e+Gt(t)+r:hn}function qq(n,e,t,r,i,s){let o=vm(),a=cm(n,o,t,i);return ad(2),a?e+Gt(t)+r+Gt(i)+s:hn}function Gq(n,e,t,r,i,s,o,a){let c=vm(),l=Bq(n,c,t,i,o);return ad(3),l?e+Gt(t)+r+Gt(i)+s+Gt(o)+a:hn}function Wq(n,e,t,r,i,s,o,a,c,l){let d=vm(),h=r1(n,d,t,i,o,c);return ad(4),h?e+Gt(t)+r+Gt(i)+s+Gt(o)+a+Gt(c)+l:hn}function Kq(n,e,t,r,i,s,o,a,c,l,d,h){let p=vm(),_=r1(n,p,t,i,o,c);return _=ai(n,p+4,d)||_,ad(5),_?e+Gt(t)+r+Gt(i)+s+Gt(o)+a+Gt(c)+l+Gt(d)+h:hn}function Mp(n,e){return n<<17|e<<2}function zo(n){return n>>17&32767}function Qq(n){return(n&2)==2}function Yq(n,e){return n&131071|e<<17}function l0(n){return n|2}function xc(n){return(n&131068)>>2}function Aw(n,e){return n&-131069|e<<2}function Jq(n){return(n&1)===1}function u0(n){return n|1}function Xq(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=zo(o),c=xc(o);n[r]=t;let l=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||sd(h,d)>0)&&(l=!0)}else d=t;if(i)if(c!==0){let p=zo(n[a+1]);n[r+1]=Mp(p,a),p!==0&&(n[p+1]=Aw(n[p+1],r)),n[a+1]=Yq(n[a+1],r)}else n[r+1]=Mp(a,0),a!==0&&(n[a+1]=Aw(n[a+1],r)),a=r;else n[r+1]=Mp(c,0),a===0?a=r:n[c+1]=Aw(n[c+1],r),c=r;l&&(n[r+1]=l0(n[r+1])),Zk(n,d,r,!0),Zk(n,d,r,!1),Zq(e,d,n,r,s),o=Mp(a,c),s?e.classBindings=o:e.styleBindings=o}function Zq(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&sd(s,e)>=0&&(t[r+1]=u0(t[r+1]))}function Zk(n,e,t,r){let i=n[t+1],s=e===null,o=r?zo(i):xc(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],l=n[o+1];e5(c,e)&&(a=!0,n[o+1]=r?u0(l):l0(l)),o=r?zo(l):xc(l)}a&&(n[t+1]=r?l0(i):u0(i))}function e5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?sd(n,e)>=0:!1}function G(n,e,t){let r=je(),i=wm();if(ai(r,i,e)){let s=Sn(),o=Em();W0(s,o,r,n,e,r[Nt],t,!1)}return G}function eN(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";K0(n,t,s[o],o,r)}function tE(n,e){return t5(n,e,null,!0),tE}function t5(n,e,t,r){let i=je(),s=Sn(),o=ad(2);if(s.firstUpdatePass&&r5(s,n,o,r),e!==hn&&ai(i,o,e)){let a=s.data[ci()];c5(s,a,i,i[Nt],n,i[o+1]=l5(e,t),r,o)}}function n5(n,e){return e>=n.expandoStartIndex}function r5(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[ci()],o=n5(n,t);u5(s,r)&&e===null&&!o&&(e=!1),e=i5(i,s,e,r),Xq(i,s,e,t,o,r)}}function i5(n,e,t,r){let i=X4(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=xw(null,n,e,t,r),t=rd(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=xw(i,n,e,t,r),s===null){let c=s5(n,e,r);c!==void 0&&Array.isArray(c)&&(c=xw(null,n,e,c[1],r),c=rd(c,e.attrs,r),o5(n,e,r,c))}else s=a5(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function s5(n,e,t){let r=t?e.classBindings:e.styleBindings;if(xc(r)!==0)return n[zo(r)]}function o5(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[zo(i)]=r}function a5(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=rd(r,o,t)}return rd(r,e.attrs,t)}function xw(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=rd(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function rd(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Q3(n,o,t?!0:e[++s]))}return n===void 0?null:n}function c5(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,l=c[a+1],d=Jq(l)?tN(c,e,t,i,xc(l),o):void 0;if(!lm(d)){lm(s)||Qq(l)&&(s=tN(c,null,t,i,a,o));let h=$N(ci(),t);nz(r,o,h,i,s)}}function tN(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],l=Array.isArray(c),d=l?c[1]:c,h=d===null,p=t[i+1];p===hn&&(p=h?hr:void 0);let _=h?yw(p,r):d===r?p:void 0;if(l&&!lm(_)&&(_=yw(c,r)),lm(_)&&(a=_,o))return a;let E=n[i+1];i=o?zo(E):xc(E)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=yw(c,r))}return a}function lm(n){return n!==void 0}function l5(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Cn(cd(n)))),n}function u5(n,e){return(n.flags&(e?8:16))!==0}function d5(n,e,t,r,i,s){let o=e.consts,a=Kp(o,i),c=Dm(e,n,2,r,a);return $P(e,t,c,Kp(o,s)),c.attrs!==null&&s0(c,c.attrs,!1),c.mergedAttrs!==null&&s0(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function v(n,e,t,r){let i=je(),s=Sn(),o=ii+n,a=i[Nt],c=s.firstCreatePass?d5(o,s,i,e,t,r):s.data[o],l=h5(s,i,c,a,e,n);i[o]=l;let d=D0(c);return od(c,!0),NP(a,l,c),!jq(c)&&N0()&&z0(s,i,l,c),U4()===0&&$o(l,i),B4(),d&&(UP(s,i,c),VP(s,c,i)),r!==null&&BP(i,c),v}function w(){let n=Hn();KN()?G4():(n=n.parent,od(n,!1));let e=n;H4(e)&&z4(),j4();let t=Sn();return t.firstCreatePass&&(M0(t,n),LN(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&sH(e)&&eN(t,e,je(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&oH(e)&&eN(t,e,je(),e.stylesWithoutHost,!1),w}function te(n,e,t,r){return v(n,e,t,r),w(),te}var h5=(n,e,t,r,i,s)=>(P0(!0),TP(r,i,tH()));function Ge(){return je()}var um="en-US";var f5=um;function p5(n){typeof n=="string"&&(f5=n.toLowerCase().replace(/_/g,"-"))}function j(n,e,t,r){let i=je(),s=Sn(),o=Hn();return s1(s,i,i[Nt],o,n,e,r),j}function m5(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Ju],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function s1(n,e,t,r,i,s,o){let a=D0(r),l=n.firstCreatePass&&xz(n),d=e[Pr],h=Az(e),p=!0;if(r.type&3||o){let A=pr(r,e),R=o?o(A):A,U=h.length,J=o?ee=>o(si(ee[r.index])):r.index,H=null;if(!o&&a&&(H=m5(n,e,i,r.index)),H!==null){let ee=H.__ngLastListenerFn__||H;ee.__ngNextListenerFn__=s,H.__ngLastListenerFn__=s,p=!1}else{s=rN(r,e,d,s,!1);let ee=t.listen(R,i,s);h.push(s,ee),l&&l.push(i,J,U,U+1)}}else s=rN(r,e,d,s,!1);let _=r.outputs,E;if(p&&_!==null&&(E=_[i])){let A=E.length;if(A)for(let R=0;R<A;R+=2){let U=E[R],J=E[R+1],fe=e[U][J].subscribe(s),re=h.length;h.push(s,fe),l&&l.push(i,r.index,re,-(re+1))}}}function nN(n,e,t,r){let i=Fe(null);try{return ei(6,e,t),t(r)!==!1}catch(s){return WP(n,s),!1}finally{ei(7,e,t),Fe(i)}}function rN(n,e,t,r,i){return function s(o){if(o===Function)return r;let a=n.componentOffset>-1?As(n.index,e):e;Y0(a);let c=nN(e,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=nN(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function ie(n=1){return eH(n)}function ks(n,e,t){return fn(n,"",e,"",t),ks}function fn(n,e,t,r,i){let s=je(),o=i1(s,e,t,r);if(o!==hn){let a=Sn(),c=Em();W0(a,c,s,n,o,s[Nt],i,!1)}return fn}function g5(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function I(n,e=""){let t=je(),r=Sn(),i=n+ii,s=r.firstCreatePass?Dm(r,i,1,e,null):r.data[i],o=_5(r,t,s,e,n);t[i]=o,N0()&&z0(r,t,o,s),od(s,!1)}var _5=(n,e,t,r,i)=>(P0(!0),LH(e[Nt],r));function rt(n){return Xi("",n,""),rt}function Xi(n,e,t){let r=je(),i=i1(r,n,e,t);return i!==hn&&ld(r,ci(),i),Xi}function Ko(n,e,t,r,i){let s=je(),o=qq(s,n,e,t,r,i);return o!==hn&&ld(s,ci(),o),Ko}function nE(n,e,t,r,i,s,o){let a=je(),c=Gq(a,n,e,t,r,i,s,o);return c!==hn&&ld(a,ci(),c),nE}function rE(n,e,t,r,i,s,o,a,c){let l=je(),d=Wq(l,n,e,t,r,i,s,o,a,c);return d!==hn&&ld(l,ci(),d),rE}function iE(n,e,t,r,i,s,o,a,c,l,d){let h=je(),p=Kq(h,n,e,t,r,i,s,o,a,c,l,d);return p!==hn&&ld(h,ci(),p),iE}function Lr(n,e,t){t1(e)&&(e=e());let r=je(),i=wm();if(ai(r,i,e)){let s=Sn(),o=Em();W0(s,o,r,n,e,r[Nt],t,!1)}return Lr}function ui(n,e){let t=t1(n);return t&&n.set(e),t}function Vr(n,e){let t=je(),r=Sn(),i=Hn();return s1(r,t,t[Nt],i,n,e),Vr}function y5(n,e,t){let r=Sn();if(r.firstCreatePass){let i=Ss(n);d0(t,r.data,r.blueprint,i,!0),d0(e,r.data,r.blueprint,i,!1)}}function d0(n,e,t,r,i){if(n=In(n),Array.isArray(n))for(let s=0;s<n.length;s++)d0(n[s],e,t,r,i);else{let s=Sn(),o=je(),a=Hn(),c=Cc(n)?n:In(n.provide),l=PN(n),d=a.providerIndexes&1048575,h=a.directiveStart,p=a.providerIndexes>>20;if(Cc(n)||!n.multi){let _=new jo(l,i,Z),E=kw(c,e,i?d:d+p,h);E===-1?(Hw(Xp(a,o),s,c),Rw(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),o.push(_)):(t[E]=_,o[E]=_)}else{let _=kw(c,e,d+p,h),E=kw(c,e,d,d+p),A=_>=0&&t[_],R=E>=0&&t[E];if(i&&!R||!i&&!A){Hw(Xp(a,o),s,c);let U=E5(i?w5:v5,t.length,i,r,l);!i&&R&&(t[E].providerFactory=U),Rw(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(U),o.push(U)}else{let U=o1(t[i?E:_],l,!i&&r);Rw(s,n,_>-1?_:E,U)}!i&&r&&R&&t[E].componentProviders++}}}function Rw(n,e,t,r){let i=Cc(e),s=g4(e);if(i||s){let c=(s?In(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,c]):l[d+1].push(r,c)}else l.push(t,c)}}}function o1(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function kw(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function v5(n,e,t,r){return h0(this.multi,[])}function w5(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Dc(t,t[Re],this.providerFactory.index,r);s=a.slice(0,o),h0(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],h0(i,s);return s}function h0(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function E5(n,e,t,r,i){let s=new jo(n,t,Z);return s.multi=[],s.index=e,s.componentProviders=0,o1(s,i,r&&!t),s}function ud(n,e=[]){return t=>{t.providersResolver=(r,i)=>y5(r,i?i(n):n,e)}}var I5=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=RN(!1,r.type),s=i.length>0?Nm([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ce({token:e,providedIn:"environment",factory:()=>new e(le(Bn))});let n=e;return n})();function a1(n){J0("NgStandalone"),n.getStandaloneInjector=e=>e.get(I5).getOrCreateStandaloneInjector(n)}function b5(n,e){let t=n[e];return t===hn?void 0:t}function C5(n,e,t,r,i,s){let o=e+t;return ai(n,o,i)?Uq(n,o+1,s?r.call(s,i):r(i)):b5(n,o+1)}function zn(n,e){let t=Sn(),r,i=n+ii;t.firstCreatePass?(r=T5(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=Lo(r.type,!0)),o,a=Un(Z);try{let c=Jp(!1),l=s();return Jp(c),g5(t,je(),i,l),l}finally{Un(a)}}function T5(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function qn(n,e,t){let r=n+ii,i=je(),s=M4(i,r);return S5(i,r)?C5(i,W4(),e,s.transform,t,s):s.transform(t)}function S5(n,e){return n[Re].data[e].pure}var Op=null;function D5(n){Op!==null&&(n.defaultEncapsulation!==Op.defaultEncapsulation||n.preserveWhitespaces!==Op.preserveWhitespaces)||(Op=n)}var Om=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var sE=new de(""),dd=new de(""),Fm=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,oE||(A5(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{nt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(le(nt),le(Lm),le(dd))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),Lm=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return oE?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function A5(n){oE=n}var oE;function Ns(n){return!!n&&typeof n.then=="function"}function aE(n){return!!n&&typeof n.subscribe=="function"}var Vm=new de(""),c1=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=X(Vm,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ns(o))r.push(o);else if(aE(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),cE=new de("");function x5(){XR(()=>{throw new oe(600,!1)})}function R5(n){return n.isBoundToModule}function k5(n,e,t){try{let r=t();return Ns(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function l1(n,e){return Array.isArray(e)?e.reduce(l1,n):q(q({},n),e)}var Nc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=X(fP),this.afterRenderEffectManager=X(Z0),this.externalTestViews=new Set,this.beforeRender=new ln,this.afterTick=new ln,this.componentTypes=[],this.components=[],this.isStable=X(Pm).hasPendingTasks.pipe(xe(r=>!r)),this._injector=X(Bn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof rm;if(!this._injector.get(c1).done){let _=!s&&SN(r),E=!1;throw new oe(405,E)}let a;s?a=r:a=this._injector.get(Rm).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=R5(a)?void 0:this._injector.get(Ds),l=i||a.selector,d=a.create(Fr.NULL,[],l,c),h=d.location.nativeElement,p=d.injector.get(sE,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),Bp(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new oe(101,!1);let i=Fe(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Fe(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===QP)throw new oe(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)N5(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>f0(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>f0(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Bp(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(cE,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Bp(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new oe(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Bp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function N5(n,e,t){!e&&!f0(n)||P5(n,t,e)}function f0(n){return x0(n)}function P5(n,e,t){let r;t?(r=0,n[me]|=1024):n[me]&64?r=0:r=1,YP(n,e,r)}var p0=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Um=(()=>{let e=class e{compileModuleSync(r){return new am(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=DN(r),o=CP(s.declarations).reduce((a,c)=>{let l=Ts(c);return l&&a.push(new Ac(l)),a},[]);return new p0(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),M5=new de("");function O5(n,e,t){let r=new am(t);return Promise.resolve(r)}function iN(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var F5=(()=>{let e=class e{constructor(){this.zone=X(nt),this.applicationRef=X(Nc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function L5(n){return[{provide:nt,useFactory:n},{provide:bc,multi:!0,useFactory:()=>{let e=X(F5,{optional:!0});return()=>e.initialize()}},{provide:bc,multi:!0,useFactory:()=>{let e=X(B5);return()=>{e.initialize()}}},{provide:fP,useFactory:V5}]}function V5(){let n=X(nt),e=X(oi);return t=>n.runOutsideAngular(()=>e.handleError(t))}function U5(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var B5=(()=>{let e=class e{constructor(){this.subscription=new $t,this.initialized=!1,this.zone=X(nt),this.pendingTasks=X(Pm)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{nt.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{nt.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function j5(){return typeof $localize<"u"&&$localize.locale||um}var lE=new de("",{providedIn:"root",factory:()=>X(lE,Ce.Optional|Ce.SkipSelf)||j5()});var u1=new de(""),d1=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=sq(i?.ngZone,U5({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Fq(r.moduleType,this.injector,L5(()=>s)),a=o.injector.get(oi,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Bp(this._modules,o),c.unsubscribe()})}),k5(a,s,()=>{let c=o.injector.get(c1);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(lE,um);return p5(l||um),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=l1({},i);return O5(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Nc);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new oe(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new oe(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(u1,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(le(Fr))},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Wu=null,h1=new de("");function $5(n){if(Wu&&!Wu.get(h1,!1))throw new oe(400,!1);x5(),Wu=n;let e=n.get(d1);return q5(n),e}function uE(n,e,t=[]){let r=`Platform: ${e}`,i=new de(r);return(s=[])=>{let o=f1();if(!o||o.injector.get(h1,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):$5(H5(a,r))}return z5(i)}}function H5(n=[],e){return Fr.create({name:e,providers:[{provide:mm,useValue:"platform"},{provide:u1,useValue:new Set([()=>Wu=null])},...n]})}function z5(n){let e=f1();if(!e)throw new oe(401,!1);return e}function f1(){return Wu?.get(d1)??null}function q5(n){n.get(V0,null)?.forEach(t=>t())}var Ps=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=G5;let n=e;return n})();function G5(n){return W5(Hn(),je(),(n&16)===16)}function W5(n,e,t){if(ym(n)&&!t){let r=As(n.index,e);return new Ho(r,r)}else if(n.type&47){let r=e[ri];return new Ho(r,e)}return null}var m0=class{constructor(){}supports(e){return n1(e)}create(e){return new g0(e)}},K5=(n,e)=>e,g0=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||K5}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<sN(r,i,s)?t:r,a=sN(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let p=0;p<l;p++){let _=p<s.length?s[p]:s[p]=0,E=_+p;d<=E&&E<l&&(s[p]=_+1)}let h=o.previousIndex;s[h]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!n1(e))throw new oe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,Lq(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new _0(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new dm),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new dm),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},_0=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},y0=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},dm=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new y0,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function sN(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function oN(){return new dE([new m0])}var dE=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||oN()),deps:[[e,new E0,new pm]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new oe(901,!1)}};e.\u0275prov=ce({token:e,providedIn:"root",factory:oN});let n=e;return n})();var p1=uE(null,"core",[]),m1=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(le(Nc))},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({});let n=e;return n})();function Qo(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function hE(n){let e=Fe(null);try{return n()}finally{Fe(e)}}function g1(n){let e=Ts(n);if(!e)return null;let t=new Ac(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var E1=null;function di(){return E1}function I1(n){E1??=n}var Bm=class{};var Gn=new de(""),wE=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>X(Q5),providedIn:"platform"});let n=e;return n})(),b1=new de(""),Q5=(()=>{let e=class e extends wE{constructor(){super(),this._doc=X(Gn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return di().getBaseHref(this._doc)}onPopState(r){let i=di().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=di().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function EE(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function _1(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Zi(n){return n&&n[0]!=="?"?"?"+n:n}var Ur=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>X(IE),providedIn:"root"});let n=e;return n})(),C1=new de(""),IE=(()=>{let e=class e extends Ur{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??X(Gn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return EE(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Zi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Zi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Zi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(le(wE),le(C1,8))},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),$m=(()=>{let e=class e extends Ur{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=EE(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Zi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Zi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(le(wE),le(C1,8))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),Pc=(()=>{let e=class e{constructor(r){this._subject=new Ht,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=X5(_1(y1(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Zi(i))}normalize(r){return e.stripTrailingSlash(J5(this._basePath,y1(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Zi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Zi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Zi,e.joinWithSlash=EE,e.stripTrailingSlash=_1,e.\u0275fac=function(i){return new(i||e)(le(Ur))},e.\u0275prov=ce({token:e,factory:()=>Y5(),providedIn:"root"});let n=e;return n})();function Y5(){return new Pc(le(Ur))}function J5(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function y1(n){return n.replace(/\/index.html$/,"")}function X5(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function T1(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var fE=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},mr=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new fE(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),v1(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);v1(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Z(kc),Z(xm),Z(dE))},e.\u0275dir=dn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function v1(n,e){n.context.$implicit=e.item}var Wt=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new pE,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){w1("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){w1("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(Z(kc),Z(xm))},e.\u0275dir=dn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),pE=class{constructor(){this.$implicit=null,this.ngIf=null}};function w1(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Cn(e)}'.`)}function Z5(n,e){return new oe(2100,!1)}var mE=class{createSubscription(e,t){return hE(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){hE(()=>e.unsubscribe())}},gE=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},eG=new gE,tG=new mE,gr=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(Ns(r))return eG;if(aE(r))return tG;throw Z5(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(Z(Ps,16))},e.\u0275pipe=bN({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var S1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({});let n=e;return n})(),bE="browser",nG="server";function rG(n){return n===bE}function CE(n){return n===nG}var D1=(()=>{let e=class e{};e.\u0275prov=ce({token:e,providedIn:"root",factory:()=>rG(X(xs))?new _E(X(Gn),window):new yE});let n=e;return n})(),_E=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=iG(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function iG(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var yE=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},jm=class{};var DE=class extends Bm{constructor(){super(...arguments),this.supportsDOMEvents=!0}},AE=class n extends DE{static makeCurrent(){I1(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=oG();return t==null?null:aG(t)}resetBaseElement(){hd=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return T1(document.cookie,e)}},hd=null;function oG(){return hd=hd||document.querySelector("base"),hd?hd.getAttribute("href"):null}function aG(n){return new URL(n,document.baseURI).pathname}var xE=class{addToWindow(e){bn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new oe(5103,!1);return s},bn.getAllAngularTestabilities=()=>e.getAllTestabilities(),bn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=bn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};bn.frameworkStabilizers||(bn.frameworkStabilizers=[]),bn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?di().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},cG=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),RE=new de(""),k1=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new oe(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(le(RE),le(nt))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),Hm=class{constructor(e){this._doc=e}},TE="ng-app-id",N1=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=CE(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${TE}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(TE),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(TE,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(le(Gn),le(bm),le(U0,8),le(xs))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),SE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},NE=/%COMP%/g,P1="%COMP%",lG=`_nghost-${P1}`,uG=`_ngcontent-${P1}`,dG=!0,hG=new de("",{providedIn:"root",factory:()=>dG});function fG(n){return uG.replace(NE,n)}function pG(n){return lG.replace(NE,n)}function M1(n,e){return e.map(t=>t.replace(NE,n))}var A1=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=CE(c),this.defaultRenderer=new fd(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ni.ShadowDom&&(i=Qe(q({},i),{encapsulation:ni.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof zm?s.applyToHost(r):s instanceof pd&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case ni.Emulated:o=new zm(l,d,i,this.appId,h,a,c,p);break;case ni.ShadowDom:return new kE(l,d,r,i,a,c,this.nonce,p);default:o=new pd(l,d,i,h,a,c,p);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(le(k1),le(N1),le(bm),le(hG),le(Gn),le(xs),le(nt),le(U0))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),fd=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(SE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(x1(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(x1(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new oe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=SE[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=SE[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Gi.DashCase|Gi.Important)?e.style.setProperty(t,r,i&Gi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Gi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=di().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function x1(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var kE=class extends fd{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=M1(i.id,i.styles);for(let d of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},pd=class extends fd{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?M1(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},zm=class extends pd{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=fG(l),this.hostAttr=pG(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},mG=(()=>{let e=class e extends Hm{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(le(Gn))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})(),R1=["alt","control","meta","shift"],gG={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_G={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},yG=(()=>{let e=class e extends Hm{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>di().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),R1.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=gG[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),R1.forEach(a=>{if(a!==s){let c=_G[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(le(Gn))},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})();function vG(){AE.makeCurrent()}function wG(){return new oi}function EG(){return vP(document),document}var IG=[{provide:xs,useValue:bE},{provide:V0,useValue:vG,multi:!0},{provide:Gn,useFactory:EG,deps:[]}],O1=uE(p1,"browser",IG),bG=new de(""),CG=[{provide:dd,useClass:xE,deps:[]},{provide:sE,useClass:Fm,deps:[nt,Lm,dd]},{provide:Fm,useClass:Fm,deps:[nt,Lm,dd]}],TG=[{provide:mm,useValue:"root"},{provide:oi,useFactory:wG,deps:[]},{provide:RE,useClass:mG,multi:!0,deps:[Gn,nt,xs]},{provide:RE,useClass:yG,multi:!0,deps:[Gn]},A1,N1,k1,{provide:td,useExisting:A1},{provide:jm,useClass:cG,deps:[]},[]],F1=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:bm,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(le(bG,12))},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({providers:[...TG,...CG],imports:[S1,m1]});let n=e;return n})();var L1=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(le(Gn))},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var we="primary",xd=Symbol("RouteTitle"),LE=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Vc(n){return new LE(n)}function SG(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function DG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!hi(n[t],e[t]))return!1;return!0}function hi(n,e){let t=n?VE(n):void 0,r=e?VE(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!W1(n[i],e[i]))return!1;return!0}function VE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function W1(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function K1(n){return n.length>0?n[n.length-1]:null}function Ls(n){return dw(n)?n:Ns(n)?ft(Promise.resolve(n)):pe(n)}var AG={exact:Y1,subset:J1},Q1={exact:xG,subset:RG,ignored:()=>!0};function U1(n,e,t){return AG[t.paths](n.root,e.root,t.matrixParams)&&Q1[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function xG(n,e){return hi(n,e)}function Y1(n,e,t){if(!Jo(n.segments,e.segments)||!Wm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Y1(n.children[r],e.children[r],t))return!1;return!0}function RG(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>W1(n[t],e[t]))}function J1(n,e,t){return X1(n,e,e.segments,t)}function X1(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Jo(i,t)||e.hasChildren()||!Wm(i,t,r))}else if(n.segments.length===t.length){if(!Jo(n.segments,t)||!Wm(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!J1(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Jo(n.segments,i)||!Wm(n.segments,i,r)||!n.children[we]?!1:X1(n.children[we],e,s,r)}}function Wm(n,e,t){return e.every((r,i)=>Q1[t](n[i].parameters,r.parameters))}var Ms=class{constructor(e=new qe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Vc(this.queryParams),this._queryParamMap}toString(){return PG.serialize(this)}},qe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Km(this)}},Yo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Vc(this.parameters),this._parameterMap}toString(){return eM(this)}};function kG(n,e){return Jo(n,e)&&n.every((t,r)=>hi(t.parameters,e[r].parameters))}function Jo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function NG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===we&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==we&&(t=t.concat(e(i,r)))}),t}var Rd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>new Ed,providedIn:"root"});let n=e;return n})(),Ed=class{parse(e){let t=new BE(e);return new Ms(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${md(e.root,!0)}`,r=FG(e.queryParams),i=typeof e.fragment=="string"?`#${MG(e.fragment)}`:"";return`${t}${r}${i}`}},PG=new Ed;function Km(n){return n.segments.map(e=>eM(e)).join("/")}function md(n,e){if(!n.hasChildren())return Km(n);if(e){let t=n.children[we]?md(n.children[we],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==we&&r.push(`${i}:${md(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=NG(n,(r,i)=>i===we?[md(n.children[we],!1)]:[`${i}:${md(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[we]!=null?`${Km(n)}/${t[0]}`:`${Km(n)}/(${t.join("//")})`}}function Z1(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qm(n){return Z1(n).replace(/%3B/gi,";")}function MG(n){return encodeURI(n)}function UE(n){return Z1(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Qm(n){return decodeURIComponent(n)}function B1(n){return Qm(n.replace(/\+/g,"%20"))}function eM(n){return`${UE(n.path)}${OG(n.parameters)}`}function OG(n){return Object.entries(n).map(([e,t])=>`;${UE(e)}=${UE(t)}`).join("")}function FG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${qm(t)}=${qm(i)}`).join("&"):`${qm(t)}=${qm(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var LG=/^[^\/()?;#]+/;function PE(n){let e=n.match(LG);return e?e[0]:""}var VG=/^[^\/()?;=#]+/;function UG(n){let e=n.match(VG);return e?e[0]:""}var BG=/^[^=?&#]+/;function jG(n){let e=n.match(BG);return e?e[0]:""}var $G=/^[^&#]+/;function HG(n){let e=n.match($G);return e?e[0]:""}var BE=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new qe([],{}):new qe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[we]=new qe(e,t)),r}parseSegment(){let e=PE(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new oe(4009,!1);return this.capture(e),new Yo(Qm(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=UG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=PE(this.remaining);i&&(r=i,this.capture(r))}e[Qm(t)]=Qm(r)}parseQueryParam(e){let t=jG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=HG(this.remaining);o&&(r=o,this.capture(r))}let i=B1(t),s=B1(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=PE(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new oe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=we);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[we]:new qe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new oe(4011,!1)}};function tM(n){return n.segments.length>0?new qe([],{[we]:n}):n}function nM(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=nM(i);if(r===we&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new qe(n.segments,e);return zG(t)}function zG(n){if(n.numberOfChildren===1&&n.children[we]){let e=n.children[we];return new qe(n.segments.concat(e.segments),e.children)}return n}function Uc(n){return n instanceof Ms}function qG(n,e,t=null,r=null){let i=rM(n);return iM(i,e,t,r)}function rM(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new qe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=tM(r);return e??i}function iM(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return ME(i,i,i,t,r);let s=GG(e);if(s.toRoot())return ME(i,i,new qe([],{}),t,r);let o=WG(s,i,n),a=o.processChildren?yd(o.segmentGroup,o.index,s.commands):oM(o.segmentGroup,o.index,s.commands);return ME(i,o.segmentGroup,a,t,r)}function Ym(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Id(n){return typeof n=="object"&&n!=null&&n.outlets}function ME(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=sM(n,e,t);let a=tM(nM(o));return new Ms(a,s,i)}function sM(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=sM(s,e,t)}),new qe(n.segments,r)}var Jm=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ym(r[0]))throw new oe(4003,!1);let i=r.find(Id);if(i&&i!==K1(r))throw new oe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function GG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Jm(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Jm(t,e,r)}var Fc=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function WG(n,e,t){if(n.isAbsolute)return new Fc(e,!0,0);if(!t)return new Fc(e,!1,NaN);if(t.parent===null)return new Fc(t,!0,0);let r=Ym(n.commands[0])?0:1,i=t.segments.length-1+r;return KG(t,i,n.numberOfDoubleDots)}function KG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new oe(4005,!1);i=r.segments.length}return new Fc(r,!1,i-s)}function QG(n){return Id(n[0])?n[0].outlets:{[we]:n}}function oM(n,e,t){if(n??=new qe([],{}),n.segments.length===0&&n.hasChildren())return yd(n,e,t);let r=YG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new qe(n.segments.slice(0,r.pathIndex),{});return s.children[we]=new qe(n.segments.slice(r.pathIndex),n.children),yd(s,0,i)}else return r.match&&i.length===0?new qe(n.segments,{}):r.match&&!n.hasChildren()?jE(n,e,t):r.match?yd(n,0,i):jE(n,e,t)}function yd(n,e,t){if(t.length===0)return new qe(n.segments,{});{let r=QG(t),i={};if(Object.keys(r).some(s=>s!==we)&&n.children[we]&&n.numberOfChildren===1&&n.children[we].segments.length===0){let s=yd(n.children[we],e,t);return new qe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=oM(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new qe(n.segments,i)}}function YG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(Id(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!$1(c,l,o))return s;r+=2}else{if(!$1(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function jE(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Id(s)){let c=JG(s.outlets);return new qe(r,c)}if(i===0&&Ym(t[0])){let c=n.segments[e];r.push(new Yo(c.path,j1(t[0]))),i++;continue}let o=Id(s)?s.outlets[we]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Ym(a)?(r.push(new Yo(o,j1(a))),i+=2):(r.push(new Yo(o,{})),i++)}return new qe(r,{})}function JG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=jE(new qe([],{}),0,r))}),e}function j1(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function $1(n,e,t){return n==t.path&&hi(e,t.parameters)}var vd="imperative",Kt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Kt||{}),_r=class{constructor(e,t){this.id=e,this.url=t}},Bc=class extends _r{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Kt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},fi=class extends _r{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Kt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},tr=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(tr||{}),Xm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Xm||{}),Os=class extends _r{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Kt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Fs=class extends _r{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Kt.NavigationSkipped}},bd=class extends _r{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Kt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Zm=class extends _r{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Kt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$E=class extends _r{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Kt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},HE=class extends _r{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Kt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},zE=class extends _r{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Kt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qE=class extends _r{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Kt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},GE=class{constructor(e){this.route=e,this.type=Kt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},WE=class{constructor(e){this.route=e,this.type=Kt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},KE=class{constructor(e){this.snapshot=e,this.type=Kt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},QE=class{constructor(e){this.snapshot=e,this.type=Kt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},YE=class{constructor(e){this.snapshot=e,this.type=Kt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},JE=class{constructor(e){this.snapshot=e,this.type=Kt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},eg=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Kt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Cd=class{},Td=class{constructor(e){this.url=e}};var XE=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new kd,this.attachRef=null}},kd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new XE,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),tg=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=ZE(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=ZE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=eI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return eI(e,this._root).map(t=>t.value)}};function ZE(n,e){if(n===e.value)return e;for(let t of e.children){let r=ZE(n,t);if(r)return r}return null}function eI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=eI(n,t);if(r.length)return r.unshift(e),r}return[]}var er=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Oc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ng=class extends tg{constructor(e,t){super(e),this.snapshot=t,uI(this,e)}toString(){return this.snapshot.toString()}};function aM(n){let e=XG(n),t=new Ae([new Yo("",{})]),r=new Ae({}),i=new Ae({}),s=new Ae({}),o=new Ae(""),a=new jr(t,r,s,o,i,we,n,e.root);return a.snapshot=e.root,new ng(new er(a,[]),e)}function XG(n){let e={},t={},r={},i="",s=new Sd([],e,r,i,t,we,n,null,{});return new rg("",new er(s,[]))}var jr=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(xe(l=>l[xd]))??pe(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(xe(e=>Vc(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(xe(e=>Vc(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function lI(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&lM(i)&&(r.resolve[xd]=i.title),r}var Sd=class{get title(){return this.data?.[xd]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Vc(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Vc(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},rg=class extends tg{constructor(e,t){super(t),this.url=e,uI(this,t)}toString(){return cM(this._root)}};function uI(n,e){e.value._routerState=n,e.children.forEach(t=>uI(n,t))}function cM(n){let e=n.children.length>0?` { ${n.children.map(cM).join(", ")} } `:"";return`${n.value}${e}`}function OE(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,hi(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),hi(e.params,t.params)||n.paramsSubject.next(t.params),DG(e.url,t.url)||n.urlSubject.next(t.url),hi(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function tI(n,e){let t=hi(n.params,e.params)&&kG(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||tI(n.parent,e.parent))}function lM(n){return typeof n.title=="string"||n.title===null}var dI=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=we,this.activateEvents=new Ht,this.deactivateEvents=new Ht,this.attachEvents=new Ht,this.detachEvents=new Ht,this.parentContexts=X(kd),this.location=X(kc),this.changeDetector=X(Ps),this.environmentInjector=X(Bn),this.inputBinder=X(cg,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new oe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new oe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new oe(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new oe(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new nI(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=dn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Go]});let n=e;return n})(),nI=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===jr?this.route:e===kd?this.childContexts:this.parent.get(e,t)}},cg=new de(""),H1=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=zu([i.queryParams,i.params,i.data]).pipe(dr(([o,a,c],l)=>(c=q(q(q({},o),a),c),l===0?pe(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=g1(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})();function ZG(n,e,t){let r=Dd(n,e._root,t?t._root:void 0);return new ng(r,e)}function Dd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=eW(n,e,t);return new er(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Dd(n,a)),o}}let r=tW(e.value),i=e.children.map(s=>Dd(n,s));return new er(r,i)}}function eW(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Dd(n,r,i);return Dd(n,r)})}function tW(n){return new jr(new Ae(n.url),new Ae(n.params),new Ae(n.queryParams),new Ae(n.fragment),new Ae(n.data),n.outlet,n.component,n)}var uM="ngNavigationCancelingError";function dM(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Uc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=hM(!1,tr.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function hM(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[uM]=!0,t.cancellationCode=e,t}function nW(n){return fM(n)&&Uc(n.url)}function fM(n){return!!n&&n[uM]}var rW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$e({type:e,selectors:[["ng-component"]],standalone:!0,features:[a1],decls:1,vars:0,template:function(i,s){i&1&&te(0,"router-outlet")},dependencies:[dI],encapsulation:2});let n=e;return n})();function iW(n,e){return n.providers&&!n._injector&&(n._injector=Nm(n.providers,e,`Route: ${n.path}`)),n._injector??e}function hI(n){let e=n.children&&n.children.map(hI),t=e?Qe(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==we&&(t.component=rW),t}function pi(n){return n.outlet||we}function sW(n,e){let t=n.filter(r=>pi(r)===e);return t.push(...n.filter(r=>pi(r)!==e)),t}function Nd(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var oW=(n,e,t,r)=>xe(i=>(new rI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),rI=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),OE(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Oc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Oc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Oc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Oc(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new JE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new QE(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(OE(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),OE(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Nd(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},ig=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Lc=class{constructor(e,t){this.component=e,this.route=t}};function aW(n,e,t){let r=n._root,i=e?e._root:null;return gd(r,i,t,[r.value])}function cW(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function $c(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!uN(n)?n:e.get(n):r}function gd(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Oc(e);return n.children.forEach(o=>{lW(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>wd(a,t.getContext(o),i)),i}function lW(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=uW(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new ig(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?gd(n,e,a?a.children:null,r,i):gd(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Lc(a.outlet.component,o))}else o&&wd(e,a,i),i.canActivateChecks.push(new ig(r)),s.component?gd(n,null,a?a.children:null,r,i):gd(n,null,t,r,i);return i}function uW(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Jo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Jo(n.url,e.url)||!hi(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tI(n,e)||!hi(n.queryParams,e.queryParams);case"paramsChange":default:return!tI(n,e)}}function wd(n,e,t){let r=Oc(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?wd(o,e.children.getContext(s),t):wd(o,null,t):wd(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Lc(e.outlet.component,i)):t.canDeactivateChecks.push(new Lc(null,i)):t.canDeactivateChecks.push(new Lc(null,i))}function Pd(n){return typeof n=="function"}function dW(n){return typeof n=="boolean"}function hW(n){return n&&Pd(n.canLoad)}function fW(n){return n&&Pd(n.canActivate)}function pW(n){return n&&Pd(n.canActivateChild)}function mW(n){return n&&Pd(n.canDeactivate)}function gW(n){return n&&Pd(n.canMatch)}function pM(n){return n instanceof zi||n?.name==="EmptyError"}var Gm=Symbol("INITIAL_VALUE");function jc(){return dr(n=>zu(n.map(e=>e.pipe(qi(1),gw(Gm)))).pipe(xe(e=>{for(let t of e)if(t!==!0){if(t===Gm)return Gm;if(t===!1||t instanceof Ms)return t}return!0}),ur(e=>e!==Gm),qi(1)))}function _W(n,e){return kt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?pe(Qe(q({},t),{guardsResult:!0})):yW(o,r,i,n).pipe(kt(a=>a&&dW(a)?vW(r,s,n,e):pe(a)),xe(a=>Qe(q({},t),{guardsResult:a})))})}function yW(n,e,t,r){return ft(n).pipe(kt(i=>CW(i.component,i.route,t,e,r)),Zr(i=>i!==!0,!0))}function vW(n,e,t,r){return ft(e).pipe(Mo(i=>pc(EW(i.route.parent,r),wW(i.route,r),bW(n,i.path,t),IW(n,i.route,t))),Zr(i=>i!==!0,!0))}function wW(n,e){return n!==null&&e&&e(new YE(n)),pe(!0)}function EW(n,e){return n!==null&&e&&e(new KE(n)),pe(!0)}function IW(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return pe(!0);let i=r.map(s=>xp(()=>{let o=Nd(e)??t,a=$c(s,o),c=fW(a)?a.canActivate(e,n):Wi(o,()=>a(e,n));return Ls(c).pipe(Zr())}));return pe(i).pipe(jc())}function bW(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>cW(o)).filter(o=>o!==null).map(o=>xp(()=>{let a=o.guards.map(c=>{let l=Nd(o.node)??t,d=$c(c,l),h=pW(d)?d.canActivateChild(r,n):Wi(l,()=>d(r,n));return Ls(h).pipe(Zr())});return pe(a).pipe(jc())}));return pe(s).pipe(jc())}function CW(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return pe(!0);let o=s.map(a=>{let c=Nd(e)??i,l=$c(a,c),d=mW(l)?l.canDeactivate(n,e,t,r):Wi(c,()=>l(n,e,t,r));return Ls(d).pipe(Zr())});return pe(o).pipe(jc())}function TW(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return pe(!0);let s=i.map(o=>{let a=$c(o,n),c=hW(a)?a.canLoad(e,t):Wi(n,()=>a(e,t));return Ls(c)});return pe(s).pipe(jc(),mM(r))}function mM(n){return aw(tn(e=>{if(Uc(e))throw dM(n,e)}),xe(e=>e===!0))}function SW(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return pe(!0);let s=i.map(o=>{let a=$c(o,n),c=gW(a)?a.canMatch(e,t):Wi(n,()=>a(e,t));return Ls(c)});return pe(s).pipe(jc(),mM(r))}var Ad=class{constructor(e){this.segmentGroup=e||null}},sg=class extends Error{constructor(e){super(),this.urlTree=e}};function Mc(n){return hc(new Ad(n))}function DW(n){return hc(new oe(4e3,!1))}function AW(n){return hc(hM(!1,tr.GuardRejected))}var iI=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return pe(r);if(i.numberOfChildren>1||!i.children[we])return DW(e.redirectTo);i=i.children[we]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new sg(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Ms(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new qe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new oe(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},sI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xW(n,e,t,r,i){let s=fI(n,e,t);return s.matched?(r=iW(e,r),SW(r,e,t,i).pipe(xe(o=>o===!0?s:q({},sI)))):pe(s)}function fI(n,e,t){if(e.path==="**")return RW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},sI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||SG)(t,n,e);if(!i)return q({},sI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?q(q({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function RW(n){return{matched:!0,parameters:n.length>0?K1(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function z1(n,e,t,r){return t.length>0&&PW(n,t,r)?{segmentGroup:new qe(e,NW(r,new qe(t,n.children))),slicedSegments:[]}:t.length===0&&MW(n,t,r)?{segmentGroup:new qe(n.segments,kW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new qe(n.segments,n.children),slicedSegments:t}}function kW(n,e,t,r){let i={};for(let s of t)if(lg(n,e,s)&&!r[pi(s)]){let o=new qe([],{});i[pi(s)]=o}return q(q({},r),i)}function NW(n,e){let t={};t[we]=e;for(let r of n)if(r.path===""&&pi(r)!==we){let i=new qe([],{});t[pi(r)]=i}return t}function PW(n,e,t){return t.some(r=>lg(n,e,r)&&pi(r)!==we)}function MW(n,e,t){return t.some(r=>lg(n,e,r))}function lg(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function OW(n,e,t,r){return pi(n)!==r&&(r===we||!lg(e,t,n))?!1:fI(e,n,t).matched}function FW(n,e,t){return e.length===0&&!n.children[t]}var oI=class{};function LW(n,e,t,r,i,s,o="emptyOnly"){return new aI(n,e,t,r,i,o,s).recognize()}var VW=31,aI=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new iI(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new oe(4002,`'${e.segmentGroup}'`)}recognize(){let e=z1(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(xe(t=>{let r=new Sd([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,{},we,this.rootComponentType,null,{}),i=new er(r,t),s=new rg("",i),o=qG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,we).pipe(Es(r=>{if(r instanceof sg)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Ad?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=lI(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(xe(s=>s instanceof er?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ft(i).pipe(Mo(s=>{let o=r.children[s],a=sW(t,s);return this.processSegmentGroup(e,a,o,s)}),mw((s,o)=>(s.push(...o),s)),Is(null),pw(),kt(s=>{if(s===null)return Mc(r);let o=gM(s);return UW(o),pe(o)}))}processSegment(e,t,r,i,s,o){return ft(t).pipe(Mo(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Es(c=>{if(c instanceof Ad)return pe(null);throw c}))),Zr(a=>!!a),Es(a=>{if(pM(a))return FW(r,i,s)?pe(new oI):Mc(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return OW(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Mc(i):Mc(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=fI(t,i,s);if(!a)return Mc(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>VW&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,h).pipe(kt(p=>this.processSegment(e,r,t,p.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=xW(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(dr(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(dr(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:p}=a,_=new Sd(d,p,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,jW(r),pi(r),r.component??r._loadedComponent??null,r,$W(r)),{segmentGroup:E,slicedSegments:A}=z1(t,d,h,c);if(A.length===0&&E.hasChildren())return this.processChildren(l,c,E).pipe(xe(U=>U===null?null:new er(_,U)));if(c.length===0&&A.length===0)return pe(new er(_,[]));let R=pi(r)===s;return this.processSegment(l,c,E,A,R?we:s,!0).pipe(xe(U=>new er(_,U instanceof er?[U]:[])))}))):Mc(t)))}getChildConfig(e,t,r){return t.children?pe({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?pe({routes:t._loadedRoutes,injector:t._loadedInjector}):TW(e,t,r,this.urlSerializer).pipe(kt(i=>i?this.configLoader.loadChildren(e,t).pipe(tn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):AW(t))):pe({routes:[],injector:e})}};function UW(n){n.sort((e,t)=>e.value.outlet===we?-1:t.value.outlet===we?1:e.value.outlet.localeCompare(t.value.outlet))}function BW(n){let e=n.value.routeConfig;return e&&e.path===""}function gM(n){let e=[],t=new Set;for(let r of n){if(!BW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=gM(r.children);e.push(new er(r.value,i))}return e.filter(r=>!t.has(r))}function jW(n){return n.data||{}}function $W(n){return n.resolve||{}}function HW(n,e,t,r,i,s){return kt(o=>LW(n,e,t,r,o.extractedUrl,i,s).pipe(xe(({state:a,tree:c})=>Qe(q({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function zW(n,e){return kt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return pe(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of _M(c))o.add(l);let a=0;return ft(o).pipe(Mo(c=>s.has(c)?qW(c,r,n,e):(c.data=lI(c,c.parent,n).resolve,pe(void 0))),tn(()=>a++),mc(1),kt(c=>a===o.size?pe(t):Zn))})}function _M(n){let e=n.children.map(t=>_M(t)).flat();return[n,...e]}function qW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!lM(i)&&(s[xd]=i.title),GW(s,n,e,r).pipe(xe(o=>(n._resolvedData=o,n.data=lI(n,n.parent,t).resolve,null)))}function GW(n,e,t,r){let i=VE(n);if(i.length===0)return pe({});let s={};return ft(i).pipe(kt(o=>WW(n[o],e,t,r).pipe(Zr(),tn(a=>{s[o]=a}))),mc(1),fw(s),Es(o=>pM(o)?Zn:hc(o)))}function WW(n,e,t,r){let i=Nd(e)??r,s=$c(n,i),o=s.resolve?s.resolve(e,t):Wi(i,()=>s(e,t));return Ls(o)}function FE(n){return dr(e=>{let t=n(e);return t?ft(t).pipe(xe(()=>e)):pe(e)})}var yM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===we);return i}getResolvedTitleForRoute(r){return r.data[xd]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>X(KW),providedIn:"root"});let n=e;return n})(),KW=(()=>{let e=class e extends yM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(le(L1))},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Md=new de("",{providedIn:"root",factory:()=>({})}),og=new de(""),pI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=X(Um)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return pe(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Ls(r.loadComponent()).pipe(xe(vM),tn(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),qu(()=>{this.componentLoaders.delete(r)})),s=new dc(i,()=>new ln).pipe(uc());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return pe({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=QW(i,this.compiler,r,this.onLoadEndListener).pipe(qu(()=>{this.childrenLoaders.delete(i)})),a=new dc(o,()=>new ln).pipe(uc());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function QW(n,e,t,r){return Ls(n.loadChildren()).pipe(xe(vM),kt(i=>i instanceof nd||Array.isArray(i)?pe(i):ft(e.compileModuleAsync(i))),xe(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(og,[],{optional:!0,self:!0}).flat()),{routes:o.map(hI),injector:s}}))}function YW(n){return n&&typeof n=="object"&&"default"in n}function vM(n){return YW(n)?n.default:n}var mI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>X(JW),providedIn:"root"});let n=e;return n})(),JW=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),wM=new de(""),EM=new de("");function XW(n,e,t){let r=n.get(EM),i=n.get(Gn);return n.get(nt).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),ZW(n))),{onViewTransitionCreated:c}=r;return c&&Wi(n,()=>c({transition:a,from:e,to:t})),o})}function ZW(n){return new Promise(e=>{km(e,{injector:n})})}var gI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ln,this.transitionAbortSubject=new ln,this.configLoader=X(pI),this.environmentInjector=X(Bn),this.urlSerializer=X(Rd),this.rootContexts=X(kd),this.location=X(Pc),this.inputBindingEnabled=X(cg,{optional:!0})!==null,this.titleStrategy=X(yM),this.options=X(Md,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=X(mI),this.createViewTransition=X(wM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>pe(void 0),this.rootComponentType=null;let r=s=>this.events.next(new GE(s)),i=s=>this.events.next(new WE(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Qe(q(q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ae({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:vd,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ur(o=>o.id!==0),xe(o=>Qe(q({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),dr(o=>{let a=!1,c=!1;return pe(o).pipe(dr(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",tr.SupersededByNewNavigation),Zn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Qe(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new Fs(l.id,this.urlSerializer.serialize(l.rawUrl),p,Xm.IgnoredSameUrlNavigation)),l.resolve(null),Zn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return pe(l).pipe(dr(p=>{let _=this.transitions?.getValue();return this.events.next(new Bc(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),_!==this.transitions?.getValue()?Zn:Promise.resolve(p)}),HW(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),tn(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Qe(q({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let _=new Zm(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(_)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:_,source:E,restoredState:A,extras:R}=l,U=new Bc(p,this.urlSerializer.serialize(_),E,A);this.events.next(U);let J=aM(this.rootComponentType).snapshot;return this.currentTransition=o=Qe(q({},l),{targetSnapshot:J,urlAfterRedirects:_,extras:Qe(q({},R),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=_,pe(o)}else{let p="";return this.events.next(new Fs(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Xm.IgnoredByUrlHandlingStrategy)),l.resolve(null),Zn}}),tn(l=>{let d=new $E(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),xe(l=>(this.currentTransition=o=Qe(q({},l),{guards:aW(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),_W(this.environmentInjector,l=>this.events.next(l)),tn(l=>{if(o.guardsResult=l.guardsResult,Uc(l.guardsResult))throw dM(this.urlSerializer,l.guardsResult);let d=new HE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),ur(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",tr.GuardRejected),!1)),FE(l=>{if(l.guards.canActivateChecks.length)return pe(l).pipe(tn(d=>{let h=new zE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),dr(d=>{let h=!1;return pe(d).pipe(zW(this.paramsInheritanceStrategy,this.environmentInjector),tn({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",tr.NoDataFromResolver)}}))}),tn(d=>{let h=new qE(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),FE(l=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(tn(_=>{h.component=_}),xe(()=>{})));for(let _ of h.children)p.push(...d(_));return p};return zu(d(l.targetSnapshot.root)).pipe(Is(null),qi(1))}),FE(()=>this.afterPreactivation()),dr(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return h?ft(h).pipe(xe(()=>o)):pe(o)}),xe(l=>{let d=ZG(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=Qe(q({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),tn(()=>{this.events.next(new Cd)}),oW(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),qi(1),tn({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new fi(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),_w(this.transitionAbortSubject.pipe(tn(l=>{throw l}))),qu(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",tr.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Es(l=>{if(c=!0,fM(l))this.events.next(new Os(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),nW(l)?this.events.next(new Td(l.url)):o.resolve(!1);else{this.events.next(new bd(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Zn}))}))}cancelNavigationTransition(r,i,s){let o=new Os(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function e9(n){return n!==vd}var t9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>X(n9),providedIn:"root"});let n=e;return n})(),cI=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},n9=(()=>{let e=class e extends cI{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wo(e)))(s||e)}})(),e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),IM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:()=>X(r9),providedIn:"root"});let n=e;return n})(),r9=(()=>{let e=class e extends IM{constructor(){super(...arguments),this.location=X(Pc),this.urlSerializer=X(Rd),this.options=X(Md,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=X(mI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ms,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=aM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Bc)this.stateMemento=this.createStateMemento();else if(r instanceof Fs)this.rawUrlTree=i.initialUrl;else if(r instanceof Zm){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Cd?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Os&&(r.code===tr.GuardRejected||r.code===tr.NoDataFromResolver)?this.restoreHistory(i):r instanceof bd?this.restoreHistory(i,!0):r instanceof fi&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=q(q({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=q(q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wo(e)))(s||e)}})(),e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),_d=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(_d||{});function bM(n,e){n.events.pipe(ur(t=>t instanceof fi||t instanceof Os||t instanceof bd||t instanceof Fs),xe(t=>t instanceof fi||t instanceof Fs?_d.COMPLETE:(t instanceof Os?t.code===tr.Redirect||t.code===tr.SupersededByNewNavigation:!1)?_d.REDIRECTING:_d.FAILED),ur(t=>t!==_d.REDIRECTING),qi(1)).subscribe(()=>{e()})}function i9(n){throw n}var s9={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},o9={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},it=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=X(Om),this.stateManager=X(IM),this.options=X(Md,{optional:!0})||{},this.pendingTasks=X(Pm),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=X(gI),this.urlSerializer=X(Rd),this.location=X(Pc),this.urlHandlingStrategy=X(mI),this._events=new ln,this.errorHandler=this.options.errorHandler||i9,this.navigated=!1,this.routeReuseStrategy=X(t9),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=X(og,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!X(cg,{optional:!0}),this.eventsSubscription=new $t,this.isNgZoneEnabled=X(nt)instanceof nt&&nt.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Os&&i.code!==tr.Redirect&&i.code!==tr.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof fi)this.navigated=!0;else if(i instanceof Td){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||e9(s.source)};this.scheduleNavigation(a,vd,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}c9(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),vd,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=q({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(hI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=q(q({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let _=s?s.snapshot:this.routerState.snapshot.root;p=rM(_)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),p=this.currentUrlTree.root}return iM(p,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Uc(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,vd,null,i)}navigate(r,i={skipLocationChange:!1}){return a9(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=q({},s9):i===!1?s=q({},o9):s=i,Uc(r))return U1(this.currentUrlTree,r,s);let o=this.parseUrl(r);return U1(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((p,_)=>{c=p,l=_});let h=this.pendingTasks.add();return bM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function a9(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new oe(4008,!1)}function c9(n){return!(n instanceof Cd)&&!(n instanceof Td)}var Hc=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new ln,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof fi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:IP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Z(it),Z(jr),F0("tabindex"),Z(Ji),Z(li),Z(Ur))},e.\u0275dir=dn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&j("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Mm("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Tn.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Qo],skipLocationChange:[Tn.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Qo],replaceUrl:[Tn.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Qo],routerLink:"routerLink"},standalone:!0,features:[eE,Go]});let n=e;return n})();var ag=class{};var l9=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(ur(r=>r instanceof fi),Mo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Nm(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ft(s).pipe(fc())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=pe(null);let o=s.pipe(kt(a=>a===null?pe(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ft([o,a]).pipe(fc())}else return o})}};e.\u0275fac=function(i){return new(i||e)(le(it),le(Um),le(Bn),le(ag),le(pI))},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),CM=new de(""),u9=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=X(Bn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Bc?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof fi?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Fs&&r.code===Xm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof eg&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>g(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),km(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new eg(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){MP()},e.\u0275prov=ce({token:e,factory:e.\u0275fac});let n=e;return n})();function d9(n){return n.routerState.root}function Od(n,e){return{\u0275kind:n,\u0275providers:e}}function h9(){let n=X(Fr);return e=>{let t=n.get(Nc);if(e!==t.components[0])return;let r=n.get(it),i=n.get(TM);n.get(_I)===1&&r.initialNavigation(),n.get(SM,null,Ce.Optional)?.setUpPreloading(),n.get(CM,null,Ce.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var TM=new de("",{factory:()=>new ln}),_I=new de("",{providedIn:"root",factory:()=>1});function f9(){return Od(2,[{provide:_I,useValue:0},{provide:Vm,multi:!0,deps:[Fr],useFactory:e=>{let t=e.get(b1,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(it),s=e.get(TM);bM(i,()=>{r(!0)}),e.get(gI).afterPreactivation=()=>(r(!0),s.closed?pe(void 0):s),i.initialNavigation()}))}}])}function p9(){return Od(3,[{provide:Vm,multi:!0,useFactory:()=>{let e=X(it);return()=>{e.setUpLocationChangeListener()}}},{provide:_I,useValue:2}])}var SM=new de("");function m9(n){return Od(0,[{provide:SM,useExisting:l9},{provide:ag,useExisting:n}])}function g9(){return Od(8,[H1,{provide:cg,useExisting:H1}])}function _9(n){let e=[{provide:wM,useValue:XW},{provide:EM,useValue:q({skipNextTransition:!!n?.skipInitialTransition},n)}];return Od(9,e)}var q1=new de("ROUTER_FORROOT_GUARD"),y9=[Pc,{provide:Rd,useClass:Ed},it,kd,{provide:jr,useFactory:d9,deps:[it]},pI,[]],yI=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[y9,[],{provide:og,multi:!0,useValue:r},{provide:q1,useFactory:I9,deps:[[it,new pm,new E0]]},{provide:Md,useValue:i||{}},i?.useHash?w9():E9(),v9(),i?.preloadingStrategy?m9(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?b9(i):[],i?.bindToComponentInputs?g9().\u0275providers:[],i?.enableViewTransitions?_9().\u0275providers:[],C9()]}}static forChild(r){return{ngModule:e,providers:[{provide:og,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(le(q1,8))},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({});let n=e;return n})();function v9(){return{provide:CM,useFactory:()=>{let n=X(D1),e=X(nt),t=X(Md),r=X(gI),i=X(Rd);return t.scrollOffset&&n.setOffset(t.scrollOffset),new u9(i,r,n,e,t)}}}function w9(){return{provide:Ur,useClass:$m}}function E9(){return{provide:Ur,useClass:IE}}function I9(n){return"guarded"}function b9(n){return[n.initialNavigation==="disabled"?p9().\u0275providers:[],n.initialNavigation==="enabledBlocking"?f9().\u0275providers:[]]}var G1=new de("");function C9(){return[{provide:G1,useFactory:h9},{provide:cE,multi:!0,useExisting:G1}]}var wI={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var z=function(n,e){if(!n)throw Xo(e)},Xo=function(n){return new Error("Firebase Database ("+wI.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var AM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},T9=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},dg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4,p=(a&15)<<2|l>>6,_=l&63;c||(_=64,o||(p=64)),r.push(t[d],t[h],t[p],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(AM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):T9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new EI;let p=s<<2|a>>4;if(r.push(p),l!==64){let _=a<<4&240|l>>2;if(r.push(_),h!==64){let E=l<<6&192|h;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},EI=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},bI=function(n){let e=AM(n);return dg.encodeByteArray(e,!0)},Fd=function(n){return bI(n).replace(/\./g,"")},Ld=function(n){try{return dg.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xM(n){return qc(void 0,n)}function qc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!S9(t)||(n[t]=qc(n[t],e[t]));return n}function S9(n){return n!=="__proto__"}function D9(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var A9=()=>D9().__FIREBASE_DEFAULTS__,x9=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},R9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ld(n[1]);return e&&JSON.parse(e)},CI=()=>{try{return A9()||x9()||R9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var TI=()=>{var n;return(n=CI())===null||n===void 0?void 0:n.config},RM=n=>{var e;return(e=CI())===null||e===void 0?void 0:e[`_${n}`]};var zt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Gc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Fd(JSON.stringify(t)),Fd(JSON.stringify(o)),""].join(".")}function Ze(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ze())}function hg(){var n;let e=(n=CI())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fg(){return typeof self=="object"&&self.self===self}function pg(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Zo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mg(){let n=Ze();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mi(){return wI.NODE_CLIENT===!0||wI.NODE_ADMIN===!0}function SI(){return!hg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vs(){try{return typeof indexedDB=="object"}catch{return!1}}function kM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var k9="FirebaseError",wt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=k9,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yr.prototype.create)}},yr=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?N9(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new wt(i,a,r)}};function N9(n,e){return n.replace(P9,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var P9=/\{\$([^}]+)}/g;function zc(n){return JSON.parse(n)}function Pt(n){return JSON.stringify(n)}var NM=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=zc(Ld(s[0])||""),t=zc(Ld(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var PM=function(n){let e=NM(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},MM=function(n){let e=NM(n).claims;return typeof e=="object"&&e.admin===!0};function Dn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Us(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Wc(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ud(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Bs(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(DM(s)&&DM(o)){if(!Bs(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function DM(n){return n!==null&&typeof n=="object"}function ts(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function js(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Kc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var ug=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)r[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){let p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,d;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),d=1518500249):(l=s^o^a,d=1859775393):h<60?(l=s&o|a&(s|o),d=2400959708):(l=s^o^a,d=3395469782);let p=(i<<5|i>>>27)+l+c+d+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function gg(n,e){let t=new II(n,e);return t.subscribe.bind(t)}var II=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");M9(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=vI),i.error===void 0&&(i.error=vI),i.complete===void 0&&(i.complete=vI);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function M9(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vI(){}var ue=function(n,e,t,r){let i;if(r<e?i="at least "+e:r>t&&(i=t===0?"none":"no more than "+t),i){let s=n+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function pn(n,e){return`${n} failed: ${e} argument `}function qt(n,e,t,r){if(!(r&&!t)&&typeof t!="function")throw new Error(pn(n,e)+"must be a valid function.")}function DI(n,e,t,r){if(!(r&&!t)&&(typeof t!="object"||t===null))throw new Error(pn(n,e)+"must be a valid context object.")}var OM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,z(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Bd=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var Zle=4*60*60*1e3;function K(n){return n&&n._delegate?n._delegate:n}var Ye=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ea="[DEFAULT]";var ta=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new zt;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(F9(e))try{this.getOrInitializeService({instanceIdentifier:ea})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ea){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=ea){return this.instances.has(e)}getOptions(e=ea){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:O9(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ea){return this.component?this.component.multipleInstances?e:ea:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function O9(n){return n===ea?void 0:n}function F9(n){return n.instantiationMode==="EAGER"}var $s=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ta(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var HI={};n3(HI,{FirebaseError:()=>wt,SDK_VERSION:()=>xn,_DEFAULT_ENTRY_NAME:()=>_i,_addComponent:()=>Jc,_addOrOverwriteComponent:()=>BI,_apps:()=>Hs,_clearComponents:()=>b6,_components:()=>Yc,_getProvider:()=>Xc,_isFirebaseApp:()=>YM,_isFirebaseServerApp:()=>pt,_registerComponent:()=>An,_removeServiceInstance:()=>QM,_serverApps:()=>Qc,deleteApp:()=>Eg,getApp:()=>$d,getApps:()=>S6,initializeApp:()=>wg,initializeServerApp:()=>T6,onLog:()=>jI,registerVersion:()=>Tt,setLogLevel:()=>$I});var AI=[],Ee=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Ee||{}),FM={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},L9=Ee.INFO,V9={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},U9=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=V9[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Wn=class{constructor(e){this.name=e,this._logLevel=L9,this._logHandler=U9,this._userLogHandler=null,AI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}};function LM(n){AI.forEach(e=>{e.setLogLevel(n)})}function VM(n,e){for(let t of AI){let r=null;e&&e.level&&(r=FM[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:Ee[s].toLowerCase(),message:a,args:o,type:i.name})}}}var B9=(n,e)=>e.some(t=>n instanceof t),UM,BM;function j9(){return UM||(UM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $9(){return BM||(BM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var jM=new WeakMap,RI=new WeakMap,$M=new WeakMap,xI=new WeakMap,NI=new WeakMap;function H9(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(gi(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&jM.set(t,n)}).catch(()=>{}),NI.set(e,n),e}function z9(n){if(RI.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});RI.set(n,e)}var kI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return RI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$M.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return gi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HM(n){kI=n(kI)}function q9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(_g(this),e,...t);return $M.set(r,e.sort?e.sort():[e]),gi(r)}:$9().includes(n)?function(...e){return n.apply(_g(this),e),gi(jM.get(this))}:function(...e){return gi(n.apply(_g(this),e))}}function G9(n){return typeof n=="function"?q9(n):(n instanceof IDBTransaction&&z9(n),B9(n,j9())?new Proxy(n,kI):n)}function gi(n){if(n instanceof IDBRequest)return H9(n);if(xI.has(n))return xI.get(n);let e=G9(n);return e!==n&&(xI.set(n,e),NI.set(e,n)),e}var _g=n=>NI.get(n);function qM(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=gi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(gi(o.result),c.oldVersion,c.newVersion,gi(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var W9=["get","getKey","getAll","getAllKeys","count"],K9=["put","add","delete","clear"],PI=new Map;function zM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(PI.get(e))return PI.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=K9.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||W9.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return PI.set(e,s),s}HM(n=>Qe(q({},n),{get:(e,t,r)=>zM(e,t)||n.get(e,t,r),has:(e,t)=>!!zM(e,t)||n.has(e,t)}));var OI=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Q9(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Q9(n){let e=n.getComponent();return e?.type==="VERSION"}var yg="@firebase/app",FI="0.10.5";var na=new Wn("@firebase/app"),Y9="@firebase/app-compat",J9="@firebase/analytics-compat",X9="@firebase/analytics",Z9="@firebase/app-check-compat",e6="@firebase/app-check",t6="@firebase/auth",n6="@firebase/auth-compat",r6="@firebase/database",i6="@firebase/database-compat",s6="@firebase/functions",o6="@firebase/functions-compat",a6="@firebase/installations",c6="@firebase/installations-compat",l6="@firebase/messaging",u6="@firebase/messaging-compat",d6="@firebase/performance",h6="@firebase/performance-compat",f6="@firebase/remote-config",p6="@firebase/remote-config-compat",m6="@firebase/storage",g6="@firebase/storage-compat",_6="@firebase/firestore",y6="@firebase/vertexai-preview",v6="@firebase/firestore-compat",w6="firebase",E6="10.12.2";var _i="[DEFAULT]",I6={[yg]:"fire-core",[Y9]:"fire-core-compat",[X9]:"fire-analytics",[J9]:"fire-analytics-compat",[e6]:"fire-app-check",[Z9]:"fire-app-check-compat",[t6]:"fire-auth",[n6]:"fire-auth-compat",[r6]:"fire-rtdb",[i6]:"fire-rtdb-compat",[s6]:"fire-fn",[o6]:"fire-fn-compat",[a6]:"fire-iid",[c6]:"fire-iid-compat",[l6]:"fire-fcm",[u6]:"fire-fcm-compat",[d6]:"fire-perf",[h6]:"fire-perf-compat",[f6]:"fire-rc",[p6]:"fire-rc-compat",[m6]:"fire-gcs",[g6]:"fire-gcs-compat",[_6]:"fire-fst",[v6]:"fire-fst-compat",[y6]:"fire-vertex","fire-js":"fire-js",[w6]:"fire-js-all"};var Hs=new Map,Qc=new Map,Yc=new Map;function Jc(n,e){try{n.container.addComponent(e)}catch(t){na.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function BI(n,e){n.container.addOrOverwriteComponent(e)}function An(n){let e=n.name;if(Yc.has(e))return na.debug(`There were multiple attempts to register component ${e}.`),!1;Yc.set(e,n);for(let t of Hs.values())Jc(t,n);for(let t of Qc.values())Jc(t,n);return!0}function Xc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function QM(n,e,t=_i){Xc(n,e).clearInstance(t)}function YM(n){return n.options!==void 0}function pt(n){return n.settings!==void 0}function b6(){Yc.clear()}var C6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vr=new yr("app","Firebase",C6);var vg=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ye("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}};var LI=class extends vg{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Tt(yg,FI,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Eg(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw vr.create("server-app-deleted")}};var xn=E6;function wg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:_i,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw vr.create("bad-app-name",{appName:String(i)});if(t||(t=TI()),!t)throw vr.create("no-options");let s=Hs.get(i);if(s){if(Bs(t,s.options)&&Bs(r,s.config))return s;throw vr.create("duplicate-app",{appName:i})}let o=new $s(i);for(let c of Yc.values())o.addComponent(c);let a=new vg(t,r,o);return Hs.set(i,a),a}function T6(n,e){if(fg())throw vr.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;YM(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,h)=>Math.imul(31,d)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw vr.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Qc.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new $s(s);for(let l of Yc.values())a.addComponent(l);let c=new LI(t,e,s,a);return Qc.set(s,c),c}function $d(n=_i){let e=Hs.get(n);if(!e&&n===_i&&TI())return wg();if(!e)throw vr.create("no-app",{appName:n});return e}function S6(){return Array.from(Hs.values())}function Eg(n){return g(this,null,function*(){let e=!1,t=n.name;Hs.has(t)?(e=!0,Hs.delete(t)):Qc.has(t)&&n.decRefCount()<=0&&(Qc.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function Tt(n,e,t){var r;let i=(r=I6[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),na.warn(a.join(" "));return}An(new Ye(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function jI(n,e){if(n!==null&&typeof n!="function")throw vr.create("invalid-log-argument");VM(n,e)}function $I(n){LM(n)}var D6="firebase-heartbeat-database",A6=1,jd="firebase-heartbeat-store",MI=null;function JM(){return MI||(MI=qM(D6,A6,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(jd)}catch(t){console.warn(t)}}}}).catch(n=>{throw vr.create("idb-open",{originalErrorMessage:n.message})})),MI}function x6(n){return g(this,null,function*(){try{let t=(yield JM()).transaction(jd),r=yield t.objectStore(jd).get(XM(n));return yield t.done,r}catch(e){if(e instanceof wt)na.warn(e.message);else{let t=vr.create("idb-get",{originalErrorMessage:e?.message});na.warn(t.message)}}})}function GM(n,e){return g(this,null,function*(){try{let r=(yield JM()).transaction(jd,"readwrite");yield r.objectStore(jd).put(e,XM(n)),yield r.done}catch(t){if(t instanceof wt)na.warn(t.message);else{let r=vr.create("idb-set",{originalErrorMessage:t?.message});na.warn(r.message)}}})}function XM(n){return`${n.name}!${n.options.appId}`}var R6=1024,k6=30*24*60*60*1e3,VI=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new UI(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return g(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=WM();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=k6}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return g(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=WM(),{heartbeatsToSend:r,unsentEntries:i}=N6(this._heartbeatsCache.heartbeats),s=Fd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function WM(){return new Date().toISOString().substring(0,10)}function N6(n,e=R6){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),KM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),KM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var UI=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return Vs()?kM().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield x6(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return GM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return GM(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function KM(n){return Fd(JSON.stringify({version:2,heartbeats:n})).length}function P6(n){An(new Ye("platform-logger",e=>new OI(e),"PRIVATE")),An(new Ye("heartbeat",e=>new VI(e),"PRIVATE")),Tt(yg,FI,n),Tt(yg,FI,"esm2017"),Tt("fire-js","")}P6("");var zI=class{constructor(e,t){this._delegate=e,this.firebase=t,Jc(e,new Ye("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Eg(this._delegate)))}_getService(e,t=_i){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=_i){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Jc(this._delegate,e)}_addOrOverwriteComponent(e){BI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var M6={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ZM=new yr("app-compat","Firebase",M6);function O6(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Tt,setLogLevel:$I,onLog:jI,apps:null,SDK_VERSION:xn,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:HI}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||_i,!Dn(e,l))throw ZM.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,d={}){let h=wg(l,d);if(Dn(e,h.name))return e[h.name];let p=new n(h,t);return e[h.name]=p,p}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let d=l.name,h=d.replace("-compat","");if(An(l)&&l.type==="PUBLIC"){let p=(_=i())=>{if(typeof _[h]!="function")throw ZM.create("invalid-app-argument",{appName:d});return _[h]()};l.serviceProps!==void 0&&qc(p,l.serviceProps),t[h]=p,n.prototype[h]=function(..._){return this._getService.bind(this,d).apply(this,l.multipleInstances?_:[])}}return l.type==="PUBLIC"?t[h]:null}function c(l,d){return d==="serverAuth"?null:d}return t}function tO(){let n=O6(zI);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:tO,extendNamespace:e,createSubscribe:gg,ErrorFactory:yr,deepExtend:qc});function e(t){qc(n,t)}return n}var F6=tO();var eO=new Wn("@firebase/app-compat"),L6="@firebase/app-compat",V6="0.2.35";function U6(n){Tt(L6,V6,n)}if(fg()&&self.firebase!==void 0){eO.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&eO.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var L=F6;U6();var ca={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var Ks={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function B6(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function _O(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Eb=B6,yO=_O,vO=new yr("auth","Firebase",_O());var Tg=new Wn("@firebase/auth");function j6(n,...e){Tg.logLevel<=Ee.WARN&&Tg.warn(`Auth (${xn}): ${n}`,...e)}function bg(n,...e){Tg.logLevel<=Ee.ERROR&&Tg.error(`Auth (${xn}): ${n}`,...e)}function Ft(n,...e){throw bb(n,...e)}function Ot(n,...e){return bb(n,...e)}function Ib(n,e,t){let r=Object.assign(Object.assign({},yO()),{[e]:t});return new yr("auth","Firebase",r).create(e,{appName:n.name})}function Qt(n){return Ib(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tl(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ft(n,"argument-error"),Ib(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function bb(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return vO.create(n,...e)}function $(n,e,...t){if(!n)throw bb(e,...t)}function yi(n){let e="INTERNAL ASSERTION FAILED: "+n;throw bg(e),new Error(e)}function wr(n,e){n||yi(e)}function Wd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Cb(){return nO()==="http:"||nO()==="https:"}function nO(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function $6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Cb()||pg()||"connection"in navigator)?navigator.onLine:!0}function H6(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var ra=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,wr(t>e,"Short delay should be less than long delay!"),this.isMobile=Vd()||Zo()}get(){return $6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Tb(n,e){wr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Kd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;yi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;yi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;yi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var z6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var q6=new ra(3e4,6e4);function Et(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function It(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){return wO(n,i,()=>g(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let h=ts(Object.assign({key:n.config.apiKey},d)).slice(1),p=yield n._getAdditionalHeaders();return p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode),Kd.fetch()(EO(n,n.config.apiHost,t,h),Object.assign({method:e,headers:p,referrerPolicy:"no-referrer"},l))}))})}function wO(n,e,t){return g(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},z6),e);try{let i=new QI(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Hd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Hd(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Hd(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Ib(n,d,l);Ft(n,d)}}catch(i){if(i instanceof wt)throw i;Ft(n,"network-request-failed",{message:String(i)})}})}function is(s,o,a,c){return g(this,arguments,function*(n,e,t,r,i={}){let l=yield It(n,e,t,r,i);return"mfaPendingCredential"in l&&Ft(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function EO(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Tb(n.config,i):`${n.config.apiScheme}://${i}`}function G6(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var QI=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ot(this.auth,"network-request-failed")),q6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Hd(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ot(n,e,r);return i.customData._tokenResponse=t,i}function rO(n){return n!==void 0&&n.getResponse!==void 0}function iO(n){return n!==void 0&&n.enterprise!==void 0}var YI=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return G6(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function W6(n){return g(this,null,function*(){return(yield It(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function K6(n,e){return g(this,null,function*(){return It(n,"GET","/v2/recaptchaConfig",Et(n,e))})}function Q6(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:delete",e)})}function Y6(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:update",e)})}function IO(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:lookup",e)})}function zd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function bO(n,e=!1){return g(this,null,function*(){let t=K(n),r=yield t.getIdToken(e),i=Fg(r);$(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:zd(qI(i.auth_time)),issuedAtTime:zd(qI(i.iat)),expirationTime:zd(qI(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function qI(n){return Number(n)*1e3}function Fg(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return bg("JWT malformed, contained fewer than 3 sections"),null;try{let i=Ld(t);return i?JSON.parse(i):(bg("Failed to decode base64 JWT payload"),null)}catch(i){return bg("Caught error parsing JWT payload as JSON",i?.toString()),null}}function sO(n){let e=Fg(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function rs(n,e,t=!1){return g(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof wt&&J6(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function J6({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var JI=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>g(this,null,function*(){yield this.iteration()}),t)}iteration(){return g(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Qd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zd(this.lastLoginAt),this.creationTime=zd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Yd(n){return g(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield rs(n,IO(t,{idToken:r}));$(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?TO(s.providerUserInfo):[],a=X6(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Qd(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,h)})}function CO(n){return g(this,null,function*(){let e=K(n);yield Yd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function X6(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function TO(n){return n.map(e=>{var{providerId:t}=e,r=fp(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Z6(n,e){return g(this,null,function*(){let t=yield wO(n,{},()=>g(this,null,function*(){let r=ts({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=EO(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Kd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function e8(n,e){return g(this,null,function*(){return It(n,"POST","/v2/accounts:revokeToken",Et(n,e))})}var qd=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=sO(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return g(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return g(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield Z6(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&($(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&($(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return yi("not implemented")}};function zs(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ia=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=fp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Qd(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return g(this,null,function*(){let t=yield rs(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return bO(this,e)}reload(){return CO(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return g(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Yd(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return g(this,null,function*(){if(pt(this.auth.app))return Promise.reject(Qt(this.auth));let e=yield this.getIdToken();return yield rs(this,Q6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,A=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,U=(l=t.createdAt)!==null&&l!==void 0?l:void 0,J=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:H,emailVerified:ee,isAnonymous:fe,providerData:re,stsTokenManager:S}=t;$(H&&S,e,"internal-error");let b=qd.fromJSON(this.name,S);$(typeof H=="string",e,"internal-error"),zs(h,e.name),zs(p,e.name),$(typeof ee=="boolean",e,"internal-error"),$(typeof fe=="boolean",e,"internal-error"),zs(_,e.name),zs(E,e.name),zs(A,e.name),zs(R,e.name),zs(U,e.name),zs(J,e.name);let C=new n({uid:H,auth:e,email:p,emailVerified:ee,displayName:h,isAnonymous:fe,photoURL:E,phoneNumber:_,tenantId:A,stsTokenManager:b,createdAt:U,lastLoginAt:J});return re&&Array.isArray(re)&&(C.providerData=re.map(D=>Object.assign({},D))),R&&(C._redirectEventId=R),C}static _fromIdTokenResponse(e,t,r=!1){return g(this,null,function*(){let i=new qd;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Yd(s),s})}static _fromGetAccountInfoResponse(e,t,r){return g(this,null,function*(){let i=t.users[0];$(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?TO(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new qd;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Qd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var oO=new Map;function mn(n){wr(n instanceof Function,"Expected a class definition");let e=oO.get(n);return e?(wr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,oO.set(n,e),e)}var t8=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return g(this,null,function*(){return!0})}_set(t,r){return g(this,null,function*(){this.storage[t]=r})}_get(t){return g(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return g(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Gs=t8;function vi(n,e,t){return`firebase:${n}:${e}:${t}`}var Sg=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=vi(this.userKey,i.apiKey,s),this.fullPersistenceKey=vi("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return g(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ia._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return g(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return g(this,null,function*(){if(!t.length)return new n(mn(Gs),e,r);let i=(yield Promise.all(t.map(l=>g(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||mn(Gs),o=vi(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let h=ia._fromJSON(e,d);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>g(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function aO(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(SO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xO(e))return"Blackberry";if(RO(e))return"Webos";if(Sb(e))return"Safari";if((e.includes("chrome/")||DO(e))&&!e.includes("edge/"))return"Chrome";if(nl(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function SO(n=Ze()){return/firefox\//i.test(n)}function Sb(n=Ze()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function DO(n=Ze()){return/crios\//i.test(n)}function AO(n=Ze()){return/iemobile/i.test(n)}function nl(n=Ze()){return/android/i.test(n)}function xO(n=Ze()){return/blackberry/i.test(n)}function RO(n=Ze()){return/webos/i.test(n)}function la(n=Ze()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function kO(n=Ze()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function n8(n=Ze()){var e;return la(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function r8(){return mg()&&document.documentMode===10}function NO(n=Ze()){return la(n)||nl(n)||RO(n)||xO(n)||/windows phone/i.test(n)||AO(n)}function i8(){try{return!!(window&&window!==window.top)}catch{return!1}}function Db(n,e=[]){let t;switch(n){case"Browser":t=aO(Ze());break;case"Worker":t=`${aO(Ze())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xn}/${r}`}var XI=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return g(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function s8(t){return g(this,arguments,function*(n,e={}){return It(n,"GET","/v2/passwordPolicy",Et(n,e))})}var o8=6,ZI=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:o8,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Dg=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ag(this),this.idTokenSubscription=new Ag(this),this.beforeStateQueue=new XI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mn(t)),this._initializationPromise=this.queue(()=>g(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Sg.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return g(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return g(this,null,function*(){try{let t=yield IO(this,{idToken:e}),r=yield ia._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return g(this,null,function*(){var t;if(pt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return g(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return g(this,null,function*(){try{yield Yd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=H6()}_delete(){return g(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return g(this,null,function*(){if(pt(this.app))return Promise.reject(Qt(this));let t=e?K(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return g(this,null,function*(){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>g(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return g(this,null,function*(){return pt(this.app)?Promise.reject(Qt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return pt(this.app)?Promise.reject(Qt(this)):this.queue(()=>g(this,null,function*(){yield this.assertedPersistence.setPersistence(mn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return g(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return g(this,null,function*(){let e=yield s8(this),t=new ZI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return g(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield e8(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return g(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return g(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&mn(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=yield Sg.create(this,[mn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return g(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>g(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return g(this,null,function*(){if(e===this.currentUser)return this.queue(()=>g(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if($(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return g(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Db(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return g(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return g(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&j6(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function ct(n){return K(n)}var Ag=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=gg(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var oh={loadJS(){return g(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function a8(n){oh=n}function Ab(n){return oh.loadJS(n)}function c8(){return oh.recaptchaV2Script}function l8(){return oh.recaptchaEnterpriseScript}function u8(){return oh.gapiScript}function PO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var d8="recaptcha-enterprise",h8="NO_RECAPTCHA",eb=class{constructor(e){this.type=d8,this.auth=ct(e)}verify(e="verify",t=!1){return g(this,null,function*(){function r(s){return g(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>g(this,null,function*(){K6(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new YI(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;iO(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(h8)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&iO(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=l8();c.length!==0&&(c+=a),Ab(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function cO(n,e,t,r=!1){return g(this,null,function*(){let i=new eb(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Jd(n,e,t,r){return g(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield cO(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>g(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield cO(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function f8(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(mn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function xb(n,e,t){let r=ct(n);$(r._canInitEmulator,r,"emulator-config-failed"),$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=MO(e),{host:o,port:a}=p8(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||m8()}function MO(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function p8(n){let e=MO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:lO(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:lO(o)}}}function lO(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function m8(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var wi=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return yi("not implemented")}_getIdTokenResponse(e){return yi("not implemented")}_linkToIdToken(e,t){return yi("not implemented")}_getReauthenticationResolver(e){return yi("not implemented")}};function OO(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:resetPassword",Et(n,e))})}function g8(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:update",e)})}function _8(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:signUp",e)})}function y8(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:update",Et(n,e))})}function v8(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signInWithPassword",Et(n,e))})}function Lg(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:sendOobCode",Et(n,e))})}function w8(n,e){return g(this,null,function*(){return Lg(n,e)})}function E8(n,e){return g(this,null,function*(){return Lg(n,e)})}function I8(n,e){return g(this,null,function*(){return Lg(n,e)})}function b8(n,e){return g(this,null,function*(){return Lg(n,e)})}function C8(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signInWithEmailLink",Et(n,e))})}function T8(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signInWithEmailLink",Et(n,e))})}var Xd=class n extends wi{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return g(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jd(e,t,"signInWithPassword",v8);case"emailLink":return C8(e,{email:this._email,oobCode:this._password});default:Ft(e,"internal-error")}})}_linkToIdToken(e,t){return g(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jd(e,r,"signUpPassword",_8);case"emailLink":return T8(e,{idToken:t,email:this._email,oobCode:this._password});default:Ft(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function ns(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signInWithIdp",Et(n,e))})}var S8="http://localhost",$r=class n extends wi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ft("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=fp(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return ns(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ns(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ns(e,t)}buildRequest(){let e={requestUri:S8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ts(t)}return e}};function D8(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:sendVerificationCode",Et(n,e))})}function A8(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signInWithPhoneNumber",Et(n,e))})}function x8(n,e){return g(this,null,function*(){let t=yield is(n,"POST","/v1/accounts:signInWithPhoneNumber",Et(n,e));if(t.temporaryProof)throw Hd(n,"account-exists-with-different-credential",t);return t})}var R8={USER_NOT_FOUND:"user-not-found"};function k8(n,e){return g(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return is(n,"POST","/v1/accounts:signInWithPhoneNumber",Et(n,t),R8)})}var Zc=class n extends wi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return A8(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return x8(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return k8(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function N8(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function P8(n){let e=js(Kc(n)).link,t=e?js(Kc(e)).deep_link_id:null,r=js(Kc(n)).deep_link_id;return(r?js(Kc(r)).link:null)||r||t||e||n}var Zd=class n{constructor(e){var t,r,i,s,o,a;let c=js(Kc(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=N8((i=c.mode)!==null&&i!==void 0?i:null);$(l&&d&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=P8(e);try{return new n(t)}catch{return null}}};var ah=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Xd._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Zd.parseLink(r);return $(i,"argument-error"),Xd._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Hr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ws=class extends Hr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},el=class n extends Ws{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return $("providerId"in t&&"signInMethod"in t,"argument-error"),$r._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return $(e.idToken||e.accessToken,"argument-error"),$r._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var Vg=(()=>{class n extends Ws{constructor(){super("facebook.com")}static credential(t){return $r._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),Ug=(()=>{class n extends Ws{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return $r._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),Bg=(()=>{class n extends Ws{constructor(){super("github.com")}static credential(t){return $r._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),M8="http://localhost",sa=class n extends wi{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return ns(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ns(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ns(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:M8,returnSecureToken:!0,pendingToken:this.pendingToken}}};var O8="saml.",eh=class n extends Hr{constructor(e){$(e.startsWith(O8),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=sa.fromJSON(e);return $(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return sa._create(r,t)}catch{return null}}};var jg=(()=>{class n extends Ws{constructor(){super("twitter.com")}static credential(t,r){return $r._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function FO(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signUp",Et(n,e))})}var zr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return g(this,null,function*(){let s=yield ia._fromIdTokenResponse(e,r,i),o=uO(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return g(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=uO(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function uO(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function Rb(n){return g(this,null,function*(){var e;if(pt(n.app))return Promise.reject(Qt(n));let t=ct(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new zr({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield FO(t,{returnSecureToken:!0}),i=yield zr._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var tb=class n extends wt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function LO(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?tb._fromErrorAndOperation(n,s,e,r):s})}function VO(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function kb(n,e){return g(this,null,function*(){let t=K(n);yield $g(!0,t,e);let{providerUserInfo:r}=yield Y6(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=VO(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function Nb(n,e,t=!1){return g(this,null,function*(){let r=yield rs(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return zr._forOperation(n,"link",r)})}function $g(n,e,t){return g(this,null,function*(){yield Yd(e);let r=VO(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";$(r.has(t)===n,e.auth,i)})}function UO(n,e,t=!1){return g(this,null,function*(){let{auth:r}=n;if(pt(r.app))return Promise.reject(Qt(r));let i="reauthenticate";try{let s=yield rs(n,LO(r,i,e,n),t);$(s.idToken,r,"internal-error");let o=Fg(s.idToken);$(o,r,"internal-error");let{sub:a}=o;return $(n.uid===a,r,"user-mismatch"),zr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ft(r,"user-mismatch"),s}})}function BO(n,e,t=!1){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let r="signIn",i=yield LO(n,r,e),s=yield zr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function rl(n,e){return g(this,null,function*(){return BO(ct(n),e)})}function Hg(n,e){return g(this,null,function*(){let t=K(n);return yield $g(!1,t,e.providerId),Nb(t,e)})}function zg(n,e){return g(this,null,function*(){return UO(K(n),e)})}function F8(n,e){return g(this,null,function*(){return is(n,"POST","/v1/accounts:signInWithCustomToken",Et(n,e))})}function Pb(n,e){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let t=ct(n),r=yield F8(t,{token:e,returnSecureToken:!0}),i=yield zr._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var oa=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?nb._fromServerResponse(e,t):"totpInfo"in t?rb._fromServerResponse(e,t):Ft(e,"internal-error")}},nb=class n extends oa{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},rb=class n extends oa{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function qg(n,e,t){var r;$(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),$(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&($(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&($(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function Mb(n){return g(this,null,function*(){let e=ct(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Ob(n,e,t){return g(this,null,function*(){let r=ct(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&qg(r,i,t),yield Jd(r,i,"getOobCode",E8)})}function Fb(n,e,t){return g(this,null,function*(){yield OO(K(n),{oobCode:e,newPassword:t}).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Mb(n),r}))})}function Lb(n,e){return g(this,null,function*(){yield y8(K(n),{oobCode:e})})}function Gg(n,e){return g(this,null,function*(){let t=K(n),r=yield OO(t,{oobCode:e}),i=r.requestType;switch($(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":$(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":$(r.mfaInfo,t,"internal-error");default:$(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=oa._fromServerResponse(ct(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function Vb(n,e){return g(this,null,function*(){let{data:t}=yield Gg(K(n),e);return t.email})}function Ub(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let r=ct(n),o=yield Jd(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",FO).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Mb(n),c}),a=yield zr._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function Bb(n,e,t){return pt(n.app)?Promise.reject(Qt(n)):rl(K(n),ah.credential(e,t)).catch(r=>g(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Mb(n),r}))}function jb(n,e,t){return g(this,null,function*(){let r=ct(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){$(a.handleCodeInApp,r,"argument-error"),a&&qg(r,o,a)}s(i,t),yield Jd(r,i,"getOobCode",I8)})}function $b(n,e){let t=Zd.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function Hb(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let r=K(n),i=ah.credentialWithLink(e,t||Wd());return $(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),rl(r,i)})}function L8(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:createAuthUri",Et(n,e))})}function zb(n,e){return g(this,null,function*(){let t=Cb()?Wd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield L8(K(n),r);return i||[]})}function qb(n,e){return g(this,null,function*(){let t=K(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&qg(t.auth,i,e);let{email:s}=yield w8(t.auth,i);s!==n.email&&(yield n.reload())})}function Gb(n,e,t){return g(this,null,function*(){let r=K(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&qg(r.auth,s,t);let{email:o}=yield b8(r.auth,s);o!==n.email&&(yield n.reload())})}function V8(n,e){return g(this,null,function*(){return It(n,"POST","/v1/accounts:update",e)})}function Wb(r,i){return g(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=K(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield rs(s,V8(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function Kb(n,e){let t=K(n);return pt(t.auth.app)?Promise.reject(Qt(t.auth)):jO(t,e,null)}function Qb(n,e){return jO(K(n),null,e)}function jO(n,e,t){return g(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield rs(n,g8(r,s));yield n._updateTokensIfNecessary(o,!0)})}function U8(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=Fg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new qs(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new ib(s,i);case"github.com":return new sb(s,i);case"google.com":return new ob(s,i);case"twitter.com":return new ab(s,i,n.screenName||null);case"custom":case"anonymous":return new qs(s,null);default:return new qs(s,r,i)}}var qs=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},xg=class extends qs{constructor(e,t,r,i){super(e,t,r),this.username=i}},ib=class extends qs{constructor(e,t){super(e,"facebook.com",t)}},sb=class extends xg{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},ob=class extends qs{constructor(e,t){super(e,"google.com",t)}},ab=class extends xg{constructor(e,t,r){super(e,"twitter.com",t,r)}};function Yb(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:U8(t)}var Rg=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var cb=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=ct(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>oa._fromServerResponse(r,a));$(i.mfaPendingCredential,r,"internal-error");let o=Rg._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>g(this,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let d=yield zr._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(d.user),d;case"reauthenticate":return $(t.user,r,"internal-error"),zr._forOperation(t.user,t.operationType,l);default:Ft(r,"internal-error")}}))}resolveSignIn(e){return g(this,null,function*(){let t=e;return this.signInResolver(t)})}};function Jb(n,e){var t;let r=K(n),i=e;return $(e.customData.operationType,r,"argument-error"),$((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),cb._fromError(r,i)}function B8(n,e){return It(n,"POST","/v2/accounts/mfaEnrollment:start",Et(n,e))}function j8(n,e){return It(n,"POST","/v2/accounts/mfaEnrollment:finalize",Et(n,e))}function $8(n,e){return It(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Et(n,e))}var lb=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>oa._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return g(this,null,function*(){return Rg._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return g(this,null,function*(){let r=e,i=yield this.getSession(),s=yield rs(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return g(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield rs(this.user,$8(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},GI=new WeakMap;function Xb(n){let e=K(n);return GI.has(e)||GI.set(e,lb._fromUser(e)),GI.get(e)}var kg="__sak";var Ng=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(kg,"1"),this.storage.removeItem(kg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function H8(){let n=Ze();return Sb(n)||la(n)}var z8=1e3,q8=10,G8=(()=>{class n extends Ng{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=H8()&&i8(),this.fallbackToPolling=NO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);r8()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,q8):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},z8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return g(this,null,function*(){yield Xr(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return g(this,null,function*(){let r=yield Xr(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return g(this,null,function*(){yield Xr(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),il=G8;var W8=(()=>{class n extends Ng{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Ei=W8;function K8(n){return Promise.all(n.map(e=>g(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Q8=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return g(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>g(this,null,function*(){return d(r.origin,o)})),l=yield K8(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function ua(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ub=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return g(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=ua("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let p=h;if(p.data.eventId===l)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Mt(){return window}function Y8(n){Mt().location.href=n}function Zb(){return typeof Mt().WorkerGlobalScope<"u"&&typeof Mt().importScripts=="function"}function J8(){return g(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function X8(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Z8(){return Zb()?self:null}var $O="firebaseLocalStorageDb",e7=1,Pg="firebaseLocalStorage",HO="fbase_key",aa=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Wg(n,e){return n.transaction([Pg],e?"readwrite":"readonly").objectStore(Pg)}function t7(){let n=indexedDB.deleteDatabase($O);return new aa(n).toPromise()}function db(){let n=indexedDB.open($O,e7);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Pg,{keyPath:HO})}catch(i){t(i)}}),n.addEventListener("success",()=>g(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Pg)?e(r):(r.close(),yield t7(),e(yield db()))}))})}function dO(n,e,t){return g(this,null,function*(){let r=Wg(n,!0).put({[HO]:e,value:t});return new aa(r).toPromise()})}function n7(n,e){return g(this,null,function*(){let t=Wg(n,!1).get(e),r=yield new aa(t).toPromise();return r===void 0?null:r.value})}function hO(n,e){let t=Wg(n,!0).delete(e);return new aa(t).toPromise()}var r7=800,i7=3,s7=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return g(this,null,function*(){return this.db?this.db:(this.db=yield db(),this.db)})}_withRetries(t){return g(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>i7)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return g(this,null,function*(){return Zb()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return g(this,null,function*(){this.receiver=Q8._getInstance(Z8()),this.receiver._subscribe("keyChanged",(t,r)=>g(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>g(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return g(this,null,function*(){var t,r;if(this.activeServiceWorker=yield J8(),!this.activeServiceWorker)return;this.sender=new ub(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return g(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||X8()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return g(this,null,function*(){try{if(!indexedDB)return!1;let t=yield db();return yield dO(t,kg,"1"),yield hO(t,kg),!0}catch{}return!1})}_withPendingWrite(t){return g(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(i=>dO(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return g(this,null,function*(){let r=yield this._withRetries(i=>n7(i,t));return this.localCache[t]=r,r})}_remove(t){return g(this,null,function*(){return this._withPendingWrite(()=>g(this,null,function*(){return yield this._withRetries(r=>hO(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return g(this,null,function*(){let t=yield this._withRetries(s=>{let o=Wg(s,!1).getAll();return new aa(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>g(this,null,function*(){return this._poll()}),r7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),da=s7;function o7(n,e){return It(n,"POST","/v2/accounts/mfaSignIn:start",Et(n,e))}function a7(n,e){return It(n,"POST","/v2/accounts/mfaSignIn:finalize",Et(n,e))}var c7=500,l7=6e4,Ig=1e12,hb=class{constructor(e){this.auth=e,this.counter=Ig,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new fb(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Ig;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Ig;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return g(this,null,function*(){var t;let r=e||Ig;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},fb=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;$(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=u7(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},l7)},c7))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function u7(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var WI=PO("rcb"),d7=new ra(3e4,6e4),pb=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Mt().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return $(h7(t),e,"argument-error"),this.shouldResolveImmediately(t)&&rO(Mt().grecaptcha)?Promise.resolve(Mt().grecaptcha):new Promise((r,i)=>{let s=Mt().setTimeout(()=>{i(Ot(e,"network-request-failed"))},d7.get());Mt()[WI]=()=>{Mt().clearTimeout(s),delete Mt()[WI];let a=Mt().grecaptcha;if(!a||!rO(a)){i(Ot(e,"internal-error"));return}let c=a.render;a.render=(l,d)=>{let h=c(l,d);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${c8()}?${ts({onload:WI,render:"explicit",hl:t})}`;Ab(o).catch(()=>{clearTimeout(s),i(Ot(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Mt().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function h7(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var mb=class{load(e){return g(this,null,function*(){return new hb(e)})}clearedOneInstance(){}};var zO="recaptcha",f7={theme:"light",type:"image"},th=class{constructor(e,t,r=Object.assign({},f7)){this.parameters=r,this.type=zO,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ct(e),this.isInvisible=this.parameters.size==="invisible",$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;$(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new mb:new pb,this.validateStartingState()}verify(){return g(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){$(!this.parameters.sitekey,this.auth,"argument-error"),$(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),$(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=Mt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){$(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return g(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return g(this,null,function*(){$(Cb()&&!Zb(),this.auth,"internal-error"),yield p7(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield W6(this.auth);$(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return $(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function p7(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var nh=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=Zc._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function eC(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let r=ct(n),i=yield Kg(r,e,K(t));return new nh(i,s=>rl(r,s))})}function tC(n,e,t){return g(this,null,function*(){let r=K(n);yield $g(!1,r,"phone");let i=yield Kg(r.auth,e,K(t));return new nh(i,s=>Hg(r,s))})}function nC(n,e,t){return g(this,null,function*(){let r=K(n);if(pt(r.auth.app))return Promise.reject(Qt(r.auth));let i=yield Kg(r.auth,e,K(t));return new nh(i,s=>zg(r,s))})}function Kg(n,e,t){return g(this,null,function*(){var r;let i=yield t.verify();try{$(typeof i=="string",n,"argument-error"),$(t.type===zO,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return $(o.type==="enroll",n,"internal-error"),(yield B8(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{$(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return $(a,n,"missing-multi-factor-info"),(yield o7(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=yield D8(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}})}function rC(n,e){return g(this,null,function*(){let t=K(n);if(pt(t.auth.app))return Promise.reject(Qt(t.auth));yield Nb(t,e)})}var ha=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=ct(t)}verifyPhoneNumber(t,r){return Kg(this.auth,t,K(r))}static credential(t,r){return Zc._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?Zc._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function fa(n,e){return e?mn(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var rh=class extends wi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ns(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ns(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ns(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function m7(n){return BO(n.auth,new rh(n),n.bypassAuthState)}function g7(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),UO(t,new rh(n),n.bypassAuthState)}function _7(n){return g(this,null,function*(){let{auth:e,user:t}=n;return $(t,e,"internal-error"),Nb(t,new rh(n),n.bypassAuthState)})}var Mg=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>g(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return g(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return m7;case"linkViaPopup":case"linkViaRedirect":return _7;case"reauthViaPopup":case"reauthViaRedirect":return g7;default:Ft(this.auth,"internal-error")}}resolve(e){wr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var y7=new ra(2e3,1e4);function iC(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Ot(n,"operation-not-supported-in-this-environment"));let r=ct(n);tl(n,e,Hr);let i=fa(r,t);return new aC(r,"signInViaPopup",e,i).executeNotNull()})}function sC(n,e,t){return g(this,null,function*(){let r=K(n);if(pt(r.auth.app))return Promise.reject(Ot(r.auth,"operation-not-supported-in-this-environment"));tl(r.auth,e,Hr);let i=fa(r.auth,t);return new aC(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function oC(n,e,t){return g(this,null,function*(){let r=K(n);tl(r.auth,e,Hr);let i=fa(r.auth,t);return new aC(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var aC=(()=>{class n extends Mg{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return g(this,null,function*(){let t=yield this.execute();return $(t,this.auth,"internal-error"),t})}onExecution(){return g(this,null,function*(){wr(this.filter.length===1,"Popup operations only handle one event");let t=ua();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ot(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Ot(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ot(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,y7.get())};t()}}n.currentPopupAction=null;return n})(),v7="pendingRedirect",Gd=new Map,gb=class n extends Mg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return g(this,null,function*(){let e=Gd.get(this.auth._key());if(!e){try{let r=(yield w7(this.resolver,this.auth))?yield Xr(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Gd.set(this.auth._key(),e)}return this.bypassAuthState||Gd.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return g(this,null,function*(){if(e.type==="signInViaRedirect")return Xr(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Xr(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return g(this,null,function*(){})}cleanUp(){}};function w7(n,e){return g(this,null,function*(){let t=WO(e),r=GO(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function cC(n,e){return g(this,null,function*(){return GO(n)._set(WO(e),"true")})}function qO(){Gd.clear()}function sl(n,e){Gd.set(n._key(),e)}function GO(n){return mn(n._redirectPersistence)}function WO(n){return vi(v7,n.config.apiKey,n.name)}function lC(n,e,t){return E7(n,e,t)}function E7(n,e,t){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let r=ct(n);tl(n,e,Hr),yield r._initializationPromise;let i=fa(r,t);return yield cC(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function uC(n,e,t){return I7(n,e,t)}function I7(n,e,t){return g(this,null,function*(){let r=K(n);if(tl(r.auth,e,Hr),pt(r.auth.app))return Promise.reject(Qt(r.auth));yield r.auth._initializationPromise;let i=fa(r.auth,t);yield cC(i,r.auth);let s=yield KO(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function dC(n,e,t){return b7(n,e,t)}function b7(n,e,t){return g(this,null,function*(){let r=K(n);tl(r.auth,e,Hr),yield r.auth._initializationPromise;let i=fa(r.auth,t);yield $g(!1,r,e.providerId),yield cC(i,r.auth);let s=yield KO(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function hC(n,e){return g(this,null,function*(){return yield ct(n)._initializationPromise,pa(n,e,!1)})}function pa(n,e,t=!1){return g(this,null,function*(){if(pt(n.app))return Promise.reject(Qt(n));let r=ct(n),i=fa(r,e),o=yield new gb(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function KO(n){return g(this,null,function*(){let e=ua(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var C7=10*60*1e3,ih=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!T7(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!QO(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ot(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C7&&this.cachedEventUids.clear(),this.cachedEventUids.has(fO(e))}saveEventToCache(e){this.cachedEventUids.add(fO(e)),this.lastProcessedEventTime=Date.now()}};function fO(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function QO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function T7(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return QO(n);default:return!1}}function fC(t){return g(this,arguments,function*(n,e={}){return It(n,"GET","/v1/projects",e)})}var S7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,D7=/^https?/;function A7(n){return g(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield fC(n);for(let t of e)try{if(x7(t))return}catch{}Ft(n,"unauthorized-domain")})}function x7(n){let e=Wd(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!D7.test(t))return!1;if(S7.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var R7=new ra(3e4,6e4);function pO(){let n=Mt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function k7(n){return new Promise((e,t)=>{var r,i,s;function o(){pO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pO(),t(Ot(n,"network-request-failed"))},timeout:R7.get()})}if(!((i=(r=Mt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Mt().gapi)===null||s===void 0)&&s.load)o();else{let a=PO("iframefcb");return Mt()[a]=()=>{gapi.load?o():t(Ot(n,"network-request-failed"))},Ab(`${u8()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Cg=null,e})}var Cg=null;function N7(n){return Cg=Cg||k7(n),Cg}var P7=new ra(5e3,15e3),M7="__/auth/iframe",O7="emulator/auth/iframe",F7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function V7(n){let e=n.config;$(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Tb(e,O7):`https://${n.config.authDomain}/${M7}`,r={apiKey:e.apiKey,appName:n.name,v:xn},i=L7.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${ts(r).slice(1)}`}function U7(n){return g(this,null,function*(){let e=yield N7(n),t=Mt().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:V7(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F7,dontclear:!0},r=>new Promise((i,s)=>g(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Ot(n,"network-request-failed"),a=Mt().setTimeout(()=>{s(o)},P7.get());function c(){Mt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var B7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},j7=500,$7=600,H7="_blank",z7="http://localhost",sh=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function q7(n,e,t,r=j7,i=$7){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},B7),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Ze().toLowerCase();t&&(a=DO(l)?H7:t),SO(l)&&(e=e||z7,c.scrollbars="yes");let d=Object.entries(c).reduce((p,[_,E])=>`${p}${_}=${E},`,"");if(n8(l)&&a!=="_self")return G7(e||"",a),new sh(null);let h=window.open(e||"",a,d);$(h,n,"popup-blocked");try{h.focus()}catch{}return new sh(h)}function G7(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var W7="__/auth/handler",K7="emulator/auth/handler",Q7=encodeURIComponent("fac");function Og(n,e,t,r,i,s){return g(this,null,function*(){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:xn,eventId:i};if(e instanceof Hr){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Wc(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,h]of Object.entries(s||{}))o[d]=h}if(e instanceof Ws){let d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${Q7}=${encodeURIComponent(c)}`:"";return`${Y7(n)}?${ts(a).slice(1)}${l}`})}function Y7({config:n}){return n.emulator?Tb(n,K7):`https://${n.authDomain}/${W7}`}var KI="webStorageSupport",_b=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ei,this._completeRedirectFn=pa,this._overrideRedirectResult=sl}_openPopup(e,t,r,i){return g(this,null,function*(){var s;wr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield Og(e,t,r,Wd(),i);return q7(e,o,ua())})}_openRedirect(e,t,r,i){return g(this,null,function*(){yield this._originValidation(e);let s=yield Og(e,t,r,Wd(),i);return Y8(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(wr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return g(this,null,function*(){let t=yield U7(e),r=new ih(e);return t.register("authEvent",i=>($(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(KI,{type:KI},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[KI];o!==void 0&&t(!!o),Ft(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=A7(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return NO()||Sb()||la()}},pC=_b,yb=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return yi("unexpected MultiFactorSessionType")}}},vb=class n extends yb{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return j8(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return a7(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},mC=(()=>{class n{constructor(){}static assertion(t){return vb._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var mO="@firebase/auth",gO="1.7.4";var wb=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return g(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function J7(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function X7(n){An(new Ye("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;$(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Db(n)},l=new Dg(r,i,s,c);return f8(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),An(new Ye("auth-internal",e=>{let t=ct(e.getProvider("auth").getImmediate());return(r=>new wb(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tt(mO,gO,J7(n)),Tt(mO,gO,"esm2017")}var Z7=5*60,Due=RM("authIdTokenMaxAge")||Z7;function eK(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}a8({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Ot("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",eK().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});X7("Browser");function ma(){return window}var tK=2e3;function nK(n,e,t){return g(this,null,function*(){var r;let{BuildInfo:i}=ma();wr(e.sessionId,"AuthEvent did not contain a session ID");let s=yield aK(e.sessionId),o={};return la()?o.ibi=i.packageName:nl()?o.apn=i.packageName:Ft(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Og(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function rK(n){return g(this,null,function*(){let{BuildInfo:e}=ma(),t={};la()?t.iosBundleId=e.packageName:nl()?t.androidPackageName=e.packageName:Ft(n,"operation-not-supported-in-this-environment"),yield fC(n,t)})}function iK(n){let{cordova:e}=ma();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,kO()?"_blank":"_system","location=yes"),t(i)})})}function sK(n,e,t){return g(this,null,function*(){let{cordova:r}=ma(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var h;s();let p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(Ot(n,"redirect-cancelled-by-user"))},tK))}function d(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),nl()&&document.addEventListener("visibilitychange",d,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function oK(n){var e,t,r,i,s,o,a,c,l,d;let h=ma();$(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),$(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),$(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),$(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),$(typeof((d=(l=h?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function aK(n){return g(this,null,function*(){let e=cK(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function cK(n){if(wr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var lK=20,gC=class extends ih{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return g(this,null,function*(){yield this.initPromise})}};function uK(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:fK(),postBody:null,tenantId:n.tenantId,error:Ot(n,"no-auth-event")}}function dK(n,e){return _C()._set(yC(n),e)}function YO(n){return g(this,null,function*(){let e=yield _C()._get(yC(n));return e&&(yield _C()._remove(yC(n))),e})}function hK(n,e){var t,r;let i=mK(e);if(i.includes("/__/auth/callback")){let s=Qg(i),o=s.firebaseError?pK(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?Ot(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function fK(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<lK;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function _C(){return mn(il)}function yC(n){return vi("authEvent",n.config.apiKey,n.name)}function pK(n){try{return JSON.parse(n)}catch{return null}}function mK(n){let e=Qg(n),t=e.link?decodeURIComponent(e.link):void 0,r=Qg(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Qg(i).link||i||r||t||n}function Qg(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return js(t.join("?"))}var gK=500,vC=class{constructor(){this._redirectPersistence=Ei,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=pa,this._overrideRedirectResult=sl}_initialize(e){return g(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new gC(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Ft(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return g(this,null,function*(){oK(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),qO(),yield this._originValidation(e);let o=uK(e,r,i);yield dK(e,o);let a=yield nK(e,o,t),c=yield iK(a);return sK(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rK(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=ma(),o=setTimeout(()=>g(this,null,function*(){yield YO(e),t.onEvent(JO())}),gK),a=d=>g(this,null,function*(){clearTimeout(o);let h=yield YO(e),p=null;h&&d?.url&&(p=hK(h,d.url)),t.onEvent(p||JO())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;ma().handleOpenURL=d=>g(this,null,function*(){if(d.toLowerCase().startsWith(l)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}})}},XO=vC;function JO(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ot("no-auth-event")}}function ZO(n,e){ct(n)._logFramework(e)}var yK="@firebase/auth-compat",vK="0.5.9";var wK=1e3;function uh(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function EK(){return uh()==="http:"||uh()==="https:"}function nF(n=Ze()){return!!((uh()==="file:"||uh()==="ionic:"||uh()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function IK(){return Zo()||hg()}function bK(){return mg()&&document?.documentMode===11}function CK(n=Ze()){return/Edge\/\d+/.test(n)}function TK(n=Ze()){return bK()||CK(n)}function rF(){try{let n=self.localStorage,e=ua();if(n)return n.setItem(e,"1"),n.removeItem(e),TK()?Vs():!0}catch{return TC()&&Vs()}return!1}function TC(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function wC(){return(EK()||pg()||nF())&&!IK()&&rF()&&!TC()}function iF(){return nF()&&typeof document<"u"}function SK(){return g(this,null,function*(){return iF()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},wK);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function DK(){return typeof window<"u"?window:null}var nr={LOCAL:"local",NONE:"none",SESSION:"session"},ch=$,sF="persistence";function AK(n,e){if(ch(Object.values(nr).includes(e),n,"invalid-persistence-type"),Zo()){ch(e!==nr.SESSION,n,"unsupported-persistence-type");return}if(hg()){ch(e===nr.NONE,n,"unsupported-persistence-type");return}if(TC()){ch(e===nr.NONE||e===nr.LOCAL&&Vs(),n,"unsupported-persistence-type");return}ch(e===nr.NONE||rF(),n,"unsupported-persistence-type")}function EC(n){return g(this,null,function*(){yield n._initializationPromise;let e=oF(),t=vi(sF,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())})}function xK(n,e){let t=oF();if(!t)return[];let r=vi(sF,n,e);switch(t.getItem(r)){case nr.NONE:return[Gs];case nr.LOCAL:return[da,Ei];case nr.SESSION:return[Ei];default:return[]}}function oF(){var n;try{return((n=DK())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var RK=$,Ii=class{constructor(){this.browserResolver=mn(pC),this.cordovaResolver=mn(XO),this.underlyingResolver=null,this._redirectPersistence=Ei,this._completeRedirectFn=pa,this._overrideRedirectResult=sl}_initialize(e){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return g(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return iF()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return RK(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return g(this,null,function*(){if(this.underlyingResolver)return;let e=yield SK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function aF(n){return n.unwrap()}function kK(n){return n.wrapped()}function NK(n){return cF(n)}function PK(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new bC(n,Jb(n,e))}else if(r){let i=cF(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function cF(n){let{_tokenResponse:e}=n instanceof wt?n.customData:n;if(!e)return null;if(!(n instanceof wt)&&"temporaryProof"in e&&"phoneNumber"in e)return ha.credentialFromResult(n);let t=e.providerId;if(!t||t===ca.PASSWORD)return null;let r;switch(t){case ca.GOOGLE:r=Ug;break;case ca.FACEBOOK:r=Vg;break;case ca.GITHUB:r=Bg;break;case ca.TWITTER:r=jg;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?sa._create(t,a):$r._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new el(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof wt?r.credentialFromError(n):r.credentialFromResult(n)}function Kn(n,e){return e.catch(t=>{throw t instanceof wt&&PK(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:NK(t),additionalUserInfo:Yb(t),user:ol.getOrCreate(i)}})}function IC(n,e){return g(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>Kn(n,t.confirm(r))}})}var bC=class{constructor(e,t){this.resolver=t,this.auth=kK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Kn(aF(this.auth),this.resolver.resolveSignIn(e))}};var ol=class n{constructor(e){this._delegate=e,this.multiFactor=Xb(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return g(this,null,function*(){return Kn(this.auth,Hg(this._delegate,e))})}linkWithPhoneNumber(e,t){return g(this,null,function*(){return IC(this.auth,tC(this._delegate,e,t))})}linkWithPopup(e){return g(this,null,function*(){return Kn(this.auth,oC(this._delegate,e,Ii))})}linkWithRedirect(e){return g(this,null,function*(){return yield EC(ct(this.auth)),dC(this._delegate,e,Ii)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return g(this,null,function*(){return Kn(this.auth,zg(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return IC(this.auth,nC(this._delegate,e,t))}reauthenticateWithPopup(e){return Kn(this.auth,sC(this._delegate,e,Ii))}reauthenticateWithRedirect(e){return g(this,null,function*(){return yield EC(ct(this.auth)),uC(this._delegate,e,Ii)})}sendEmailVerification(e){return qb(this._delegate,e)}unlink(e){return g(this,null,function*(){return yield kb(this._delegate,e),this})}updateEmail(e){return Kb(this._delegate,e)}updatePassword(e){return Qb(this._delegate,e)}updatePhoneNumber(e){return rC(this._delegate,e)}updateProfile(e){return Wb(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Gb(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};ol.USER_MAP=new WeakMap;var lh=$,eF=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;lh(i,"invalid-api-key",{appName:t.name}),lh(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?Ii:void 0;this._delegate=r.initialize({options:{persistence:MK(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(Eb),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ol.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){xb(this._delegate,t,r)}applyActionCode(t){return Lb(this._delegate,t)}checkActionCode(t){return Gg(this._delegate,t)}confirmPasswordReset(t,r){return Fb(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return g(this,null,function*(){return Kn(this._delegate,Ub(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return zb(this._delegate,t)}isSignInWithEmailLink(t){return $b(this._delegate,t)}getRedirectResult(){return g(this,null,function*(){lh(wC(),this._delegate,"operation-not-supported-in-this-environment");let t=yield hC(this._delegate,Ii);return t?Kn(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){ZO(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=tF(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=tF(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return jb(this._delegate,t,r)}sendPasswordResetEmail(t,r){return Ob(this._delegate,t,r||void 0)}setPersistence(t){return g(this,null,function*(){AK(this._delegate,t);let r;switch(t){case nr.SESSION:r=Ei;break;case nr.LOCAL:r=(yield mn(da)._isAvailable())?da:il;break;case nr.NONE:r=Gs;break;default:return Ft("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return Kn(this._delegate,Rb(this._delegate))}signInWithCredential(t){return Kn(this._delegate,rl(this._delegate,t))}signInWithCustomToken(t){return Kn(this._delegate,Pb(this._delegate,t))}signInWithEmailAndPassword(t,r){return Kn(this._delegate,Bb(this._delegate,t,r))}signInWithEmailLink(t,r){return Kn(this._delegate,Hb(this._delegate,t,r))}signInWithPhoneNumber(t,r){return IC(this._delegate,eC(this._delegate,t,r))}signInWithPopup(t){return g(this,null,function*(){return lh(wC(),this._delegate,"operation-not-supported-in-this-environment"),Kn(this._delegate,iC(this._delegate,t,Ii))})}signInWithRedirect(t){return g(this,null,function*(){return lh(wC(),this._delegate,"operation-not-supported-in-this-environment"),yield EC(this._delegate),lC(this._delegate,t,Ii)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return Vb(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=nr,n})();function tF(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&ol.getOrCreate(o)),error:e,complete:t}}function MK(n,e){let t=xK(n,e);if(typeof self<"u"&&!t.includes(da)&&t.push(da),typeof window<"u")for(let r of[il,Ei])t.includes(r)||t.push(r);return t.includes(Gs)||t.push(Gs),t}var dh=class{constructor(){this.providerId="phone",this._delegate=new ha(aF(L.auth()))}static credential(e,t){return ha.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};dh.PHONE_SIGN_IN_METHOD=ha.PHONE_SIGN_IN_METHOD;dh.PROVIDER_ID=ha.PROVIDER_ID;var OK=$,CC=class{constructor(e,t,r=L.app()){var i;OK((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new th(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var FK="auth-compat";function LK(n){n.INTERNAL.registerComponent(new Ye(FK,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new eF(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ks.EMAIL_SIGNIN,PASSWORD_RESET:Ks.PASSWORD_RESET,RECOVER_EMAIL:Ks.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ks.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ks.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ks.VERIFY_EMAIL}},EmailAuthProvider:ah,FacebookAuthProvider:Vg,GithubAuthProvider:Bg,GoogleAuthProvider:Ug,OAuthProvider:el,SAMLAuthProvider:eh,PhoneAuthProvider:dh,PhoneMultiFactorGenerator:mC,RecaptchaVerifier:CC,TwitterAuthProvider:jg,Auth:eF,AuthCredential:wi,Error:wt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(yK,vK)}LK(L);var lF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uF={};var Qs,SC;(function(){var n;function e(S,b){function C(){}C.prototype=b.prototype,S.D=b.prototype,S.prototype=new C,S.prototype.constructor=S,S.C=function(D,x,N){for(var T=Array(arguments.length-2),ji=2;ji<arguments.length;ji++)T[ji-2]=arguments[ji];return b.prototype[x].apply(D,T)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,b,C){C||(C=0);var D=Array(16);if(typeof b=="string")for(var x=0;16>x;++x)D[x]=b.charCodeAt(C++)|b.charCodeAt(C++)<<8|b.charCodeAt(C++)<<16|b.charCodeAt(C++)<<24;else for(x=0;16>x;++x)D[x]=b[C++]|b[C++]<<8|b[C++]<<16|b[C++]<<24;b=S.g[0],C=S.g[1],x=S.g[2];var N=S.g[3],T=b+(N^C&(x^N))+D[0]+3614090360&4294967295;b=C+(T<<7&4294967295|T>>>25),T=N+(x^b&(C^x))+D[1]+3905402710&4294967295,N=b+(T<<12&4294967295|T>>>20),T=x+(C^N&(b^C))+D[2]+606105819&4294967295,x=N+(T<<17&4294967295|T>>>15),T=C+(b^x&(N^b))+D[3]+3250441966&4294967295,C=x+(T<<22&4294967295|T>>>10),T=b+(N^C&(x^N))+D[4]+4118548399&4294967295,b=C+(T<<7&4294967295|T>>>25),T=N+(x^b&(C^x))+D[5]+1200080426&4294967295,N=b+(T<<12&4294967295|T>>>20),T=x+(C^N&(b^C))+D[6]+2821735955&4294967295,x=N+(T<<17&4294967295|T>>>15),T=C+(b^x&(N^b))+D[7]+4249261313&4294967295,C=x+(T<<22&4294967295|T>>>10),T=b+(N^C&(x^N))+D[8]+1770035416&4294967295,b=C+(T<<7&4294967295|T>>>25),T=N+(x^b&(C^x))+D[9]+2336552879&4294967295,N=b+(T<<12&4294967295|T>>>20),T=x+(C^N&(b^C))+D[10]+4294925233&4294967295,x=N+(T<<17&4294967295|T>>>15),T=C+(b^x&(N^b))+D[11]+2304563134&4294967295,C=x+(T<<22&4294967295|T>>>10),T=b+(N^C&(x^N))+D[12]+1804603682&4294967295,b=C+(T<<7&4294967295|T>>>25),T=N+(x^b&(C^x))+D[13]+4254626195&4294967295,N=b+(T<<12&4294967295|T>>>20),T=x+(C^N&(b^C))+D[14]+2792965006&4294967295,x=N+(T<<17&4294967295|T>>>15),T=C+(b^x&(N^b))+D[15]+1236535329&4294967295,C=x+(T<<22&4294967295|T>>>10),T=b+(x^N&(C^x))+D[1]+4129170786&4294967295,b=C+(T<<5&4294967295|T>>>27),T=N+(C^x&(b^C))+D[6]+3225465664&4294967295,N=b+(T<<9&4294967295|T>>>23),T=x+(b^C&(N^b))+D[11]+643717713&4294967295,x=N+(T<<14&4294967295|T>>>18),T=C+(N^b&(x^N))+D[0]+3921069994&4294967295,C=x+(T<<20&4294967295|T>>>12),T=b+(x^N&(C^x))+D[5]+3593408605&4294967295,b=C+(T<<5&4294967295|T>>>27),T=N+(C^x&(b^C))+D[10]+38016083&4294967295,N=b+(T<<9&4294967295|T>>>23),T=x+(b^C&(N^b))+D[15]+3634488961&4294967295,x=N+(T<<14&4294967295|T>>>18),T=C+(N^b&(x^N))+D[4]+3889429448&4294967295,C=x+(T<<20&4294967295|T>>>12),T=b+(x^N&(C^x))+D[9]+568446438&4294967295,b=C+(T<<5&4294967295|T>>>27),T=N+(C^x&(b^C))+D[14]+3275163606&4294967295,N=b+(T<<9&4294967295|T>>>23),T=x+(b^C&(N^b))+D[3]+4107603335&4294967295,x=N+(T<<14&4294967295|T>>>18),T=C+(N^b&(x^N))+D[8]+1163531501&4294967295,C=x+(T<<20&4294967295|T>>>12),T=b+(x^N&(C^x))+D[13]+2850285829&4294967295,b=C+(T<<5&4294967295|T>>>27),T=N+(C^x&(b^C))+D[2]+4243563512&4294967295,N=b+(T<<9&4294967295|T>>>23),T=x+(b^C&(N^b))+D[7]+1735328473&4294967295,x=N+(T<<14&4294967295|T>>>18),T=C+(N^b&(x^N))+D[12]+2368359562&4294967295,C=x+(T<<20&4294967295|T>>>12),T=b+(C^x^N)+D[5]+4294588738&4294967295,b=C+(T<<4&4294967295|T>>>28),T=N+(b^C^x)+D[8]+2272392833&4294967295,N=b+(T<<11&4294967295|T>>>21),T=x+(N^b^C)+D[11]+1839030562&4294967295,x=N+(T<<16&4294967295|T>>>16),T=C+(x^N^b)+D[14]+4259657740&4294967295,C=x+(T<<23&4294967295|T>>>9),T=b+(C^x^N)+D[1]+2763975236&4294967295,b=C+(T<<4&4294967295|T>>>28),T=N+(b^C^x)+D[4]+1272893353&4294967295,N=b+(T<<11&4294967295|T>>>21),T=x+(N^b^C)+D[7]+4139469664&4294967295,x=N+(T<<16&4294967295|T>>>16),T=C+(x^N^b)+D[10]+3200236656&4294967295,C=x+(T<<23&4294967295|T>>>9),T=b+(C^x^N)+D[13]+681279174&4294967295,b=C+(T<<4&4294967295|T>>>28),T=N+(b^C^x)+D[0]+3936430074&4294967295,N=b+(T<<11&4294967295|T>>>21),T=x+(N^b^C)+D[3]+3572445317&4294967295,x=N+(T<<16&4294967295|T>>>16),T=C+(x^N^b)+D[6]+76029189&4294967295,C=x+(T<<23&4294967295|T>>>9),T=b+(C^x^N)+D[9]+3654602809&4294967295,b=C+(T<<4&4294967295|T>>>28),T=N+(b^C^x)+D[12]+3873151461&4294967295,N=b+(T<<11&4294967295|T>>>21),T=x+(N^b^C)+D[15]+530742520&4294967295,x=N+(T<<16&4294967295|T>>>16),T=C+(x^N^b)+D[2]+3299628645&4294967295,C=x+(T<<23&4294967295|T>>>9),T=b+(x^(C|~N))+D[0]+4096336452&4294967295,b=C+(T<<6&4294967295|T>>>26),T=N+(C^(b|~x))+D[7]+1126891415&4294967295,N=b+(T<<10&4294967295|T>>>22),T=x+(b^(N|~C))+D[14]+2878612391&4294967295,x=N+(T<<15&4294967295|T>>>17),T=C+(N^(x|~b))+D[5]+4237533241&4294967295,C=x+(T<<21&4294967295|T>>>11),T=b+(x^(C|~N))+D[12]+1700485571&4294967295,b=C+(T<<6&4294967295|T>>>26),T=N+(C^(b|~x))+D[3]+2399980690&4294967295,N=b+(T<<10&4294967295|T>>>22),T=x+(b^(N|~C))+D[10]+4293915773&4294967295,x=N+(T<<15&4294967295|T>>>17),T=C+(N^(x|~b))+D[1]+2240044497&4294967295,C=x+(T<<21&4294967295|T>>>11),T=b+(x^(C|~N))+D[8]+1873313359&4294967295,b=C+(T<<6&4294967295|T>>>26),T=N+(C^(b|~x))+D[15]+4264355552&4294967295,N=b+(T<<10&4294967295|T>>>22),T=x+(b^(N|~C))+D[6]+2734768916&4294967295,x=N+(T<<15&4294967295|T>>>17),T=C+(N^(x|~b))+D[13]+1309151649&4294967295,C=x+(T<<21&4294967295|T>>>11),T=b+(x^(C|~N))+D[4]+4149444226&4294967295,b=C+(T<<6&4294967295|T>>>26),T=N+(C^(b|~x))+D[11]+3174756917&4294967295,N=b+(T<<10&4294967295|T>>>22),T=x+(b^(N|~C))+D[2]+718787259&4294967295,x=N+(T<<15&4294967295|T>>>17),T=C+(N^(x|~b))+D[9]+3951481745&4294967295,S.g[0]=S.g[0]+b&4294967295,S.g[1]=S.g[1]+(x+(T<<21&4294967295|T>>>11))&4294967295,S.g[2]=S.g[2]+x&4294967295,S.g[3]=S.g[3]+N&4294967295}r.prototype.u=function(S,b){b===void 0&&(b=S.length);for(var C=b-this.blockSize,D=this.B,x=this.h,N=0;N<b;){if(x==0)for(;N<=C;)i(this,S,N),N+=this.blockSize;if(typeof S=="string"){for(;N<b;)if(D[x++]=S.charCodeAt(N++),x==this.blockSize){i(this,D),x=0;break}}else for(;N<b;)if(D[x++]=S[N++],x==this.blockSize){i(this,D),x=0;break}}this.h=x,this.o+=b},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var b=1;b<S.length-8;++b)S[b]=0;var C=8*this.o;for(b=S.length-8;b<S.length;++b)S[b]=C&255,C/=256;for(this.u(S),S=Array(16),b=C=0;4>b;++b)for(var D=0;32>D;D+=8)S[C++]=this.g[b]>>>D&255;return S};function s(S,b){var C=a;return Object.prototype.hasOwnProperty.call(C,S)?C[S]:C[S]=b(S)}function o(S,b){this.h=b;for(var C=[],D=!0,x=S.length-1;0<=x;x--){var N=S[x]|0;D&&N==b||(C[x]=N,D=!1)}this.g=C}var a={};function c(S){return-128<=S&&128>S?s(S,function(b){return new o([b|0],0>b?-1:0)}):new o([S|0],0>S?-1:0)}function l(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return R(l(-S));for(var b=[],C=1,D=0;S>=C;D++)b[D]=S/C|0,C*=4294967296;return new o(b,0)}function d(S,b){if(S.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(S.charAt(0)=="-")return R(d(S.substring(1),b));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=l(Math.pow(b,8)),D=h,x=0;x<S.length;x+=8){var N=Math.min(8,S.length-x),T=parseInt(S.substring(x,x+N),b);8>N?(N=l(Math.pow(b,N)),D=D.j(N).add(l(T))):(D=D.j(C),D=D.add(l(T)))}return D}var h=c(0),p=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(A(this))return-R(this).m();for(var S=0,b=1,C=0;C<this.g.length;C++){var D=this.i(C);S+=(0<=D?D:4294967296+D)*b,b*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(A(this))return"-"+R(this).toString(S);for(var b=l(Math.pow(S,6)),C=this,D="";;){var x=ee(C,b).g;C=U(C,x.j(b));var N=((0<C.g.length?C.g[0]:C.h)>>>0).toString(S);if(C=x,E(C))return N+D;for(;6>N.length;)N="0"+N;D=N+D}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(var b=0;b<S.g.length;b++)if(S.g[b]!=0)return!1;return!0}function A(S){return S.h==-1}n.l=function(S){return S=U(this,S),A(S)?-1:E(S)?0:1};function R(S){for(var b=S.g.length,C=[],D=0;D<b;D++)C[D]=~S.g[D];return new o(C,~S.h).add(p)}n.abs=function(){return A(this)?R(this):this},n.add=function(S){for(var b=Math.max(this.g.length,S.g.length),C=[],D=0,x=0;x<=b;x++){var N=D+(this.i(x)&65535)+(S.i(x)&65535),T=(N>>>16)+(this.i(x)>>>16)+(S.i(x)>>>16);D=T>>>16,N&=65535,T&=65535,C[x]=T<<16|N}return new o(C,C[C.length-1]&-2147483648?-1:0)};function U(S,b){return S.add(R(b))}n.j=function(S){if(E(this)||E(S))return h;if(A(this))return A(S)?R(this).j(R(S)):R(R(this).j(S));if(A(S))return R(this.j(R(S)));if(0>this.l(_)&&0>S.l(_))return l(this.m()*S.m());for(var b=this.g.length+S.g.length,C=[],D=0;D<2*b;D++)C[D]=0;for(D=0;D<this.g.length;D++)for(var x=0;x<S.g.length;x++){var N=this.i(D)>>>16,T=this.i(D)&65535,ji=S.i(x)>>>16,bu=S.i(x)&65535;C[2*D+2*x]+=T*bu,J(C,2*D+2*x),C[2*D+2*x+1]+=N*bu,J(C,2*D+2*x+1),C[2*D+2*x+1]+=T*ji,J(C,2*D+2*x+1),C[2*D+2*x+2]+=N*ji,J(C,2*D+2*x+2)}for(D=0;D<b;D++)C[D]=C[2*D+1]<<16|C[2*D];for(D=b;D<2*b;D++)C[D]=0;return new o(C,0)};function J(S,b){for(;(S[b]&65535)!=S[b];)S[b+1]+=S[b]>>>16,S[b]&=65535,b++}function H(S,b){this.g=S,this.h=b}function ee(S,b){if(E(b))throw Error("division by zero");if(E(S))return new H(h,h);if(A(S))return b=ee(R(S),b),new H(R(b.g),R(b.h));if(A(b))return b=ee(S,R(b)),new H(R(b.g),b.h);if(30<S.g.length){if(A(S)||A(b))throw Error("slowDivide_ only works with positive integers.");for(var C=p,D=b;0>=D.l(S);)C=fe(C),D=fe(D);var x=re(C,1),N=re(D,1);for(D=re(D,2),C=re(C,2);!E(D);){var T=N.add(D);0>=T.l(S)&&(x=x.add(C),N=T),D=re(D,1),C=re(C,1)}return b=U(S,x.j(b)),new H(x,b)}for(x=h;0<=S.l(b);){for(C=Math.max(1,Math.floor(S.m()/b.m())),D=Math.ceil(Math.log(C)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),N=l(C),T=N.j(b);A(T)||0<T.l(S);)C-=D,N=l(C),T=N.j(b);E(N)&&(N=p),x=x.add(N),S=U(S,T)}return new H(x,S)}n.A=function(S){return ee(this,S).h},n.and=function(S){for(var b=Math.max(this.g.length,S.g.length),C=[],D=0;D<b;D++)C[D]=this.i(D)&S.i(D);return new o(C,this.h&S.h)},n.or=function(S){for(var b=Math.max(this.g.length,S.g.length),C=[],D=0;D<b;D++)C[D]=this.i(D)|S.i(D);return new o(C,this.h|S.h)},n.xor=function(S){for(var b=Math.max(this.g.length,S.g.length),C=[],D=0;D<b;D++)C[D]=this.i(D)^S.i(D);return new o(C,this.h^S.h)};function fe(S){for(var b=S.g.length+1,C=[],D=0;D<b;D++)C[D]=S.i(D)<<1|S.i(D-1)>>>31;return new o(C,S.h)}function re(S,b){var C=b>>5;b%=32;for(var D=S.g.length-C,x=[],N=0;N<D;N++)x[N]=0<b?S.i(N+C)>>>b|S.i(N+C+1)<<32-b:S.i(N+C);return new o(x,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,SC=uF.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,Qs=uF.Integer=o}).apply(typeof lF<"u"?lF:typeof self<"u"?self:typeof window<"u"?window:{});var Yg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ss={};var DC,AC,al,xC,hh,Jg,RC,kC,NC;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yg=="object"&&Yg];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(u,f){if(f)e:{var m=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var k=u[y];if(!(k in m))break e;m=m[k]}u=u[u.length-1],y=m[u],f=f(y),f!=y&&f!=null&&e(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,y=!1,k={next:function(){if(!y&&m<u.length){var M=m++;return{value:f(M,u[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}i("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function d(u,f,m){return u.call.apply(u.bind,arguments)}function h(u,f,m){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,y),u.apply(f,k)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function _(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function E(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(y,k,M){for(var W=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)W[Je-2]=arguments[Je];return f.prototype[k].apply(y,W)}}function A(u){let f=u.length;if(0<f){let m=Array(f);for(let y=0;y<f;y++)m[y]=u[y];return m}return[]}function R(u,f){for(let m=1;m<arguments.length;m++){let y=arguments[m];if(c(y)){let k=u.length||0,M=y.length||0;u.length=k+M;for(let W=0;W<M;W++)u[k+W]=y[W]}else u.push(y)}}class U{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function J(u){return/^[\s\xa0]*$/.test(u)}function H(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function ee(u){return ee[" "](u),u}ee[" "]=function(){};var fe=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function re(u,f,m){for(let y in u)f.call(m,u[y],y,u)}function S(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function b(u){let f={};for(let m in u)f[m]=u[m];return f}let C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(u,f){let m,y;for(let k=1;k<arguments.length;k++){y=arguments[k];for(m in y)u[m]=y[m];for(let M=0;M<C.length;M++)m=C[M],Object.prototype.hasOwnProperty.call(y,m)&&(u[m]=y[m])}}function x(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function N(u){a.setTimeout(()=>{throw u},0)}function T(){var u=Sv;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class ji{constructor(){this.h=this.g=null}add(f,m){let y=bu.get();y.set(f,m),this.h?this.h.next=y:this.g=y,this.h=y}}var bu=new U(()=>new g$,u=>u.reset());class g${constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Cu,Tu=!1,Sv=new ji,Hx=()=>{let u=a.Promise.resolve(void 0);Cu=()=>{u.then(_$)}};var _$=()=>{for(var u;u=T();){try{u.h.call(u.g)}catch(m){N(m)}var f=bu;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}Tu=!1};function gs(){this.s=this.s,this.C=this.C}gs.prototype.s=!1,gs.prototype.ma=function(){this.s||(this.s=!0,this.N())},gs.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function sn(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}sn.prototype.h=function(){this.defaultPrevented=!0};var y$=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function Su(u,f){if(sn.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(fe){e:{try{ee(f.nodeName);var k=!0;break e}catch{}k=!1}k||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:v$[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Su.aa.h.call(this)}}E(Su,sn);var v$={2:"touch",3:"pen",4:"mouse"};Su.prototype.h=function(){Su.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Du="closure_listenable_"+(1e6*Math.random()|0),w$=0;function E$(u,f,m,y,k){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!y,this.ha=k,this.key=++w$,this.da=this.fa=!1}function Hf(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function zf(u){this.src=u,this.g={},this.h=0}zf.prototype.add=function(u,f,m,y,k){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var W=Av(u,f,y,k);return-1<W?(f=u[W],m||(f.fa=!1)):(f=new E$(f,this.src,M,!!y,k),f.fa=m,u.push(f)),f};function Dv(u,f){var m=f.type;if(m in u.g){var y=u.g[m],k=Array.prototype.indexOf.call(y,f,void 0),M;(M=0<=k)&&Array.prototype.splice.call(y,k,1),M&&(Hf(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function Av(u,f,m,y){for(var k=0;k<u.length;++k){var M=u[k];if(!M.da&&M.listener==f&&M.capture==!!m&&M.ha==y)return k}return-1}var xv="closure_lm_"+(1e6*Math.random()|0),Rv={};function zx(u,f,m,y,k){if(y&&y.once)return Gx(u,f,m,y,k);if(Array.isArray(f)){for(var M=0;M<f.length;M++)zx(u,f[M],m,y,k);return null}return m=Mv(m),u&&u[Du]?u.K(f,m,l(y)?!!y.capture:!!y,k):qx(u,f,m,!1,y,k)}function qx(u,f,m,y,k,M){if(!f)throw Error("Invalid event type");var W=l(k)?!!k.capture:!!k,Je=Nv(u);if(Je||(u[xv]=Je=new zf(u)),m=Je.add(f,m,y,W,M),m.proxy)return m;if(y=I$(),m.proxy=y,y.src=u,y.listener=m,u.addEventListener)y$||(k=W),k===void 0&&(k=!1),u.addEventListener(f.toString(),y,k);else if(u.attachEvent)u.attachEvent(Kx(f.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function I$(){function u(m){return f.call(u.src,u.listener,m)}let f=b$;return u}function Gx(u,f,m,y,k){if(Array.isArray(f)){for(var M=0;M<f.length;M++)Gx(u,f[M],m,y,k);return null}return m=Mv(m),u&&u[Du]?u.L(f,m,l(y)?!!y.capture:!!y,k):qx(u,f,m,!0,y,k)}function Wx(u,f,m,y,k){if(Array.isArray(f))for(var M=0;M<f.length;M++)Wx(u,f[M],m,y,k);else y=l(y)?!!y.capture:!!y,m=Mv(m),u&&u[Du]?(u=u.i,f=String(f).toString(),f in u.g&&(M=u.g[f],m=Av(M,m,y,k),-1<m&&(Hf(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete u.g[f],u.h--)))):u&&(u=Nv(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Av(f,m,y,k)),(m=-1<u?f[u]:null)&&kv(m))}function kv(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Du])Dv(f.i,u);else{var m=u.type,y=u.proxy;f.removeEventListener?f.removeEventListener(m,y,u.capture):f.detachEvent?f.detachEvent(Kx(m),y):f.addListener&&f.removeListener&&f.removeListener(y),(m=Nv(f))?(Dv(m,u),m.h==0&&(m.src=null,f[xv]=null)):Hf(u)}}}function Kx(u){return u in Rv?Rv[u]:Rv[u]="on"+u}function b$(u,f){if(u.da)u=!0;else{f=new Su(f,this);var m=u.listener,y=u.ha||u.src;u.fa&&kv(u),u=m.call(y,f)}return u}function Nv(u){return u=u[xv],u instanceof zf?u:null}var Pv="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mv(u){return typeof u=="function"?u:(u[Pv]||(u[Pv]=function(f){return u.handleEvent(f)}),u[Pv])}function on(){gs.call(this),this.i=new zf(this),this.M=this,this.F=null}E(on,gs),on.prototype[Du]=!0,on.prototype.removeEventListener=function(u,f,m,y){Wx(this,u,f,m,y)};function wn(u,f){var m,y=u.F;if(y)for(m=[];y;y=y.F)m.push(y);if(u=u.M,y=f.type||f,typeof f=="string")f=new sn(f,u);else if(f instanceof sn)f.target=f.target||u;else{var k=f;f=new sn(y,u),D(f,k)}if(k=!0,m)for(var M=m.length-1;0<=M;M--){var W=f.g=m[M];k=qf(W,y,!0,f)&&k}if(W=f.g=u,k=qf(W,y,!0,f)&&k,k=qf(W,y,!1,f)&&k,m)for(M=0;M<m.length;M++)W=f.g=m[M],k=qf(W,y,!1,f)&&k}on.prototype.N=function(){if(on.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],y=0;y<m.length;y++)Hf(m[y]);delete u.g[f],u.h--}}this.F=null},on.prototype.K=function(u,f,m,y){return this.i.add(String(u),f,!1,m,y)},on.prototype.L=function(u,f,m,y){return this.i.add(String(u),f,!0,m,y)};function qf(u,f,m,y){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var k=!0,M=0;M<f.length;++M){var W=f[M];if(W&&!W.da&&W.capture==m){var Je=W.listener,en=W.ha||W.src;W.fa&&Dv(u.i,W),k=Je.call(en,y)!==!1&&k}}return k&&!y.defaultPrevented}function Qx(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function Yx(u){u.g=Qx(()=>{u.g=null,u.i&&(u.i=!1,Yx(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class C$ extends gs{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Yx(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Au(u){gs.call(this),this.h=u,this.g={}}E(Au,gs);var Jx=[];function Xx(u){re(u.g,function(f,m){this.g.hasOwnProperty(m)&&kv(f)},u),u.g={}}Au.prototype.N=function(){Au.aa.N.call(this),Xx(this)},Au.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ov=a.JSON.stringify,T$=a.JSON.parse,S$=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Fv(){}Fv.prototype.h=null;function Zx(u){return u.h||(u.h=u.i())}function eR(){}var xu={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Lv(){sn.call(this,"d")}E(Lv,sn);function Vv(){sn.call(this,"c")}E(Vv,sn);var Do={},tR=null;function Gf(){return tR=tR||new on}Do.La="serverreachability";function nR(u){sn.call(this,Do.La,u)}E(nR,sn);function Ru(u){let f=Gf();wn(f,new nR(f))}Do.STAT_EVENT="statevent";function rR(u,f){sn.call(this,Do.STAT_EVENT,u),this.stat=f}E(rR,sn);function En(u){let f=Gf();wn(f,new rR(f,u))}Do.Ma="timingevent";function iR(u,f){sn.call(this,Do.Ma,u),this.size=f}E(iR,sn);function ku(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function Nu(){this.g=!0}Nu.prototype.xa=function(){this.g=!1};function D$(u,f,m,y,k,M){u.info(function(){if(u.g)if(M)for(var W="",Je=M.split("&"),en=0;en<Je.length;en++){var Be=Je[en].split("=");if(1<Be.length){var an=Be[0];Be=Be[1];var cn=an.split("_");W=2<=cn.length&&cn[1]=="type"?W+(an+"="+Be+"&"):W+(an+"=redacted&")}}else W=null;else W=M;return"XMLHTTP REQ ("+y+") [attempt "+k+"]: "+f+`
`+m+`
`+W})}function A$(u,f,m,y,k,M,W){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+k+"]: "+f+`
`+m+`
`+M+" "+W})}function tc(u,f,m,y){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+R$(u,m)+(y?" "+y:"")})}function x$(u,f){u.info(function(){return"TIMEOUT: "+f})}Nu.prototype.info=function(){};function R$(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var y=m[u];if(!(2>y.length)){var k=y[1];if(Array.isArray(k)&&!(1>k.length)){var M=k[0];if(M!="noop"&&M!="stop"&&M!="close")for(var W=1;W<k.length;W++)k[W]=""}}}}return Ov(m)}catch{return f}}var Wf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sR={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Uv;function Kf(){}E(Kf,Fv),Kf.prototype.g=function(){return new XMLHttpRequest},Kf.prototype.i=function(){return{}},Uv=new Kf;function _s(u,f,m,y){this.j=u,this.i=f,this.l=m,this.R=y||1,this.U=new Au(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oR}function oR(){this.i=null,this.g="",this.h=!1}var aR={},Bv={};function jv(u,f,m){u.L=1,u.v=Xf($i(f)),u.m=m,u.P=!0,cR(u,null)}function cR(u,f){u.F=Date.now(),Qf(u),u.A=$i(u.v);var m=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),IR(m.i,"t",y),u.C=0,m=u.j.J,u.h=new oR,u.g=BR(u.j,m?f:null,!u.m),0<u.O&&(u.M=new C$(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,y=u.ca;var k="readystatechange";Array.isArray(k)||(k&&(Jx[0]=k.toString()),k=Jx);for(var M=0;M<k.length;M++){var W=zx(m,k[M],y||f.handleEvent,!1,f.h||f);if(!W)break;f.g[W.key]=W}f=u.H?b(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),Ru(),D$(u.i,u.u,u.A,u.l,u.R,u.m)}_s.prototype.ca=function(u){u=u.target;let f=this.M;f&&Hi(u)==3?f.j():this.Y(u)},_s.prototype.Y=function(u){try{if(u==this.g)e:{let cn=Hi(this.g);var f=this.g.Ba();let ic=this.g.Z();if(!(3>cn)&&(cn!=3||this.g&&(this.h.h||this.g.oa()||xR(this.g)))){this.J||cn!=4||f==7||(f==8||0>=ic?Ru(3):Ru(2)),$v(this);var m=this.g.Z();this.X=m;t:if(lR(this)){var y=xR(this.g);u="";var k=y.length,M=Hi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ao(this),Pu(this);var W="";break t}this.h.i=new a.TextDecoder}for(f=0;f<k;f++)this.h.h=!0,u+=this.h.i.decode(y[f],{stream:!(M&&f==k-1)});y.length=0,this.h.g+=u,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=m==200,A$(this.i,this.u,this.A,this.l,this.R,cn,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Je,en=this.g;if((Je=en.g?en.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!J(Je)){var Be=Je;break t}}Be=null}if(m=Be)tc(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hv(this,m);else{this.o=!1,this.s=3,En(12),Ao(this),Pu(this);break e}}if(this.P){m=!0;let xr;for(;!this.J&&this.C<W.length;)if(xr=k$(this,W),xr==Bv){cn==4&&(this.s=4,En(14),m=!1),tc(this.i,this.l,null,"[Incomplete Response]");break}else if(xr==aR){this.s=4,En(15),tc(this.i,this.l,W,"[Invalid Chunk]"),m=!1;break}else tc(this.i,this.l,xr,null),Hv(this,xr);if(lR(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),cn!=4||W.length!=0||this.h.h||(this.s=1,En(16),m=!1),this.o=this.o&&m,!m)tc(this.i,this.l,W,"[Invalid Chunked Response]"),Ao(this),Pu(this);else if(0<W.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Qv(an),an.M=!0,En(11))}}else tc(this.i,this.l,W,null),Hv(this,W);cn==4&&Ao(this),this.o&&!this.J&&(cn==4?FR(this.j,this):(this.o=!1,Qf(this)))}else K$(this.g),m==400&&0<W.indexOf("Unknown SID")?(this.s=3,En(12)):(this.s=0,En(13)),Ao(this),Pu(this)}}}catch{}finally{}};function lR(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function k$(u,f){var m=u.C,y=f.indexOf(`
`,m);return y==-1?Bv:(m=Number(f.substring(m,y)),isNaN(m)?aR:(y+=1,y+m>f.length?Bv:(f=f.slice(y,y+m),u.C=y+m,f)))}_s.prototype.cancel=function(){this.J=!0,Ao(this)};function Qf(u){u.S=Date.now()+u.I,uR(u,u.I)}function uR(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=ku(p(u.ba,u),f)}function $v(u){u.B&&(a.clearTimeout(u.B),u.B=null)}_s.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(x$(this.i,this.A),this.L!=2&&(Ru(),En(17)),Ao(this),this.s=2,Pu(this)):uR(this,this.S-u)};function Pu(u){u.j.G==0||u.J||FR(u.j,u)}function Ao(u){$v(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,Xx(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function Hv(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||zv(m.h,u))){if(!u.K&&zv(m.h,u)&&m.G==3){try{var y=m.Da.g.parse(f)}catch{y=null}if(Array.isArray(y)&&y.length==3){var k=y;if(k[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)rp(m),tp(m);else break e;Kv(m),En(18)}}else m.za=k[1],0<m.za-m.T&&37500>k[2]&&m.F&&m.v==0&&!m.C&&(m.C=ku(p(m.Za,m),6e3));if(1>=fR(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Ro(m,11)}else if((u.K||m.g==u)&&rp(m),!J(f))for(k=m.Da.g.parse(f),f=0;f<k.length;f++){let Be=k[f];if(m.T=Be[0],Be=Be[1],m.G==2)if(Be[0]=="c"){m.K=Be[1],m.ia=Be[2];let an=Be[3];an!=null&&(m.la=an,m.j.info("VER="+m.la));let cn=Be[4];cn!=null&&(m.Aa=cn,m.j.info("SVER="+m.Aa));let ic=Be[5];ic!=null&&typeof ic=="number"&&0<ic&&(y=1.5*ic,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;let xr=u.g;if(xr){let sp=xr.g?xr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sp){var M=y.h;M.g||sp.indexOf("spdy")==-1&&sp.indexOf("quic")==-1&&sp.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(qv(M,M.h),M.h=null))}if(y.D){let Yv=xr.g?xr.g.getResponseHeader("X-HTTP-Session-Id"):null;Yv&&(y.ya=Yv,at(y.I,y.D,Yv))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var W=u;if(y.qa=UR(y,y.J?y.ia:null,y.W),W.K){pR(y.h,W);var Je=W,en=y.L;en&&(Je.I=en),Je.B&&($v(Je),Qf(Je)),y.g=W}else MR(y);0<m.i.length&&np(m)}else Be[0]!="stop"&&Be[0]!="close"||Ro(m,7);else m.G==3&&(Be[0]=="stop"||Be[0]=="close"?Be[0]=="stop"?Ro(m,7):Wv(m):Be[0]!="noop"&&m.l&&m.l.ta(Be),m.v=0)}}Ru(4)}catch{}}var N$=class{constructor(u,f){this.g=u,this.map=f}};function dR(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function hR(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function fR(u){return u.h?1:u.g?u.g.size:0}function zv(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function qv(u,f){u.g?u.g.add(f):u.h=f}function pR(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}dR.prototype.cancel=function(){if(this.i=mR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function mR(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return A(u.i)}function P$(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,y=0;y<m;y++)f.push(u[y]);return f}f=[],m=0;for(y in u)f[m++]=u[y];return f}function M$(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let y in u)f[m++]=y;return f}}}function gR(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=M$(u),y=P$(u),k=y.length,M=0;M<k;M++)f.call(void 0,y[M],m&&m[M],u)}var _R=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function O$(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var y=u[m].indexOf("="),k=null;if(0<=y){var M=u[m].substring(0,y);k=u[m].substring(y+1)}else M=u[m];f(M,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function xo(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof xo){this.h=u.h,Yf(this,u.j),this.o=u.o,this.g=u.g,Jf(this,u.s),this.l=u.l;var f=u.i,m=new Fu;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),yR(this,m),this.m=u.m}else u&&(f=String(u).match(_R))?(this.h=!1,Yf(this,f[1]||"",!0),this.o=Mu(f[2]||""),this.g=Mu(f[3]||"",!0),Jf(this,f[4]),this.l=Mu(f[5]||"",!0),yR(this,f[6]||"",!0),this.m=Mu(f[7]||"")):(this.h=!1,this.i=new Fu(null,this.h))}xo.prototype.toString=function(){var u=[],f=this.j;f&&u.push(Ou(f,vR,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(Ou(f,vR,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(Ou(m,m.charAt(0)=="/"?V$:L$,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",Ou(m,B$)),u.join("")};function $i(u){return new xo(u)}function Yf(u,f,m){u.j=m?Mu(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Jf(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function yR(u,f,m){f instanceof Fu?(u.i=f,j$(u.i,u.h)):(m||(f=Ou(f,U$)),u.i=new Fu(f,u.h))}function at(u,f,m){u.i.set(f,m)}function Xf(u){return at(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Mu(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ou(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,F$),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function F$(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var vR=/[#\/\?@]/g,L$=/[#\?:]/g,V$=/[#\?]/g,U$=/[#\?@]/g,B$=/#/g;function Fu(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function ys(u){u.g||(u.g=new Map,u.h=0,u.i&&O$(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Fu.prototype,n.add=function(u,f){ys(this),this.i=null,u=nc(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function wR(u,f){ys(u),f=nc(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function ER(u,f){return ys(u),f=nc(u,f),u.g.has(f)}n.forEach=function(u,f){ys(this),this.g.forEach(function(m,y){m.forEach(function(k){u.call(f,k,y,this)},this)},this)},n.na=function(){ys(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let y=0;y<f.length;y++){let k=u[y];for(let M=0;M<k.length;M++)m.push(f[y])}return m},n.V=function(u){ys(this);let f=[];if(typeof u=="string")ER(this,u)&&(f=f.concat(this.g.get(nc(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return ys(this),this.i=null,u=nc(this,u),ER(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function IR(u,f,m){wR(u,f),0<m.length&&(u.i=null,u.g.set(nc(u,f),A(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var y=f[m];let M=encodeURIComponent(String(y)),W=this.V(y);for(y=0;y<W.length;y++){var k=M;W[y]!==""&&(k+="="+encodeURIComponent(String(W[y]))),u.push(k)}}return this.i=u.join("&")};function nc(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function j$(u,f){f&&!u.j&&(ys(u),u.i=null,u.g.forEach(function(m,y){var k=y.toLowerCase();y!=k&&(wR(this,y),IR(this,k,m))},u)),u.j=f}function $$(u,f){let m=new Nu;if(a.Image){let y=new Image;y.onload=_(vs,m,"TestLoadImage: loaded",!0,f,y),y.onerror=_(vs,m,"TestLoadImage: error",!1,f,y),y.onabort=_(vs,m,"TestLoadImage: abort",!1,f,y),y.ontimeout=_(vs,m,"TestLoadImage: timeout",!1,f,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else f(!1)}function H$(u,f){let m=new Nu,y=new AbortController,k=setTimeout(()=>{y.abort(),vs(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:y.signal}).then(M=>{clearTimeout(k),M.ok?vs(m,"TestPingServer: ok",!0,f):vs(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(k),vs(m,"TestPingServer: error",!1,f)})}function vs(u,f,m,y,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),y(m)}catch{}}function z$(){this.g=new S$}function q$(u,f,m){let y=m||"";try{gR(u,function(k,M){let W=k;l(k)&&(W=Ov(k)),f.push(y+M+"="+encodeURIComponent(W))})}catch(k){throw f.push(y+"type="+encodeURIComponent("_badmap")),k}}function Lu(u){this.l=u.Ub||null,this.j=u.eb||!1}E(Lu,Fv),Lu.prototype.g=function(){return new Zf(this.l,this.j)},Lu.prototype.i=function(u){return function(){return u}}({});function Zf(u,f){on.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Zf,on),n=Zf.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,Uu(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vu(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Uu(this)),this.g&&(this.readyState=3,Uu(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;bR(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function bR(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Vu(this):Uu(this),this.readyState==3&&bR(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Vu(this))},n.Qa=function(u){this.g&&(this.response=u,Vu(this))},n.ga=function(){this.g&&Vu(this)};function Vu(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Uu(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Uu(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Zf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function CR(u){let f="";return re(u,function(m,y){f+=y,f+=":",f+=m,f+=`\r
`}),f}function Gv(u,f,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=CR(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):at(u,f,m))}function yt(u){on.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(yt,on);var G$=/^https?$/i,W$=["POST","PUT"];n=yt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Uv.g(),this.v=this.o?Zx(this.o):Zx(Uv),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(M){TR(this,M);return}if(u=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var k in y)m.set(k,y[k]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let M of y.keys())m.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),k=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(W$,f,void 0))||y||k||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,W]of m)this.g.setRequestHeader(M,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{AR(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){TR(this,M)}};function TR(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,SR(u),ep(u)}function SR(u){u.A||(u.A=!0,wn(u,"complete"),wn(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,wn(this,"complete"),wn(this,"abort"),ep(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ep(this,!0)),yt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?DR(this):this.bb())},n.bb=function(){DR(this)};function DR(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Hi(u)!=4||u.Z()!=2)){if(u.u&&Hi(u)==4)Qx(u.Ea,0,u);else if(wn(u,"readystatechange"),Hi(u)==4){u.h=!1;try{let W=u.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var y;if(y=W===0){var k=String(u.D).match(_R)[1]||null;!k&&a.self&&a.self.location&&(k=a.self.location.protocol.slice(0,-1)),y=!G$.test(k?k.toLowerCase():"")}m=y}if(m)wn(u,"complete"),wn(u,"success");else{u.m=6;try{var M=2<Hi(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",SR(u)}}finally{ep(u)}}}}function ep(u,f){if(u.g){AR(u);let m=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||wn(u,"ready");try{m.onreadystatechange=y}catch{}}}function AR(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Hi(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Hi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),T$(f)}};function xR(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function K$(u){let f={};u=(u.g&&2<=Hi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(J(u[y]))continue;var m=x(u[y]);let k=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let M=f[k]||[];f[k]=M,M.push(m)}S(f,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bu(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function RR(u){this.Aa=0,this.i=[],this.j=new Nu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Bu("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Bu("baseRetryDelayMs",5e3,u),this.cb=Bu("retryDelaySeedMs",1e4,u),this.Wa=Bu("forwardChannelMaxRetries",2,u),this.wa=Bu("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new dR(u&&u.concurrentRequestLimit),this.Da=new z$,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=RR.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,y){En(0),this.W=u,this.H=f||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=UR(this,null,this.W),np(this)};function Wv(u){if(kR(u),u.G==3){var f=u.U++,m=$i(u.I);if(at(m,"SID",u.K),at(m,"RID",f),at(m,"TYPE","terminate"),ju(u,m),f=new _s(u,u.j,f),f.L=2,f.v=Xf($i(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=BR(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Qf(f)}VR(u)}function tp(u){u.g&&(Qv(u),u.g.cancel(),u.g=null)}function kR(u){tp(u),u.u&&(a.clearTimeout(u.u),u.u=null),rp(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function np(u){if(!hR(u.h)&&!u.s){u.s=!0;var f=u.Ga;Cu||Hx(),Tu||(Cu(),Tu=!0),Sv.add(f,u),u.B=0}}function Q$(u,f){return fR(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=ku(p(u.Ga,u,f),LR(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let k=new _s(this,this.j,u),M=this.o;if(this.S&&(M?(M=b(M),D(M,this.S)):M=this.S),this.m!==null||this.O||(k.H=M,M=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(f+=y,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=PR(this,k,f),m=$i(this.I),at(m,"RID",u),at(m,"CVER",22),this.D&&at(m,"X-HTTP-Session-Id",this.D),ju(this,m),M&&(this.O?f="headers="+encodeURIComponent(String(CR(M)))+"&"+f:this.m&&Gv(m,this.m,M)),qv(this.h,k),this.Ua&&at(m,"TYPE","init"),this.P?(at(m,"$req",f),at(m,"SID","null"),k.T=!0,jv(k,m,null)):jv(k,m,f),this.G=2}}else this.G==3&&(u?NR(this,u):this.i.length==0||hR(this.h)||NR(this))};function NR(u,f){var m;f?m=f.l:m=u.U++;let y=$i(u.I);at(y,"SID",u.K),at(y,"RID",m),at(y,"AID",u.T),ju(u,y),u.m&&u.o&&Gv(y,u.m,u.o),m=new _s(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=PR(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),qv(u.h,m),jv(m,y,f)}function ju(u,f){u.H&&re(u.H,function(m,y){at(f,y,m)}),u.l&&gR({},function(m,y){at(f,y,m)})}function PR(u,f,m){m=Math.min(u.i.length,m);var y=u.l?p(u.l.Na,u.l,u):null;e:{var k=u.i;let M=-1;for(;;){let W=["count="+m];M==-1?0<m?(M=k[0].g,W.push("ofs="+M)):M=0:W.push("ofs="+M);let Je=!0;for(let en=0;en<m;en++){let Be=k[en].g,an=k[en].map;if(Be-=M,0>Be)M=Math.max(0,k[en].g-100),Je=!1;else try{q$(an,W,"req"+Be+"_")}catch{y&&y(an)}}if(Je){y=W.join("&");break e}}}return u=u.i.splice(0,m),f.D=u,y}function MR(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;Cu||Hx(),Tu||(Cu(),Tu=!0),Sv.add(f,u),u.v=0}}function Kv(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=ku(p(u.Fa,u),LR(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,OR(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=ku(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,En(10),tp(this),OR(this))};function Qv(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function OR(u){u.g=new _s(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=$i(u.qa);at(f,"RID","rpc"),at(f,"SID",u.K),at(f,"AID",u.T),at(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&at(f,"TO",u.ja),at(f,"TYPE","xmlhttp"),ju(u,f),u.m&&u.o&&Gv(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Xf($i(f)),m.m=null,m.P=!0,cR(m,u)}n.Za=function(){this.C!=null&&(this.C=null,tp(this),Kv(this),En(19))};function rp(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function FR(u,f){var m=null;if(u.g==f){rp(u),Qv(u),u.g=null;var y=2}else if(zv(u.h,f))m=f.D,pR(u.h,f),y=1;else return;if(u.G!=0){if(f.o)if(y==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var k=u.B;y=Gf(),wn(y,new iR(y,m)),np(u)}else MR(u);else if(k=f.s,k==3||k==0&&0<f.X||!(y==1&&Q$(u,f)||y==2&&Kv(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),k){case 1:Ro(u,5);break;case 4:Ro(u,10);break;case 3:Ro(u,6);break;default:Ro(u,2)}}}function LR(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function Ro(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),y=u.Xa;let k=!y;y=new xo(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Yf(y,"https"),Xf(y),k?$$(y.toString(),m):H$(y.toString(),m)}else En(2);u.G=0,u.l&&u.l.sa(f),VR(u),kR(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),En(2)):(this.j.info("Failed to ping google.com"),En(1))};function VR(u){if(u.G=0,u.ka=[],u.l){let f=mR(u.h);(f.length!=0||u.i.length!=0)&&(R(u.ka,f),R(u.ka,u.i),u.h.i.length=0,A(u.i),u.i.length=0),u.l.ra()}}function UR(u,f,m){var y=m instanceof xo?$i(m):new xo(m);if(y.g!="")f&&(y.g=f+"."+y.g),Jf(y,y.s);else{var k=a.location;y=k.protocol,f=f?f+"."+k.hostname:k.hostname,k=+k.port;var M=new xo(null);y&&Yf(M,y),f&&(M.g=f),k&&Jf(M,k),m&&(M.l=m),y=M}return m=u.D,f=u.ya,m&&f&&at(y,m,f),at(y,"VER",u.la),ju(u,y),y}function BR(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new yt(new Lu({eb:m})):new yt(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function jR(){}n=jR.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ip(){}ip.prototype.g=function(u,f){return new Jn(u,f)};function Jn(u,f){on.call(this),this.g=new RR(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!J(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!J(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new rc(this)}E(Jn,on),Jn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jn.prototype.close=function(){Wv(this.g)},Jn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=Ov(u),u=m);f.i.push(new N$(f.Ya++,u)),f.G==3&&np(f)},Jn.prototype.N=function(){this.g.l=null,delete this.j,Wv(this.g),delete this.g,Jn.aa.N.call(this)};function $R(u){Lv.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(let m in f){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}E($R,Lv);function HR(){Vv.call(this),this.status=1}E(HR,Vv);function rc(u){this.g=u}E(rc,jR),rc.prototype.ua=function(){wn(this.g,"a")},rc.prototype.ta=function(u){wn(this.g,new $R(u))},rc.prototype.sa=function(u){wn(this.g,new HR)},rc.prototype.ra=function(){wn(this.g,"b")},ip.prototype.createWebChannel=ip.prototype.g,Jn.prototype.send=Jn.prototype.o,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,NC=ss.createWebChannelTransport=function(){return new ip},kC=ss.getStatEventTarget=function(){return Gf()},RC=ss.Event=Do,Jg=ss.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Wf.NO_ERROR=0,Wf.TIMEOUT=8,Wf.HTTP_ERROR=6,hh=ss.ErrorCode=Wf,sR.COMPLETE="complete",xC=ss.EventType=sR,eR.EventType=xu,xu.OPEN="a",xu.CLOSE="b",xu.ERROR="c",xu.MESSAGE="d",on.prototype.listen=on.prototype.K,al=ss.WebChannel=eR,AC=ss.FetchXmlHttpFactory=Lu,yt.prototype.listenOnce=yt.prototype.L,yt.prototype.getLastError=yt.prototype.Ka,yt.prototype.getLastErrorCode=yt.prototype.Ba,yt.prototype.getStatus=yt.prototype.Z,yt.prototype.getResponseJson=yt.prototype.Oa,yt.prototype.getResponseText=yt.prototype.oa,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Ha,DC=ss.XhrIo=yt}).apply(typeof Yg<"u"?Yg:typeof self<"u"?self:typeof window<"u"?window:{});var dF="@firebase/firestore";var Ut=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");var Ll="10.12.1";var ro=new Wn("@firebase/firestore");function hl(){return ro.logLevel}function hL(n){ro.setLogLevel(n)}function B(n,...e){if(ro.logLevel<=Ee.DEBUG){let t=e.map(VS);ro.debug(`Firestore (${Ll}): ${n}`,...t)}}function St(n,...e){if(ro.logLevel<=Ee.ERROR){let t=e.map(VS);ro.error(`Firestore (${Ll}): ${n}`,...t)}}function Ir(n,...e){if(ro.logLevel<=Ee.WARN){let t=e.map(VS);ro.warn(`Firestore (${Ll}): ${n}`,...t)}}function VS(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ne(n="Unexpected state"){let e=`FIRESTORE (${Ll}) INTERNAL ASSERTION FAILED: `+n;throw St(e),new Error(e)}function se(n,e){n||ne()}function fL(n,e){n||ne()}function Q(n,e){return n}var O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends wt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Dt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var c_=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},LC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ut.UNAUTHENTICATED))}shutdown(){}},VC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},UC=class{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>g(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(se(typeof r.accessToken=="string"),new c_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return se(e===null||typeof e=="string"),new Ut(e)}},BC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},jC=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new BC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}},$C=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},HC=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(se(typeof t.token=="string"),this.R=t.token,new $C(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function VK(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var l_=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=VK(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function _e(n,e){return n<e?-1:n>e?1:0}function wl(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function pL(n){return n+"\0"}var mt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?_e(this.nanoseconds,e.nanoseconds):_e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ae=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new mt(0,0))}static max(){return new n(new mt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var u_=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ne(),r===void 0?r=e.length-t:r>e.length-t&&ne(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Oe=class n extends u_{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},UK=/^[_a-zA-Z][_a-zA-Z0-9]*$/,At=class n extends u_{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return UK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new V(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new V(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new V(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new V(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Y=class n{constructor(e){this.path=e}static fromPath(e){return new n(Oe.fromString(e))}static fromName(e){return new n(Oe.fromString(e).popFirst(5))}static empty(){return new n(Oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Oe(e.slice()))}};var El=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function zC(n){return n.fields.find(e=>e.kind===2)}function _a(n){return n.fields.filter(e=>e.kind!==2)}El.UNKNOWN_ID=-1;var _l=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Ch=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,br.min())}};function mL(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ae.fromTimestamp(r===1e9?new mt(t+1,0):new mt(t,r));return new br(i,Y.empty(),e)}function gL(n){return new br(n.readTime,n.key,-1)}var br=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ae.min(),Y.empty(),-1)}static max(){return new n(ae.max(),Y.empty(),-1)}};function US(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Y.comparator(n.documentKey,e.documentKey),t!==0?t:_e(n.largestBatchId,e.largestBatchId))}var _L="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",d_=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function po(n){return g(this,null,function*(){if(n.code!==O.FAILED_PRECONDITION||n.message!==_L)throw n;B("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var h_=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Dt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ba(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=BS(r.target.error);this.V.reject(new ba(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new ba(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(B("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new GC(t)}},io=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Ze())===12.2&&St("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return B("SimpleDb","Removing database:",e),ya(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Vs())return!1;if(n.C())return!0;let e=Ze(),t=n.S(e),r=0<t&&t<10,i=yL(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return g(this,null,function*(){return this.db||(B("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new ba(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new V(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new V(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ba(e,o))},i.onupgradeneeded=s=>{B("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{B("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return g(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=h_.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),P.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(B("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function yL(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var qC=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ya(this.B.delete())}},ba=class extends V{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function mo(n){return n.name==="IndexedDbTransactionError"}var GC=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(B("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(B("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ya(r)}add(e){return B("SimpleDb","ADD",this.store.name,e,e),ya(this.store.add(e))}get(e){return ya(this.store.get(e)).next(t=>(t===void 0&&(t=null),B("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return B("SimpleDb","DELETE",this.store.name,e),ya(this.store.delete(e))}count(){return B("SimpleDb","COUNT",this.store.name),ya(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new P((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new P((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){B("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new P((r,i)=>{t.onerror=s=>{let o=BS(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new P((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new qC(a),l=t(a.primaryKey,a.value,c);if(l instanceof P){let d=l.catch(h=>(c.done(),P.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>P.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ya(n){return new P((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=BS(r.target.error);t(i)}})}var hF=!1;function BS(n){let e=io.S(Ze());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new V("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hF||(hF=!0,setTimeout(()=>{throw r},0)),r}}return n}var WC=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){B("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>g(this,null,function*(){this.task=null;try{B("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){mo(t)?B("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield po(t)}yield this.X(6e4)}))}},KC=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return g(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return P.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return B("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(B("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=gL(s);US(o,r)>0&&(r=o)}),new br(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var rr=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Gh(n){return n==null}function Th(n){return n===0&&1/n==-1/0}function vL(n){return typeof n=="number"&&Number.isInteger(n)&&!Th(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Rn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=fF(e)),e=BK(n.get(t),e);return fF(e)}function BK(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function fF(n){return n+""}function bi(n){let e=n.length;if(se(e>=2),e===2)return se(n.charAt(0)===""&&n.charAt(1)===""),Oe.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&ne(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:ne()}s=o+2}return new Oe(r)}var pF=["userId","batchId"];function n_(n,e){return[n,Rn(e)]}function wL(n,e,t){return[n,Rn(e),t]}var jK={},$K=["prefixPath","collectionGroup","readTime","documentId"],HK=["prefixPath","collectionGroup","documentId"],zK=["collectionGroup","readTime","prefixPath","documentId"],qK=["canonicalId","targetId"],GK=["targetId","path"],WK=["path","targetId"],KK=["collectionId","parent"],QK=["indexId","uid"],YK=["uid","sequenceNumber"],JK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],XK=["indexId","uid","orderedDocumentKey"],ZK=["userId","collectionPath","documentId"],eQ=["userId","collectionPath","largestBatchId"],tQ=["userId","collectionGroup","largestBatchId"],EL=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],nQ=[...EL,"documentOverlays"],IL=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],bL=IL,CL=[...bL,"indexConfiguration","indexState","indexEntries"],rQ=CL;var Sh=class extends d_{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Jt(n,e){let t=Q(n);return io.F(t._e,e)}function mF(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Oa(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function iQ(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function TL(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var lt=class n{constructor(e,t){this.comparator=e,this.root=t||Ti.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ti.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ti.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gl(this.root,e,this.comparator,!1)}getReverseIterator(){return new gl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gl(this.root,e,this.comparator,!0)}},gl=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ti=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ne();let e=this.left.check();if(e!==this.right.check())throw ne();return e+(this.isRed()?0:1)}};Ti.EMPTY=null,Ti.RED=!0,Ti.BLACK=!1;Ti.EMPTY=new class{constructor(){this.size=0}get key(){throw ne()}get value(){throw ne()}get color(){throw ne()}get left(){throw ne()}get right(){throw ne()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Ti(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var et=class n{constructor(e){this.comparator=e,this.data=new lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new f_(this.data.getIterator())}getIteratorFrom(e){return new f_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},f_=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function cl(n){return n.hasNext()?n.getNext():void 0}var ir=class n{constructor(e){this.fields=e,e.sort(At.comparator)}static empty(){return new n([])}unionWith(e){let t=new et(At.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wl(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var p_=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function SL(){return typeof atob<"u"}var Yt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new p_("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Yt.EMPTY_BYTE_STRING=new Yt("");var sQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cs(n){if(se(!!n),typeof n=="string"){let e=0,t=sQ.exec(n);if(se(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:bt(n.seconds),nanos:bt(n.nanos)}}function bt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function so(n){return typeof n=="string"?Yt.fromBase64String(n):Yt.fromUint8Array(n)}function iy(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function jS(n){let e=n.mapValue.fields.__previous_value__;return iy(e)?jS(e):e}function Dh(n){let e=cs(n.mapValue.fields.__local_write_time__.timestampValue);return new mt(e.seconds,e.nanos)}var QC=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},oo=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var to={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},r_={nullValue:"NULL_VALUE"};function Ca(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?iy(n)?4:DL(n)?9007199254740991:10:ne()}function Ai(n,e){if(n===e)return!0;let t=Ca(n);if(t!==Ca(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dh(n).isEqual(Dh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=cs(i.timestampValue),a=cs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return so(i.bytesValue).isEqual(so(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return bt(i.geoPointValue.latitude)===bt(s.geoPointValue.latitude)&&bt(i.geoPointValue.longitude)===bt(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return bt(i.integerValue)===bt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=bt(i.doubleValue),a=bt(s.doubleValue);return o===a?Th(o)===Th(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return wl(n.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(mF(o)!==mF(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Ai(o[c],a[c])))return!1;return!0}(n,e);default:return ne()}}function Ah(n,e){return(n.values||[]).find(t=>Ai(t,e))!==void 0}function ao(n,e){if(n===e)return 0;let t=Ca(n),r=Ca(e);if(t!==r)return _e(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return _e(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=bt(s.integerValue||s.doubleValue),c=bt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return gF(n.timestampValue,e.timestampValue);case 4:return gF(Dh(n),Dh(e));case 5:return _e(n.stringValue,e.stringValue);case 6:return function(s,o){let a=so(s),c=so(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=_e(a[l],c[l]);if(d!==0)return d}return _e(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=_e(bt(s.latitude),bt(o.latitude));return a!==0?a:_e(bt(s.longitude),bt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){let d=ao(a[l],c[l]);if(d)return d}return _e(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===to.mapValue&&o===to.mapValue)return 0;if(s===to.mapValue)return 1;if(o===to.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let p=_e(c[h],d[h]);if(p!==0)return p;let _=ao(a[c[h]],l[d[h]]);if(_!==0)return _}return _e(c.length,d.length)}(n.mapValue,e.mapValue);default:throw ne()}}function gF(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return _e(n,e);let t=cs(n),r=cs(e),i=_e(t.seconds,r.seconds);return i!==0?i:_e(t.nanos,r.nanos)}function Il(n){return YC(n)}function YC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=cs(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return so(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Y.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=YC(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${YC(t.fields[o])}`;return i+"}"}(n.mapValue):ne()}function Ta(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function JC(n){return!!n&&"integerValue"in n}function xh(n){return!!n&&"arrayValue"in n}function _F(n){return!!n&&"nullValue"in n}function yF(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function i_(n){return!!n&&"mapValue"in n}function vh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Oa(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=vh(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function DL(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function oQ(n){return"nullValue"in n?r_:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ta(oo.empty(),Y.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ne()}function aQ(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ta(oo.empty(),Y.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?to:ne()}function vF(n,e){let t=ao(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function wF(n,e){let t=ao(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var _n=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!i_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vh(t)}setAll(e){let t=At.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=vh(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());i_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];i_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Oa(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(vh(this.value))}};function AL(n){let e=[];return Oa(n.fields,(t,r)=>{let i=new At([t]);if(i_(r)){let s=AL(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new ir(e)}var Bt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ae.min(),ae.min(),ae.min(),_n.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ae.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ae.min(),ae.min(),_n.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ae.min(),ae.min(),_n.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var xi=class{constructor(e,t){this.position=e,this.inclusive=t}};function EF(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),t.key):r=ao(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function IF(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ai(n.position[t],e.position[t]))return!1;return!0}var Sa=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function cQ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var m_=class{},ke=class n extends m_{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new eT(e,t,r):t==="array-contains"?new rT(e,r):t==="in"?new g_(e,r):t==="not-in"?new iT(e,r):t==="array-contains-any"?new sT(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new tT(e,r):new nT(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ao(t,this.value)):t!==null&&Ca(this.value)===Ca(t)&&this.matchesComparison(ao(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},We=class n extends m_{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return bl(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function bl(n){return n.op==="and"}function XC(n){return n.op==="or"}function $S(n){return xL(n)&&bl(n)}function xL(n){for(let e of n.filters)if(e instanceof We)return!1;return!0}function ZC(n){if(n instanceof ke)return n.field.canonicalString()+n.op.toString()+Il(n.value);if($S(n))return n.filters.map(e=>ZC(e)).join(",");{let e=n.filters.map(t=>ZC(t)).join(",");return`${n.op}(${e})`}}function RL(n,e){return n instanceof ke?function(r,i){return i instanceof ke&&r.op===i.op&&r.field.isEqual(i.field)&&Ai(r.value,i.value)}(n,e):n instanceof We?function(r,i){return i instanceof We&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&RL(o,i.filters[a]),!0):!1}(n,e):void ne()}function kL(n,e){let t=n.filters.concat(e);return We.create(t,n.op)}function NL(n){return n instanceof ke?function(t){return`${t.field.canonicalString()} ${t.op} ${Il(t.value)}`}(n):n instanceof We?function(t){return t.op.toString()+" {"+t.getFilters().map(NL).join(" ,")+"}"}(n):"Filter"}var eT=class extends ke{constructor(e,t,r){super(e,t,r),this.key=Y.fromName(r.referenceValue)}matches(e){let t=Y.comparator(e.key,this.key);return this.matchesComparison(t)}},tT=class extends ke{constructor(e,t){super(e,"in",t),this.keys=PL("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},nT=class extends ke{constructor(e,t){super(e,"not-in",t),this.keys=PL("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function PL(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Y.fromName(r.referenceValue))}var rT=class extends ke{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return xh(t)&&Ah(t.arrayValue,this.value)}},g_=class extends ke{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ah(this.value.arrayValue,t)}},iT=class extends ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ah(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ah(this.value.arrayValue,t)}},sT=class extends ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!xh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ah(this.value.arrayValue,r))}};var oT=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function aT(n,e=null,t=[],r=[],i=null,s=null,o=null){return new oT(n,e,t,r,i,s,o)}function Da(n){let e=Q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ZC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Il(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Il(r)).join(",")),e.ue=t}return e.ue}function Wh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!cQ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!RL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!IF(n.startAt,e.startAt)&&IF(n.endAt,e.endAt)}function __(n){return Y.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function y_(n,e){return n.filters.filter(t=>t instanceof ke&&t.field.isEqual(e))}function bF(n,e,t){let r=r_,i=!0;for(let s of y_(n,e)){let o=r_,a=!0;switch(s.op){case"<":case"<=":o=oQ(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=r_}vF({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];vF({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function CF(n,e,t){let r=to,i=!0;for(let s of y_(n,e)){let o=to,a=!0;switch(s.op){case">=":case">":o=aQ(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=to}wF({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];wF({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var qr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function ML(n,e,t,r,i,s,o,a){return new qr(n,e,t,r,i,s,o,a)}function Vl(n){return new qr(n)}function TF(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function HS(n){return n.collectionGroup!==null}function yl(n){let e=Q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new et(At.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Sa(s,r))}),t.has(At.keyField().canonicalString())||e.ce.push(new Sa(At.keyField(),r))}return e.ce}function kn(n){let e=Q(n);return e.le||(e.le=OL(e,yl(n))),e.le}function lQ(n){let e=Q(n);return e.he||(e.he=OL(e,n.explicitOrderBy)),e.he}function OL(n,e){if(n.limitType==="F")return aT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Sa(i.field,s)});let t=n.endAt?new xi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new xi(n.startAt.position,n.startAt.inclusive):null;return aT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function cT(n,e){let t=n.filters.concat([e]);return new qr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function v_(n,e,t){return new qr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Kh(n,e){return Wh(kn(n),kn(e))&&n.limitType===e.limitType}function FL(n){return`${Da(kn(n))}|lt:${n.limitType}`}function fl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>NL(i)).join(", ")}]`),Gh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Il(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Il(i)).join(",")),`Target(${r})`}(kn(n))}; limitType=${n.limitType})`}function Qh(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Y.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of yl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=EF(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,yl(r),i)||r.endAt&&!function(o,a,c){let l=EF(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,yl(r),i))}(n,e)}function LL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function VL(n){return(e,t)=>{let r=!1;for(let i of yl(n)){let s=uQ(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function uQ(n,e,t){let r=n.field.isKeyField()?Y.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?ao(c,l):ne()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ne()}}var Ri=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Oa(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return TL(this.inner)}size(){return this.innerSize}};var dQ=new lt(Y.comparator);function Qn(){return dQ}var UL=new lt(Y.comparator);function _h(...n){let e=UL;for(let t of n)e=e.insert(t.key,t);return e}function BL(n){let e=UL;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ci(){return wh()}function jL(){return wh()}function wh(){return new Ri(n=>n.toString(),(n,e)=>n.isEqual(e))}var hQ=new lt(Y.comparator),fQ=new et(Y.comparator);function ve(...n){let e=fQ;for(let t of n)e=e.add(t);return e}var pQ=new et(_e);function zS(){return pQ}function $L(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Th(e)?"-0":e}}function HL(n){return{integerValue:""+n}}function zL(n,e){return vL(e)?HL(e):$L(n,e)}var Cl=class{constructor(){this._=void 0}};function mQ(n,e,t){return n instanceof co?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&iy(s)&&(s=jS(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof ls?GL(n,e):n instanceof us?WL(n,e):function(i,s){let o=qL(i,s),a=SF(o)+SF(i.Pe);return JC(o)&&JC(i.Pe)?HL(a):$L(i.serializer,a)}(n,e)}function gQ(n,e,t){return n instanceof ls?GL(n,e):n instanceof us?WL(n,e):t}function qL(n,e){return n instanceof lo?function(r){return JC(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var co=class extends Cl{},ls=class extends Cl{constructor(e){super(),this.elements=e}};function GL(n,e){let t=KL(e);for(let r of n.elements)t.some(i=>Ai(i,r))||t.push(r);return{arrayValue:{values:t}}}var us=class extends Cl{constructor(e){super(),this.elements=e}};function WL(n,e){let t=KL(e);for(let r of n.elements)t=t.filter(i=>!Ai(i,r));return{arrayValue:{values:t}}}var lo=class extends Cl{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function SF(n){return bt(n.integerValue||n.doubleValue)}function KL(n){return xh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Aa=class{constructor(e,t){this.field=e,this.transform=t}};function _Q(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof ls&&i instanceof ls||r instanceof us&&i instanceof us?wl(r.elements,i.elements,Ai):r instanceof lo&&i instanceof lo?Ai(r.Pe,i.Pe):r instanceof co&&i instanceof co}(n.transform,e.transform)}var lT=class{constructor(e,t){this.version=e,this.transformResults=t}},Ct=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function s_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Tl=class{};function QL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ho(n.key,Ct.none()):new uo(n.key,n.data,Ct.none());{let t=n.data,r=_n.empty(),i=new et(At.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gr(n.key,r,new ir(i.toArray()),Ct.none())}}function yQ(n,e,t){n instanceof uo?function(i,s,o){let a=i.value.clone(),c=AF(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Gr?function(i,s,o){if(!s_(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=AF(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(YL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Eh(n,e,t,r){return n instanceof uo?function(s,o,a,c){if(!s_(s.precondition,o))return a;let l=s.value.clone(),d=xF(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Gr?function(s,o,a,c){if(!s_(s.precondition,o))return a;let l=xF(s.fieldTransforms,c,o),d=o.data;return d.setAll(YL(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,o,a){return s_(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function vQ(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=qL(r.transform,i||null);s!=null&&(t===null&&(t=_n.empty()),t.set(r.field,s))}return t||null}function DF(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&wl(r,i,(s,o)=>_Q(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var uo=class extends Tl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Gr=class extends Tl{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function YL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function AF(n,e,t){let r=new Map;se(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,gQ(o,a,t[i]))}return r}function xF(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,mQ(s,o,e))}return r}var ho=class extends Tl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Rh=class extends Tl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var kh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&yQ(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Eh(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Eh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=jL();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=QL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ae.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ve())}isEqual(e){return this.batchId===e.batchId&&wl(this.mutations,e.mutations,(t,r)=>DF(t,r))&&wl(this.baseMutations,e.baseMutations,(t,r)=>DF(t,r))}},uT=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){se(e.mutations.length===r.length);let i=function(){return hQ}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Nh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var dT=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var hT=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Lt,Me;function JL(n){switch(n){default:return ne();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function XL(n){if(n===void 0)return St("GRPC error has no .code"),O.UNKNOWN;switch(n){case Lt.OK:return O.OK;case Lt.CANCELLED:return O.CANCELLED;case Lt.UNKNOWN:return O.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return O.INTERNAL;case Lt.UNAVAILABLE:return O.UNAVAILABLE;case Lt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Lt.NOT_FOUND:return O.NOT_FOUND;case Lt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Lt.ABORTED:return O.ABORTED;case Lt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Lt.DATA_LOSS:return O.DATA_LOSS;default:return ne()}}(Me=Lt||(Lt={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";var RF=null;function ZL(){return new TextEncoder}var wQ=new Qs([4294967295,4294967295],0);function kF(n){let e=ZL().encode(n),t=new SC;return t.update(e),new Uint8Array(t.digest())}function NF(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Qs([t,r],0),new Qs([i,s],0)]}var fT=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ia(`Invalid padding: ${t}`);if(r<0)throw new Ia(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ia(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ia(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Qs.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Qs.fromNumber(r)));return i.compare(wQ)===1&&(i=new Qs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=kF(e),[r,i]=NF(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=kF(e),[r,i]=NF(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ia=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ph=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Mh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ae.min(),i,new lt(_e),Qn(),ve())}},Mh=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ve(),ve(),ve())}};var vl=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},w_=class{constructor(e,t){this.targetId=e,this.me=t}},E_=class{constructor(e,t,r=Yt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},I_=class{constructor(){this.fe=0,this.ge=MF(),this.pe=Yt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ve(),t=ve(),r=ve();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ne()}}),new Mh(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=MF()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,se(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},pT=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Qn(),this.qe=PF(),this.Qe=new lt(_e)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:ne()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(__(s))if(r===0){let o=new Y(s.path);this.Ue(t,o,Bt.newNoDocument(o,ae.min()))}else se(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}RF?.et(function(d,h,p,_,E){var A,R,U,J,H,ee;let fe={localCacheCount:d,existenceFilterCount:h.count,databaseId:p.database,projectId:p.projectId},re=h.unchangedNames;return re&&(fe.bloomFilter={applied:E===0,hashCount:(A=re?.hashCount)!==null&&A!==void 0?A:0,bitmapLength:(J=(U=(R=re?.bits)===null||R===void 0?void 0:R.bitmap)===null||U===void 0?void 0:U.length)!==null&&J!==void 0?J:0,padding:(ee=(H=re?.bits)===null||H===void 0?void 0:H.padding)!==null&&ee!==void 0?ee:0,mightContain:S=>{var b;return(b=_?.mightContain(S))!==null&&b!==void 0&&b}}),fe}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=so(r).toUint8Array()}catch(c){if(c instanceof p_)return Ir("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new fT(o,i,s)}catch(c){return Ir(c instanceof Ia?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&__(a.target)){let c=new Y(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Bt.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let r=ve();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Ph(e,t,this.Qe,this.ke,r);return this.ke=Qn(),this.qe=PF(),this.Qe=new lt(_e),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new I_,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new et(_e),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||B("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new I_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function PF(){return new lt(Y.comparator)}function MF(){return new lt(Y.comparator)}var EQ={asc:"ASCENDING",desc:"DESCENDING"},IQ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bQ={and:"AND",or:"OR"},mT=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function gT(n,e){return n.useProto3Json||Gh(e)?e:{value:e}}function Sl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eV(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function CQ(n,e){return Sl(n,e.toTimestamp())}function xt(n){return se(!!n),ae.fromTimestamp(function(t){let r=cs(t);return new mt(r.seconds,r.nanos)}(n))}function qS(n,e){return _T(n,e).canonicalString()}function _T(n,e){let t=function(i){return new Oe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function tV(n){let e=Oe.fromString(n);return se(uV(e)),e}function Oh(n,e){return qS(n.databaseId,e.path)}function Si(n,e){let t=tV(e);if(t.get(1)!==n.databaseId.projectId)throw new V(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Y(iV(t))}function nV(n,e){return qS(n.databaseId,e)}function rV(n){let e=tV(n);return e.length===4?Oe.emptyPath():iV(e)}function yT(n){return new Oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function iV(n){return se(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function OF(n,e,t){return{name:Oh(n,e),fields:t.value.mapValue.fields}}function sV(n,e,t){let r=Si(n,e.name),i=xt(e.updateTime),s=e.createTime?xt(e.createTime):ae.min(),o=new _n({mapValue:{fields:e.fields}}),a=Bt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function TQ(n,e){return"found"in e?function(r,i){se(!!i.found),i.found.name,i.found.updateTime;let s=Si(r,i.found.name),o=xt(i.found.updateTime),a=i.found.createTime?xt(i.found.createTime):ae.min(),c=new _n({mapValue:{fields:i.found.fields}});return Bt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){se(!!i.missing),se(!!i.readTime);let s=Si(r,i.missing),o=xt(i.readTime);return Bt.newNoDocument(s,o)}(n,e):ne()}function SQ(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ne()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(se(d===void 0||typeof d=="string"),Yt.fromBase64String(d||"")):(se(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Yt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?O.UNKNOWN:XL(l.code);return new V(d,l.message||"")}(o);t=new E_(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Si(n,r.document.name),s=xt(r.document.updateTime),o=r.document.createTime?xt(r.document.createTime):ae.min(),a=new _n({mapValue:{fields:r.document.fields}}),c=Bt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new vl(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Si(n,r.document),s=r.readTime?xt(r.readTime):ae.min(),o=Bt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new vl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Si(n,r.document),s=r.removedTargetIds||[];t=new vl([],s,i,null)}else{if(!("filter"in e))return ne();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new hT(i,s),a=r.targetId;t=new w_(a,o)}}return t}function Fh(n,e){let t;if(e instanceof uo)t={update:OF(n,e.key,e.value)};else if(e instanceof ho)t={delete:Oh(n,e.key)};else if(e instanceof Gr)t={update:OF(n,e.key,e.data),updateMask:PQ(e.fieldMask)};else{if(!(e instanceof Rh))return ne();t={verify:Oh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof co)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ls)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof us)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof lo)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ne()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:CQ(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ne()}(n,e.precondition)),t}function vT(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?Ct.updateTime(xt(s.updateTime)):s.exists!==void 0?Ct.exists(s.exists):Ct.none()}(e.currentDocument):Ct.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)se(a.setToServerValue==="REQUEST_TIME"),c=new co;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new ls(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new us(d)}else"increment"in a?c=new lo(o,a.increment):ne();let l=At.fromServerFormat(a.fieldPath);return new Aa(l,c)}(n,i)):[];if(e.update){e.update.name;let i=Si(n,e.update.name),s=new _n({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new ir(l.map(d=>At.fromServerFormat(d)))}(e.updateMask);return new Gr(i,s,o,t,r)}return new uo(i,s,t,r)}if(e.delete){let i=Si(n,e.delete);return new ho(i,t)}if(e.verify){let i=Si(n,e.verify);return new Rh(i,t)}return ne()}function DQ(n,e){return n&&n.length>0?(se(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?xt(i.updateTime):xt(s);return o.isEqual(ae.min())&&(o=xt(s)),new lT(o,i.transformResults||[])}(t,e))):[]}function oV(n,e){return{documents:[nV(n,e.path)]}}function GS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=nV(n,i);let s=function(l){if(l.length!==0)return lV(We.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(p){return{field:Xs(p.field),direction:RQ(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=gT(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function AQ(n,e,t,r){let{_t:i,parent:s}=GS(n,e),o={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;o[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Xs(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Xs(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function aV(n){let e=rV(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){se(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(h){let p=cV(h);return p instanceof We&&$S(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(E){return new Sa(pl(E.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Gh(p)?null:p}(t.limit));let c=null;t.startAt&&(c=function(h){let p=!!h.before,_=h.values||[];return new xi(_,p)}(t.startAt));let l=null;return t.endAt&&(l=function(h){let p=!h.before,_=h.values||[];return new xi(_,p)}(t.endAt)),ML(e,i,o,s,a,"F",c,l)}function xQ(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function cV(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=pl(t.unaryFilter.field);return ke.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=pl(t.unaryFilter.field);return ke.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=pl(t.unaryFilter.field);return ke.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=pl(t.unaryFilter.field);return ke.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ne()}}(n):n.fieldFilter!==void 0?function(t){return ke.create(pl(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ne()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return We.create(t.compositeFilter.filters.map(r=>cV(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ne()}}(t.compositeFilter.op))}(n):ne()}function RQ(n){return EQ[n]}function kQ(n){return IQ[n]}function NQ(n){return bQ[n]}function Xs(n){return{fieldPath:n.canonicalString()}}function pl(n){return At.fromServerFormat(n.fieldPath)}function lV(n){return n instanceof ke?function(t){if(t.op==="=="){if(yF(t.value))return{unaryFilter:{field:Xs(t.field),op:"IS_NAN"}};if(_F(t.value))return{unaryFilter:{field:Xs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yF(t.value))return{unaryFilter:{field:Xs(t.field),op:"IS_NOT_NAN"}};if(_F(t.value))return{unaryFilter:{field:Xs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xs(t.field),op:kQ(t.op),value:t.value}}}(n):n instanceof We?function(t){let r=t.getFilters().map(i=>lV(i));return r.length===1?r[0]:{compositeFilter:{op:NQ(t.op),filters:r}}}(n):ne()}function PQ(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function uV(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Dl=class n{constructor(e,t,r,i,s=ae.min(),o=ae.min(),a=Yt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var b_=class{constructor(e){this.ct=e}};function MQ(n,e){let t;if(e.document)t=sV(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=Y.fromSegments(e.noDocument.path),i=Ra(e.noDocument.readTime);t=Bt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ne();{let r=Y.fromSegments(e.unknownDocument.path),i=Ra(e.unknownDocument.version);t=Bt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new mt(i[0],i[1]);return ae.fromTimestamp(s)}(e.readTime)),t}function FF(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:C_(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Oh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Sl(s,o.version.toTimestamp()),createTime:Sl(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:xa(e.version)};else{if(!e.isUnknownDocument())return ne();r.unknownDocument={path:t.path.toArray(),version:xa(e.version)}}return r}function C_(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function xa(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ra(n){let e=new mt(n.seconds,n.nanoseconds);return ae.fromTimestamp(e)}function va(n,e){let t=(e.baseMutations||[]).map(s=>vT(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>vT(n.ct,s)),i=mt.fromMillis(e.localWriteTimeMs);return new kh(e.batchId,i,t,r)}function yh(n){let e=Ra(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ra(n.lastLimboFreeSnapshotVersion):ae.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return se(s.documents.length===1),kn(Vl(rV(s.documents[0])))}(n.query):function(s){return kn(aV(s))}(n.query),new Dl(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Yt.fromBase64String(n.resumeToken))}function dV(n,e){let t=xa(e.snapshotVersion),r=xa(e.lastLimboFreeSnapshotVersion),i;i=__(e.target)?oV(n.ct,e.target):GS(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Da(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function WS(n){let e=aV({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?v_(e,e.limit,"L"):e}function PC(n,e){return new Nh(e.largestBatchId,vT(n.ct,e.overlayMutation))}function LF(n,e){let t=e.path.lastSegment();return[n,Rn(e.path.popLast()),t]}function VF(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:xa(r.readTime),documentKey:Rn(r.documentKey.path),largestBatchId:r.largestBatchId}}var wT=class{getBundleMetadata(e,t){return UF(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ra(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return UF(e).put(function(i){return{bundleId:i.id,createTime:xa(xt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return BF(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:WS(s.bundledQuery),readTime:Ra(s.readTime)}}(r)})}saveNamedQuery(e,t){return BF(e).put(function(i){return{name:i.name,readTime:xa(xt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function UF(n){return Jt(n,"bundles")}function BF(n){return Jt(n,"namedQueries")}var T_=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return fh(e).get(LF(this.userId,t)).next(r=>r?PC(this.serializer,r):null)}getOverlays(e,t){let r=Ci();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Nh(t,o);i.push(this.ht(e,a))}),P.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(Rn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(fh(e).j("collectionPathOverlayIndex",a))}),P.waitFor(s)}getOverlaysForCollection(e,t,r){let i=Ci(),s=Rn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return fh(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=PC(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=Ci(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return fh(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let h=PC(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return fh(e).put(function(i,s,o){let[a,c,l]=LF(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Fh(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function fh(n){return Jt(n,"documentOverlays")}var os=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(bt(e.integerValue));else if("doubleValue"in e){let r=bt(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Th(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=cs(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(so(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?DL(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):ne()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),Y.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};os.bt=new os;function OQ(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function jF(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=OQ(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var ET=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ct(r.value),r=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Mt(r.value),r=t.next();this.xt()}Ot(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let t=this.Bt(e),r=jF(t);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){let t=this.Bt(e),r=jF(t);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},IT=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},bT=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},wa=class{constructor(){this.Gt=new ET,this.zt=new IT(this.Gt),this.jt=new bT(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Ea=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Ys(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=$F(n.arrayValue,e.arrayValue),t!==0?t:(t=$F(n.directionalValue,e.directionalValue),t!==0?t:Y.comparator(n.documentKey,e.documentKey)))}function $F(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var S_=class{constructor(e){this.Yt=new et((t,r)=>At.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let r=t;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(se(e.collectionGroup===this.collectionId),this.en)return!1;let t=zC(e);if(t!==void 0&&!this.nn(t))return!1;let r=_a(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new et(At.comparator),t=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new _l(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new _l(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new _l(r.field,r.dir==="asc"?0:1)));return new El(El.UNKNOWN_ID,this.collectionId,t,Ch.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function hV(n){var e,t;if(se(n instanceof ke||n instanceof We),n instanceof ke){if(n instanceof g_){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ke.create(n.field,"==",s)))||[];return We.create(i,"or")}return n}let r=n.filters.map(i=>hV(i));return We.create(r,n.op)}function FQ(n){if(n.getFilters().length===0)return[];let e=ST(hV(n));return se(fV(e)),CT(e)||TT(e)?[e]:e.getFilters()}function CT(n){return n instanceof ke}function TT(n){return n instanceof We&&$S(n)}function fV(n){return CT(n)||TT(n)||function(t){if(t instanceof We&&XC(t)){for(let r of t.getFilters())if(!CT(r)&&!TT(r))return!1;return!0}return!1}(n)}function ST(n){if(se(n instanceof ke||n instanceof We),n instanceof ke)return n;if(n.filters.length===1)return ST(n.filters[0]);let e=n.filters.map(r=>ST(r)),t=We.create(e,n.op);return t=D_(t),fV(t)?t:(se(t instanceof We),se(bl(t)),se(t.filters.length>1),t.filters.reduce((r,i)=>KS(r,i)))}function KS(n,e){let t;return se(n instanceof ke||n instanceof We),se(e instanceof ke||e instanceof We),t=n instanceof ke?e instanceof ke?function(i,s){return We.create([i,s],"and")}(n,e):HF(n,e):e instanceof ke?HF(e,n):function(i,s){if(se(i.filters.length>0&&s.filters.length>0),bl(i)&&bl(s))return kL(i,s.getFilters());let o=XC(i)?i:s,a=XC(i)?s:i,c=o.filters.map(l=>KS(l,a));return We.create(c,"or")}(n,e),D_(t)}function HF(n,e){if(bl(e))return kL(e,n.getFilters());{let t=e.filters.map(r=>KS(n,r));return We.create(t,"or")}}function D_(n){if(se(n instanceof ke||n instanceof We),n instanceof ke)return n;let e=n.getFilters();if(e.length===1)return D_(e[0]);if(xL(n))return n;let t=e.map(i=>D_(i)),r=[];return t.forEach(i=>{i instanceof ke?r.push(i):i instanceof We&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:We.create(r,n.op)}var DT=class{constructor(){this._n=new Lh}addToCollectionParentIndex(e,t){return this._n.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(br.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(br.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Lh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new et(Oe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new et(Oe.comparator)).toArray()}};var Xg=new Uint8Array(0),AT=class{constructor(e,t){this.databaseId=t,this.an=new Lh,this.un=new Ri(r=>Da(r),(r,i)=>Wh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:r,parent:Rn(i)};return zF(e).put(s)}return P.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[pL(t),""],!1,!0);return zF(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(bi(o.parent))}return r})}addFieldIndex(e,t){let r=ph(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=ul(e);return s.next(a=>{o.put(VF(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=ph(e),i=ul(e),s=ll(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=ph(e),r=ll(e),i=ul(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return P.forEach(this.cn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new S_(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=ll(e),i=!0,s=new Map;return P.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ve(),a=[];return P.forEach(s,(c,l)=>{B("IndexedDbIndexManager",`Using index ${function(H){return`id=${H.indexId}|cg=${H.collectionGroup}|f=${H.fields.map(ee=>`${ee.fieldPath}:${ee.kind}`).join(",")}`}(c)} to execute ${Da(t)}`);let d=function(H,ee){let fe=zC(ee);if(fe===void 0)return null;for(let re of y_(H,fe.fieldPath))switch(re.op){case"array-contains-any":return re.value.arrayValue.values||[];case"array-contains":return[re.value]}return null}(l,c),h=function(H,ee){let fe=new Map;for(let re of _a(ee))for(let S of y_(H,re.fieldPath))switch(S.op){case"==":case"in":fe.set(re.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return fe.set(re.fieldPath.canonicalString(),S.value),Array.from(fe.values())}return null}(l,c),p=function(H,ee){let fe=[],re=!0;for(let S of _a(ee)){let b=S.kind===0?bF(H,S.fieldPath,H.startAt):CF(H,S.fieldPath,H.startAt);fe.push(b.value),re&&(re=b.inclusive)}return new xi(fe,re)}(l,c),_=function(H,ee){let fe=[],re=!0;for(let S of _a(ee)){let b=S.kind===0?CF(H,S.fieldPath,H.endAt):bF(H,S.fieldPath,H.endAt);fe.push(b.value),re&&(re=b.inclusive)}return new xi(fe,re)}(l,c),E=this.hn(c,l,p),A=this.hn(c,l,_),R=this.Pn(c,l,h),U=this.In(c.indexId,d,E,p.inclusive,A,_.inclusive,R);return P.forEach(U,J=>r.G(J,t.limit).next(H=>{H.forEach(ee=>{let fe=Y.fromSegments(ee.documentKey);o.has(fe)||(o=o.add(fe),a.push(fe))})}))}).next(()=>a)}return P.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=FQ(We.create(e.filters,"and")).map(r=>aT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let h=0;h<c;++h){let p=t?this.Tn(t[h/l]):Xg,_=this.En(e,p,r[h%l],i),E=this.dn(e,p,s[h%l],o),A=a.map(R=>this.En(e,p,R,!0));d.push(...this.createRange(_,E,A))}return d}En(e,t,r,i){let s=new Ea(e,Y.empty(),t,r);return i?s:s.Jt()}dn(e,t,r,i){let s=new Ea(e,Y.empty(),t,r);return i?s.Jt():s}ln(e,t){let r=new S_(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return P.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new et(At.comparator),d=!1;for(let h of c.filters)for(let p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:l=l.add(p.field));for(let h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}An(e,t){let r=new wa;for(let i of _a(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);os.bt.Pt(s,o)}return r.Wt()}Tn(e){let t=new wa;return os.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let r=new wa;return os.bt.Pt(Ta(this.databaseId,t),r.Ht(function(s){let o=_a(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,t,r){if(r===null)return[];let i=[];i.push(new wa);let s=0;for(let o of _a(e)){let a=r[s++];for(let c of i)if(this.Vn(t,o.fieldPath)&&xh(a))i=this.mn(i,o,a);else{let l=c.Ht(o.kind);os.bt.Pt(a,l)}}return this.fn(i)}hn(e,t,r){return this.Pn(e,t,r.position)}fn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Wt();return t}mn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new wa;c.seed(a.Wt()),os.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(r=>r instanceof ke&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=ph(e),i=ul(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return P.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let p=h?new Ch(h.sequenceNumber,new br(Ra(h.readTime),new Y(bi(h.documentKey)),h.largestBatchId)):Ch.empty(),_=d.fields.map(([E,A])=>new _l(At.fromServerFormat(E),A));return new El(d.indexId,d.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:_e(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=ph(e),s=ul(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>P.forEach(a,c=>s.put(VF(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return P.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?P.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),P.forEach(a,c=>this.pn(e,i,c).next(l=>{let d=this.yn(s,c);return l.isEqual(d)?P.resolve():this.wn(e,s,c,l,d)}))))})}Sn(e,t,r,i){return ll(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,t.key),documentKey:t.key.path.toArray()})}bn(e,t,r,i){return ll(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,t.key),t.key.path.toArray()])}pn(e,t,r){let i=ll(e),s=new et(Ys);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,t)])},(o,a)=>{s=s.add(new Ea(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let r=new et(Ys),i=this.An(t,e);if(i==null)return r;let s=zC(t);if(s!=null){let o=e.data.field(s.fieldPath);if(xh(o))for(let a of o.arrayValue.values||[])r=r.add(new Ea(t.indexId,e.key,this.Tn(a),i))}else r=r.add(new Ea(t.indexId,e.key,Xg,i));return r}wn(e,t,r,i,s){B("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,h,p){let _=c.getIterator(),E=l.getIterator(),A=cl(_),R=cl(E);for(;A||R;){let U=!1,J=!1;if(A&&R){let H=d(A,R);H<0?J=!0:H>0&&(U=!0)}else A!=null?J=!0:U=!0;U?(h(R),R=cl(E)):J?(p(A),A=cl(_)):(A=cl(_),R=cl(E))}}(i,s,Ys,a=>{o.push(this.Sn(e,t,r,a))},a=>{o.push(this.bn(e,t,r,a))}),P.waitFor(o)}gn(e){let t=1;return ul(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Ys(o,a)).filter((o,a,c)=>!a||Ys(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Ys(o,e),c=Ys(o,t);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Xg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Xg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,t){return Ys(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(qF)}getMinOffset(e,t){return P.mapArray(this.cn(t),r=>this.ln(e,r).next(i=>i||ne())).next(qF)}};function zF(n){return Jt(n,"collectionParents")}function ll(n){return Jt(n,"indexEntries")}function ph(n){return Jt(n,"indexConfiguration")}function ul(n){return Jt(n,"indexState")}function qF(n){se(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;US(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new br(e.readTime,e.documentKey,t)}var GF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Er=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function pV(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,h,p)=>(a++,p.delete()));s.push(c.next(()=>{se(a===1)}));let l=[];for(let d of t.mutations){let h=wL(e,d.key.path,t.batchId);s.push(i.delete(h)),l.push(d.key)}return P.waitFor(s).next(()=>l)}function A_(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ne();e=n.noDocument}return JSON.stringify(e).length}Er.DEFAULT_COLLECTION_PERCENTILE=10,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Er.DEFAULT=new Er(41943040,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Er.DISABLED=new Er(-1,0,0);var x_=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,t,r,i){se(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Js(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=ml(e),o=Js(e);return o.add({}).next(a=>{se(typeof a=="number");let c=new kh(a,t,r,i),l=function(_,E,A){let R=A.baseMutations.map(J=>Fh(_.ct,J)),U=A.mutations.map(J=>Fh(_.ct,J));return{userId:E,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:R,mutations:U}}(this.serializer,this.userId,c),d=[],h=new et((p,_)=>_e(p.canonicalString(),_.canonicalString()));for(let p of i){let _=wL(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,jK))}return h.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),P.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return Js(e).get(t).next(r=>r?(se(r.userId===this.userId),va(this.serializer,r)):null)}vn(e,t){return this.Cn[t]?P.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Js(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(se(a.batchId>=r),s=va(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Js(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Js(e).U("userMutationsIndex",t).next(r=>r.map(i=>va(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=n_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return ml(e).J({range:i},(o,a,c)=>{let[l,d,h]=o,p=bi(d);if(l===this.userId&&t.path.isEqual(p))return Js(e).get(h).next(_=>{if(!_)throw ne();se(_.userId===this.userId),s.push(va(this.serializer,_))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new et(_e),i=[];return t.forEach(s=>{let o=n_(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=ml(e).J({range:a},(l,d,h)=>{let[p,_,E]=l,A=bi(_);p===this.userId&&s.path.isEqual(A)?r=r.add(E):h.done()});i.push(c)}),P.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=n_(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new et(_e);return ml(e).J({range:o},(c,l,d)=>{let[h,p,_]=c,E=bi(p);h===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(_)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(Js(e).get(s).next(o=>{if(o===null)throw ne();se(o.userId===this.userId),r.push(va(this.serializer,o))}))}),P.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return pV(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),P.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return P.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ml(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=bi(s[1]);i.push(c)}else a.done()}).next(()=>{se(i.length===0)})})}containsKey(e,t){return mV(e,this.userId,t)}xn(e){return gV(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function mV(n,e,t){let r=n_(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return ml(n).J({range:s,H:!0},(a,c,l)=>{let[d,h,p]=a;d===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Js(n){return Jt(n,"mutations")}function ml(n){return Jt(n,"documentMutations")}function gV(n){return Jt(n,"mutationQueues")}var Al=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var xT=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let r=new Al(t.highestTargetId);return t.highestTargetId=r.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>ae.fromTimestamp(new mt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(t,r),this.kn(e,r))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>dl(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(se(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return dl(e).J((o,a)=>{let c=yh(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>P.waitFor(s)).next(()=>i)}forEachTarget(e,t){return dl(e).J((r,i)=>{let s=yh(i);t(s)})}Bn(e){return WF(e).get("targetGlobalKey").next(t=>(se(t!==null),t))}kn(e,t){return WF(e).put("targetGlobalKey",t)}qn(e,t){return dl(e).put(dV(this.serializer,t))}Qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Da(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return dl(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=yh(a);Wh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Zs(e);return t.forEach(o=>{let a=Rn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),P.waitFor(i)}removeMatchingKeys(e,t,r){let i=Zs(e);return P.forEach(t,s=>{let o=Rn(s.path);return P.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Zs(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Zs(e),s=ve();return i.J({range:r,H:!0},(o,a,c)=>{let l=bi(o[1]),d=new Y(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=Rn(t.path),i=IDBKeyRange.bound([r],[pL(r)],!1,!0),s=0;return Zs(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return dl(e).get(t).next(r=>r?yh(r):null)}};function dl(n){return Jt(n,"targets")}function WF(n){return Jt(n,"targetGlobal")}function Zs(n){return Jt(n,"targetDocuments")}function KF([n,e],[t,r]){let i=_e(n,t);return i===0?_e(e,r):i}var RT=class{constructor(e){this.Kn=e,this.buffer=new et(KF),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();KF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},kT=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){B("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>g(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){mo(t)?B("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield po(t)}yield this.zn(3e5)}))}},NT=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(rr.oe);let r=new RT(t);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(GF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),GF):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),hl()<=Ee.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function LQ(n,e){return new NT(n,e)}var PT=class{constructor(e,t){this.db=e,this.garbageCollector=LQ(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Zn(e){let t=0;return this.Jn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(r,i)=>t(i))}addReference(e,t,r){return Zg(e,r)}removeReference(e,t,r){return Zg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Zg(e,t)}er(e,t){return function(i,s){let o=!1;return gV(i).Y(a=>mV(i,a,s).next(c=>(c&&(o=!0),P.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=t){let c=this.er(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ae.min()),Zs(e).delete(function(h){return[0,Rn(h.path)]}(o))))});i.push(c)}}).next(()=>P.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Zg(e,t)}Xn(e,t){let r=Zs(e),i,s=rr.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==rr.oe&&t(new Y(bi(i)),s),s=l,i=c):s=rr.oe}).next(()=>{s!==rr.oe&&t(new Y(bi(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Zg(n,e){return Zs(n).put(function(r,i){return{targetId:0,path:Rn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var R_=class{constructor(){this.changes=new Ri(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var MT=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ga(e).put(r)}removeEntry(e,t,r){return ga(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],C_(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.tr(e,r)))}getEntry(e,t){let r=Bt.newInvalidDocument(t);return ga(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(mh(t))},(i,s)=>{r=this.nr(t,s)}).next(()=>r)}rr(e,t){let r={size:0,document:Bt.newInvalidDocument(t)};return ga(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(mh(t))},(i,s)=>{r={document:this.nr(t,s),size:A_(s)}}).next(()=>r)}getEntries(e,t){let r=Qn();return this.ir(e,t,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,t){let r=Qn(),i=new lt(Y.comparator);return this.ir(e,t,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,A_(o))}).next(()=>({documents:r,_r:i}))}ir(e,t,r){if(t.isEmpty())return P.resolve();let i=new et(JF);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(mh(i.first()),mh(i.last())),o=i.getIterator(),a=o.getNext();return ga(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let h=Y.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&JF(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(mh(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),C_(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ga(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=Qn();for(let h of l){let p=this.nr(Y.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(Qh(t,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=Qn(),o=YF(t,r),a=YF(t,br.max());return ga(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let h=this.nr(Y.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new OT(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return QF(e).get("remoteDocumentGlobalKey").next(t=>(se(!!t),t))}tr(e,t){return QF(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let r=MQ(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ae.min())))return r}return Bt.newInvalidDocument(e)}};function _V(n){return new MT(n)}var OT=class extends R_{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Ri(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new et((s,o)=>_e(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=FF(this.ar.serializer,o);i=i.add(s.path.popLast());let l=A_(c);r+=l-a.size,t.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=FF(this.ar.serializer,o.convertToNoDocument(ae.min()));t.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,r)),P.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(r=>(this.ur.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function QF(n){return Jt(n,"remoteDocumentGlobal")}function ga(n){return Jt(n,"remoteDocumentsV14")}function mh(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function YF(n,e){let t=e.documentKey.path.toArray();return[n,C_(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function JF(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=_e(t[s],r[s]),i)return i;return i=_e(t.length,r.length),i||(i=_e(t[t.length-2],r[r.length-2]),i||_e(t[t.length-1],r[r.length-1]))}var FT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var k_=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Eh(r.mutation,i,ir.empty(),mt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ve()){let i=Ci();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=_h();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Ci();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ve()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Qn(),o=wh(),a=function(){return wh()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Gr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),Eh(d.mutation,l,d.mutation.getFieldMask(),mt.now())):o.set(l.key,ir.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new FT(d,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=wh(),i=new lt((o,a)=>o-a),s=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||ir.empty();d=a.applyToLocalView(l,d),r.set(c,d);let h=(i.get(a.batchId)||ve()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,h=jL();d.forEach(p=>{if(!s.has(p)){let _=QL(t.get(p),r.get(p));_!==null&&h.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return P.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):HS(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(Ci()),a=-1,c=s;return o.next(l=>P.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?P.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{c=c.insert(d,p)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ve())).next(d=>({batchId:a,changes:BL(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Y(t)).next(r=>{let i=_h();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=_h();return this.indexManager.getCollectionParents(e,s).next(a=>P.forEach(a,c=>{let l=function(h,p){return new qr(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Bt.newInvalidDocument(d)))});let a=_h();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&Eh(d.mutation,l,ir.empty(),mt.now()),Qh(t,l)&&(a=a.insert(c,l))}),a})}};var LT=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return P.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:xt(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:WS(i.bundledQuery),readTime:xt(i.readTime)}}(t)),P.resolve()}};var VT=class{constructor(){this.overlays=new lt(Y.comparator),this.hr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Ci();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=Ci(),s=t.length+1,o=new Y(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new lt((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=Ci(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=Ci(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return P.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Nh(t,r));let s=this.hr.get(t);s===void 0&&(s=ve(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Vh=class{constructor(){this.Pr=new et(Vt.Ir),this.Tr=new et(Vt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new Vt(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new Vt(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new Y(new Oe([])),r=new Vt(t,e),i=new Vt(t,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new Y(new Oe([])),r=new Vt(t,e),i=new Vt(t,e+1),s=ve();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Vt(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Vt=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return Y.comparator(e.key,t.key)||_e(e.pr,t.pr)}static Er(e,t){return _e(e.pr,t.pr)||Y.comparator(e.key,t.key)}};var UT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new et(Vt.Ir)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new kh(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Vt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,t){return P.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Vt(t,0),i=new Vt(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new et(_e);return t.forEach(i=>{let s=new Vt(i,0),o=new Vt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),P.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;Y.isDocumentKey(s)||(s=s.child(""));let o=new Vt(new Y(s),0),a=new et(_e);return this.wr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.pr)),!0)},o),P.resolve(this.Dr(a))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){se(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return P.forEach(t.mutations,i=>{let s=new Vt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new Vt(t,0),i=this.wr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var BT=class{constructor(e){this.vr=e,this.docs=function(){return new lt(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Bt.newInvalidDocument(t))}getEntries(e,t){let r=Qn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Bt.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Qn(),o=t.path,a=new Y(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||US(gL(d),r)<=0||(i.has(d.key)||Qh(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ne()}Fr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new jT(this)}getSize(e){return P.resolve(this.size)}},jT=class extends R_{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var $T=class{constructor(e){this.persistence=e,this.Mr=new Ri(t=>Da(t),Wh),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Vh,this.targetCount=0,this.Lr=Al.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),P.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new Al(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.qn(t),P.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Nr.containsKey(t))}};var N_=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new rr(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new $T(this),this.indexManager=new DT,this.remoteDocumentCache=function(i){return new BT(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new b_(t),this.$r=new LT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new UT(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){B("MemoryPersistence","Starting transaction:",e);let i=new HT(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return P.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},HT=class extends d_{constructor(e){super(),this.currentSequenceNumber=e}},P_=class n{constructor(e){this.persistence=e,this.zr=new Vh,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw ne()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),P.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Jr,r=>{let i=Y.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,ae.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return P.or([()=>P.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var zT=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new h_("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pF,{unique:!0}),c.createObjectStore("documentMutations")}(e),XF(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=P.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),XF(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ae.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pF,{unique:!0});let h=l.store("mutations"),p=d.map(_=>h.put(_));return P.waitFor(p)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:ZK});l.createIndex("collectionPathOverlayIndex",eQ,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",tQ,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:$K});l.createIndex("documentKeyIndex",HK),l.createIndex("collectionGroupIndex",zK)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:QK}).createIndex("sequenceNumberIndex",YK,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:JK}).createIndex("documentKeyIndex",XK,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=A_(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>P.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>P.forEach(a,c=>{se(c.userId===s.userId);let l=va(this.serializer,c);return pV(e,s.userId,l).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Oe(o),l=function(h){return[0,Rn(h)]}(c);s.push(t.get(l).next(d=>d?P.resolve():(h=>t.put({targetId:0,path:Rn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>P.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:KK});let r=t.store("collectionParents"),i=new Lh,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Rn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Oe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=bi(a);return s(d.popLast())}))}ri(e){let t=e.store("targets");return t.J((r,i)=>{let s=yh(i),o=dV(this.serializer,s);return t.put(o)})}ii(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(h){return h.document?new Y(Oe.fromString(h.document.name).popFirst(5)):h.noDocument?Y.fromSegments(h.noDocument.path):h.unknownDocument?Y.fromSegments(h.unknownDocument.path):ne()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>P.waitFor(i))}si(e,t){let r=t.store("mutations"),i=_V(this.serializer),s=new N_(P_.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ve();va(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),P.forEach(a,(c,l)=>{let d=new Ut(l),h=T_.lt(this.serializer,d),p=s.getIndexManager(d),_=x_.lt(d,this.serializer,p,s.referenceDelegate);return new k_(i,_,h,p).recalculateAndSaveOverlaysForDocumentKeys(new Sh(t,rr.oe),c).next()})})}};function XF(n){n.createObjectStore("targetDocuments",{keyPath:GK}).createIndex("documentTargetsIndex",WK,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",qK,{unique:!0}),n.createObjectStore("targetGlobal")}var MC="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",qT=class n{constructor(e,t,r,i,s,o,a,c,l,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=l,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=p=>Promise.resolve(),!n.D())throw new V(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new PT(this,i),this.Ti=t+"main",this.serializer=new b_(c),this.Ei=new io(this.Ti,this.ui,new zT(this.serializer)),this.Qr=new xT(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_V(this.serializer),this.$r=new wT,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&St("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new V(O.FAILED_PRECONDITION,MC);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new rr(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>g(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>g(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>g(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>e_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(mo(e))return B("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return B("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return gh(e).get("owner").next(t=>P.resolve(this.Si(t)))}bi(e){return e_(e).delete(this.clientId)}Di(){return g(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Jt(t,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return P.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?P.resolve(!0):gh(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new V(O.FAILED_PRECONDITION,MC);return!1}}return!(!this.networkEnabled||!this.inForeground)||e_(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&B("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return g(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Sh(e,rr.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(r=>this.Ci(r.updateTimeMs,t)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>e_(e).U().next(t=>this.vi(t,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return x_.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new AT(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return T_.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,r){B("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?rQ:c===15?CL:c===14?bL:c===13?IL:c===12?nQ:c===11?EL:void ne()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Sh(a,this.kr?this.kr.next():rr.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw St(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new V(O.FAILED_PRECONDITION,_L);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return gh(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new V(O.FAILED_PRECONDITION,MC)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gh(e).put("owner",t)}static D(){return io.D()}yi(e){let t=gh(e);return t.get("owner").next(r=>this.Si(r)?(B("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):P.resolve())}Ci(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(St(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;SI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let r=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return B("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return St("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){St("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function gh(n){return Jt(n,"owner")}function e_(n){return Jt(n,"clientMetadata")}function QS(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var GT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=ve(),i=ve();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var WT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var M_=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return SI()?8:yL(Ze())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new WT;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(hl()<=Ee.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",fl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),P.resolve()):(hl()<=Ee.DEBUG&&B("QueryEngine","Query:",fl(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(hl()<=Ee.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",fl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kn(t))):P.resolve())}ji(e,t){if(TF(t))return P.resolve(null);let r=kn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=v_(t,null,"F"),r=kn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ve(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Zi(t,a);return this.Xi(t,l,o,c.readTime)?this.ji(e,v_(t,null,"F")):this.es(e,l,t,c)}))})))}Hi(e,t,r,i){return TF(t)||i.isEqual(ae.min())?P.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,r,i)?P.resolve(null):(hl()<=Ee.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fl(t)),this.es(e,o,t,mL(i,-1)).next(a=>a))})}Zi(e,t){let r=new et(VL(e));return t.forEach((i,s)=>{Qh(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return hl()<=Ee.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",fl(t)),this.zi.getDocumentsMatchingQuery(e,t,br.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var KT=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new lt(_e),this.rs=new Ri(s=>Da(s),Wh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new k_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function yV(n,e,t,r){return new KT(n,e,t,r)}function vV(n,e){return g(this,null,function*(){let t=Q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ve();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function VQ(n,e){let t=Q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let h=l.batch,p=h.keys(),_=P.resolve();return p.forEach(E=>{_=_.next(()=>d.getEntry(c,E)).next(A=>{let R=l.docVersions.get(E);se(R!==null),A.version.compareTo(R)<0&&(h.applyToRemoteDocument(A,l),A.isValidDocument()&&(A.setReadTime(l.commitVersion),d.addEntry(A)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ve();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function wV(n){let e=Q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function UQ(n,e){let t=Q(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let a=[];e.targetChanges.forEach((d,h)=>{let p=i.get(h);if(!p)return;a.push(t.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>t.Qr.addMatchingKeys(s,d.addedDocuments,h)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?_=_.withResumeToken(Yt.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(h,_),function(A,R,U){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(p,_,d)&&a.push(t.Qr.updateTargetData(s,_))});let c=Qn(),l=ve();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(EV(s,o,e.documentUpdates).next(d=>{c=d.cs,l=d.ls})),!r.isEqual(ae.min())){let d=t.Qr.getLastRemoteSnapshotVersion(s).next(h=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return P.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.ns=i,s))}function EV(n,e,t){let r=ve(),i=ve();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Qn();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ae.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):B("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{cs:o,ls:i}})}function BQ(n,e){let t=Q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function xl(n,e){let t=Q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.Qr.allocateTargetId(r).next(o=>(i=new Dl(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function Rl(n,e,t){return g(this,null,function*(){let r=Q(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!mo(o))throw o;B("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function O_(n,e,t){let r=Q(n),i=ae.min(),s=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let h=Q(c),p=h.rs.get(d);return p!==void 0?P.resolve(h.ns.get(p)):h.Qr.getTargetData(l,d)}(r,o,kn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?i:ae.min(),t?s:ve())).next(a=>(CV(r,LL(e),a),{documents:a,hs:s})))}function IV(n,e){let t=Q(n),r=Q(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function bV(n,e){let t=Q(n),r=t.ss.get(e)||ae.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,mL(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(CV(t,e,i),i))}function CV(n,e,t){let r=n.ss.get(e)||ae.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}function jQ(n,e,t,r){return g(this,null,function*(){let i=Q(n),s=ve(),o=Qn();for(let l of t){let d=e.Ps(l.metadata.name);l.document&&(s=s.add(d));let h=e.Is(l);h.setReadTime(e.Ts(l.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield xl(i,function(d){return kn(Vl(Oe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>EV(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Qr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.cs,d.ls)).next(()=>d.cs)))})}function $Q(r,i){return g(this,arguments,function*(n,e,t=ve()){let s=yield xl(n,kn(WS(e.bundledQuery))),o=Q(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=xt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let l=s.withResumeToken(Yt.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(l.targetId,l),o.Qr.updateTargetData(a,l).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,t,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function ZF(n,e){return`firestore_clients_${n}_${e}`}function eL(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function OC(n,e){return`firestore_targets_${n}_${e}`}var F_=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Es(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new V(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(St("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ih=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Es(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new V(r.error.code,r.error.message))),s?new n(e,r.state,i):(St("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},L_=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=zS();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=vL(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(St("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},QT=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(St("SharedClientState",`Failed to parse online state: ${e}`),null)}},Uh=class{constructor(){this.activeTargetIds=zS()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},bh=class{constructor(e,t,r,i,s){this.window=e,this.oi=t,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new lt(_e),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=ZF(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Uh),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return g(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(ZF(this.persistenceKey,r));if(i){let s=L_.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let r=this.xs(t);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,r){this.Ls(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(OC(this.persistenceKey,e));if(r){let i=Ih.Es(e,r);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(OC(this.persistenceKey,e))}updateQueryState(e,t,r){this.qs(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return B("SharedClientState","READ",e,t),t}setItem(e,t){B("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){B("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(B("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void St("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>g(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let r=this.$s(t.key);return this.Us(r,null)}{let r=this.Ws(t.key,t.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let r=this.Gs(t.key,t.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(t.key===this.vs){if(t.newValue!==null){let r=this.xs(t.newValue);if(r)return this.Os(r)}}else if(t.key===this.Ss){let r=function(s){let o=rr.oe;if(s!=null)try{let a=JSON.parse(s);se(typeof a=="number"),o=a}catch(a){St("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==rr.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Fs){let r=this.Js(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,r){let i=new F_(this.currentUser,e,t,r),s=eL(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let t=eL(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,r){let i=OC(this.persistenceKey,e),s=new Ih(e,t,r);this.setItem(i,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let r=this.$s(e);return L_.Es(r,t)}Gs(e,t){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return F_.Es(new Ut(s),i,t)}js(e,t){let r=this.Cs.exec(e),i=Number(r[1]);return Ih.Es(i,t)}xs(e){return QT.Es(e)}Js(e){return JSON.parse(e)}zs(e){return g(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);B("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let r=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=zS();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},V_=class{constructor(){this.no=new Uh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Uh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var YT=class{io(e){}shutdown(){}};var U_=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){B("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){B("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var t_=null;function FC(){return t_===null?t_=function(){return 268435456+Math.round(2147483648*Math.random())}():t_++,"0x"+t_.toString(16)}var HQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var JT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var gn="WebChannelConnection",XT=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,o){let a=FC(),c=this.vo(t,r.toUriEncodedString());B("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(t,c,l,i).then(d=>(B("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Ir("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(t,r,i,s,o,a){return this.Co(t,r,i,s,o)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ll}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}vo(t,r){let i=HQ[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=FC();return new Promise((o,a)=>{let c=new DC;c.setWithCredentials(!0),c.listenOnce(xC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case hh.NO_ERROR:let d=c.getResponseJson();B(gn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case hh.TIMEOUT:B(gn,`RPC '${e}' ${s} timed out`),a(new V(O.DEADLINE_EXCEEDED,"Request time out"));break;case hh.HTTP_ERROR:let h=c.getStatus();if(B(gn,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let _=p?.error;if(_&&_.status&&_.message){let E=function(R){let U=R.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(U)>=0?U:O.UNKNOWN}(_.status);a(new V(E,_.message))}else a(new V(O.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new V(O.UNAVAILABLE,"Connection failed."));break;default:ne()}}finally{B(gn,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);B(gn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Oo(e,t,r){let i=FC(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=NC(),a=kC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new AC({})),this.Fo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");B(gn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),p=!1,_=!1,E=new JT({lo:R=>{_?B(gn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(B(gn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),B(gn,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},ho:()=>h.close()}),A=(R,U,J)=>{R.listen(U,H=>{try{J(H)}catch(ee){setTimeout(()=>{throw ee},0)}})};return A(h,al.EventType.OPEN,()=>{_||(B(gn,`RPC '${e}' stream ${i} transport opened.`),E.mo())}),A(h,al.EventType.CLOSE,()=>{_||(_=!0,B(gn,`RPC '${e}' stream ${i} transport closed`),E.po())}),A(h,al.EventType.ERROR,R=>{_||(_=!0,Ir(gn,`RPC '${e}' stream ${i} transport errored:`,R),E.po(new V(O.UNAVAILABLE,"The operation could not be completed")))}),A(h,al.EventType.MESSAGE,R=>{var U;if(!_){let J=R.data[0];se(!!J);let H=J,ee=H.error||((U=H[0])===null||U===void 0?void 0:U.error);if(ee){B(gn,`RPC '${e}' stream ${i} received error:`,ee);let fe=ee.status,re=function(C){let D=Lt[C];if(D!==void 0)return XL(D)}(fe),S=ee.message;re===void 0&&(re=O.INTERNAL,S="Unknown error status: "+fe+" with message "+ee.message),_=!0,E.po(new V(re,S)),h.close()}else B(gn,`RPC '${e}' stream ${i} received:`,J),E.yo(J)}}),A(a,RC.STAT_EVENT,R=>{R.stat===Jg.PROXY?B(gn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Jg.NOPROXY&&B(gn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.fo()},0),E}};function TV(){return typeof window<"u"?window:null}function o_(){return typeof document<"u"?document:null}function Yh(n){return new mT(n,!0)}var Bh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&B("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var B_=class{constructor(e,t,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Bh(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return g(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return g(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return g(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(St(t.toString()),St("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new V(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>g(this,null,function*(){this.state=0,this.start()}))}c_(e){return B("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(B("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ZT=class extends B_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=SQ(this.serializer,e),r=function(s){if(!("targetChange"in s))return ae.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ae.min():o.readTime?xt(o.readTime):ae.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=yT(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=__(c)?{documents:oV(s,c)}:{query:GS(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=eV(s,o.resumeToken);let l=gT(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(ae.min())>0){a.readTime=Sl(s,o.snapshotVersion.toTimestamp());let l=gT(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=xQ(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=yT(this.serializer),t.removeTarget=e,this.i_(t)}},eS=class extends B_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=DQ(e.writeResults,e.commitTime),r=xt(e.commitTime);return this.listener.A_(r,t)}return se(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=yT(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Fh(this.serializer,r))};this.i_(t)}};var tS=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new V(O.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,_T(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(O.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,_T(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(O.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},nS=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(St(t),this.y_=!1):B("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var rS=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>g(this,null,function*(){go(this)&&(B("RemoteStore","Restarting streams for network reachability change."),yield function(c){return g(this,null,function*(){let l=Q(c);l.M_.add(4),yield Ul(l),l.N_.set("Unknown"),l.M_.delete(4),yield Jh(l)})}(this))}))}),this.N_=new nS(r,i)}};function Jh(n){return g(this,null,function*(){if(go(n))for(let e of n.x_)yield e(!0)})}function Ul(n){return g(this,null,function*(){for(let e of n.x_)yield e(!1)})}function sy(n,e){let t=Q(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),XS(t)?JS(t):jl(t).Xo()&&YS(t,e))}function kl(n,e){let t=Q(n),r=jl(t);t.F_.delete(e),r.Xo()&&SV(t,e),t.F_.size===0&&(r.Xo()?r.n_():go(t)&&t.N_.set("Unknown"))}function YS(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jl(n).P_(e)}function SV(n,e){n.L_.xe(e),jl(n).I_(e)}function JS(n){n.L_=new pT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),jl(n).start(),n.N_.w_()}function XS(n){return go(n)&&!jl(n).Zo()&&n.F_.size>0}function go(n){return Q(n).M_.size===0}function DV(n){n.L_=void 0}function zQ(n){return g(this,null,function*(){n.N_.set("Online")})}function qQ(n){return g(this,null,function*(){n.F_.forEach((e,t)=>{YS(n,e)})})}function GQ(n,e){return g(this,null,function*(){DV(n),XS(n)?(n.N_.D_(e),JS(n)):n.N_.set("Unknown")})}function WQ(n,e,t){return g(this,null,function*(){if(n.N_.set("Online"),e instanceof E_&&e.state===2&&e.cause)try{yield function(i,s){return g(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(n,e)}catch(r){B("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield j_(n,r)}else if(e instanceof vl?n.L_.Ke(e):e instanceof w_?n.L_.He(e):n.L_.We(e),!t.isEqual(ae.min()))try{let r=yield wV(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(l);d&&s.F_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(Yt.EMPTY_BYTE_STRING,d.snapshotVersion)),SV(s,c);let h=new Dl(d.target,c,l,d.sequenceNumber);YS(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){B("RemoteStore","Failed to raise snapshot:",r),yield j_(n,r)}})}function j_(n,e,t){return g(this,null,function*(){if(!mo(e))throw e;n.M_.add(1),yield Ul(n),n.N_.set("Offline"),t||(t=()=>wV(n.localStore)),n.asyncQueue.enqueueRetryable(()=>g(this,null,function*(){B("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Jh(n)}))})}function AV(n,e){return e().catch(t=>j_(n,t,e))}function Bl(n){return g(this,null,function*(){let e=Q(n),t=fo(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;KQ(e);)try{let i=yield BQ(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,QQ(e,i)}catch(i){yield j_(e,i)}xV(e)&&RV(e)})}function KQ(n){return go(n)&&n.v_.length<10}function QQ(n,e){n.v_.push(e);let t=fo(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function xV(n){return go(n)&&!fo(n).Zo()&&n.v_.length>0}function RV(n){fo(n).start()}function YQ(n){return g(this,null,function*(){fo(n).V_()})}function JQ(n){return g(this,null,function*(){let e=fo(n);for(let t of n.v_)e.d_(t.mutations)})}function XQ(n,e,t){return g(this,null,function*(){let r=n.v_.shift(),i=uT.from(r,e,t);yield AV(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Bl(n)})}function ZQ(n,e){return g(this,null,function*(){e&&fo(n).E_&&(yield function(r,i){return g(this,null,function*(){if(function(o){return JL(o)&&o!==O.ABORTED}(i.code)){let s=r.v_.shift();fo(r).t_(),yield AV(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Bl(r)}})}(n,e)),xV(n)&&RV(n)})}function tL(n,e){return g(this,null,function*(){let t=Q(n);t.asyncQueue.verifyOperationInProgress(),B("RemoteStore","RemoteStore received new credentials");let r=go(t);t.M_.add(3),yield Ul(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Jh(t)})}function iS(n,e){return g(this,null,function*(){let t=Q(n);e?(t.M_.delete(2),yield Jh(t)):e||(t.M_.add(2),yield Ul(t),t.N_.set("Unknown"))})}function jl(n){return n.B_||(n.B_=function(t,r,i){let s=Q(t);return s.f_(),new ZT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:zQ.bind(null,n),To:qQ.bind(null,n),Ao:GQ.bind(null,n),h_:WQ.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.B_.t_(),XS(n)?JS(n):n.N_.set("Unknown")):(yield n.B_.stop(),DV(n))}))),n.B_}function fo(n){return n.k_||(n.k_=function(t,r,i){let s=Q(t);return s.f_(),new eS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:YQ.bind(null,n),Ao:ZQ.bind(null,n),R_:JQ.bind(null,n),A_:XQ.bind(null,n)}),n.x_.push(e=>g(this,null,function*(){e?(n.k_.t_(),yield Bl(n)):(yield n.k_.stop(),n.v_.length>0&&(B("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var sS=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function $l(n,e){if(St("AsyncQueue",`${e}: ${n}`),mo(n))return new V(O.UNAVAILABLE,`${e}: ${n}`);throw n}var $_=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Y.comparator(t.key,r.key):(t,r)=>Y.comparator(t.key,r.key),this.keyedMap=_h(),this.sortedSet=new lt(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var H_=class{constructor(){this.q_=new lt(Y.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):ne():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Nl=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,$_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var oS=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},aS=class{constructor(){this.queries=new Ri(e=>FL(e),Kh),this.onlineState="Unknown",this.z_=new Set}};function ZS(n,e){return g(this,null,function*(){let t=Q(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new oS,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=$l(o,`Initialization of query '${fl(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&tD(t)})}function eD(n,e){return g(this,null,function*(){let t=Q(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function eY(n,e){let t=Q(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&tD(t)}function tY(n,e,t){let r=Q(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function tD(n){n.z_.forEach(e=>{e.next()})}var cS,nL;(nL=cS||(cS={})).J_="default",nL.Cache="cache";var jh=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Nl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Nl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==cS.Cache}};var lS=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var z_=class{constructor(e){this.serializer=e}Ps(e){return Si(this.serializer,e)}Is(e){return e.metadata.exists?sV(this.serializer,e.document,!1):Bt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return xt(e)}},uS=class{constructor(e,t,r){this.oa=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kV(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let r=Oe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,r=new z_(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ve()).add(s);t.set(o,a)}}return t}complete(){return g(this,null,function*(){let e=yield jQ(this.localStore,new z_(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let r of this.queries)yield $Q(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function kV(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var q_=class{constructor(e){this.key=e}},G_=class{constructor(e){this.key=e}},W_=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ve(),this.mutatedKeys=ve(),this.Ia=VL(e),this.Ta=new $_(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new H_,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let p=i.get(d),_=Qh(this.query,h)?h:null,E=!!p&&this.mutatedKeys.has(p.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;p&&_?p.data.isEqual(_.data)?E!==A&&(r.track({type:3,doc:_}),R=!0):this.Ra(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Ia(_,c)>0||l&&this.Ia(_,l)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||l)&&(a=!0)),R&&(_?(o=o.add(_),s=A?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(_,E){let A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne()}};return A(_)-A(E)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=t&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new Nl(this.query,e.Ta,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new H_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=ve(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new G_(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new q_(r))}),t}pa(e){this.la=e.hs,this.Pa=ve();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Nl.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},dS=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},hS=class{constructor(e){this.key=e,this.wa=!1}},fS=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Ri(a=>FL(a),Kh),this.Da=new Map,this.Ca=new Set,this.va=new lt(Y.comparator),this.Fa=new Map,this.Ma=new Vh,this.xa={},this.Oa=new Map,this.Na=Al.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function nY(n,e,t=!0){return g(this,null,function*(){let r=oy(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield NV(r,e,t,!0),i})}function rY(n,e){return g(this,null,function*(){let t=oy(n);yield NV(t,e,!0,!1)})}function NV(n,e,t,r){return g(this,null,function*(){let i=yield xl(n.localStore,kn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield nD(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&sy(n.remoteStore,i),a})}function nD(n,e,t,r,i){return g(this,null,function*(){n.Ba=(h,p,_)=>function(A,R,U,J){return g(this,null,function*(){let H=R.view.da(U);H.Xi&&(H=yield O_(A.localStore,R.query,!1).then(({documents:S})=>R.view.da(S,H)));let ee=J&&J.targetChanges.get(R.targetId),fe=J&&J.targetMismatches.get(R.targetId)!=null,re=R.view.applyChanges(H,A.isPrimaryClient,ee,fe);return pS(A,R.targetId,re.fa),re.snapshot})}(n,h,p,_);let s=yield O_(n.localStore,e,!0),o=new W_(e,s.hs),a=o.da(s.documents),c=Mh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);pS(n,t,l.fa);let d=new dS(e,t,o);return n.ba.set(e,d),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),l.snapshot})}function iY(n,e,t){return g(this,null,function*(){let r=Q(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!Kh(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Rl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&kl(r.remoteStore,i.targetId),Pl(r,i.targetId)}).catch(po))):(Pl(r,i.targetId),yield Rl(r.localStore,i.targetId,!0))})}function sY(n,e){return g(this,null,function*(){let t=Q(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),kl(t.remoteStore,r.targetId))})}function oY(n,e,t){return g(this,null,function*(){let r=oD(n);try{let i=yield function(o,a){let c=Q(o),l=mt.now(),d=a.reduce((_,E)=>_.add(E.key),ve()),h,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=Qn(),A=ve();return c.os.getEntries(_,d).next(R=>{E=R,E.forEach((U,J)=>{J.isValidDocument()||(A=A.add(U))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,E)).next(R=>{h=R;let U=[];for(let J of a){let H=vQ(J,h.get(J.key).overlayedDocument);H!=null&&U.push(new Gr(J.key,H,AL(H.value.mapValue),Ct.exists(!0)))}return c.mutationQueue.addMutationBatch(_,l,U,a)}).next(R=>{p=R;let U=R.applyToLocalDocumentSet(h,A);return c.documentOverlayCache.saveOverlays(_,R.batchId,U)})}).then(()=>({batchId:p.batchId,changes:BL(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new lt(_e)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield hs(r,i.changes),yield Bl(r.remoteStore)}catch(i){let s=$l(i,"Failed to persist write");t.reject(s)}})}function PV(n,e){return g(this,null,function*(){let t=Q(n);try{let r=yield UQ(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Fa.get(s);o&&(se(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?se(o.wa):i.removedDocuments.size>0&&(se(o.wa),o.wa=!1))}),yield hs(t,r,e)}catch(r){yield po(r)}})}function rL(n,e,t){let r=Q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=Q(o);c.onlineState=a;let l=!1;c.queries.forEach((d,h)=>{for(let p of h.U_)p.j_(a)&&(l=!0)}),l&&tD(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function aY(n,e,t){return g(this,null,function*(){let r=Q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new lt(Y.comparator);o=o.insert(s,Bt.newNoDocument(s,ae.min()));let a=ve().add(s),c=new Ph(ae.min(),new Map,new lt(_e),o,a);yield PV(r,c),r.va=r.va.remove(s),r.Fa.delete(e),sD(r)}else yield Rl(r.localStore,e,!1).then(()=>Pl(r,e,t)).catch(po)})}function cY(n,e){return g(this,null,function*(){let t=Q(n),r=e.batch.batchId;try{let i=yield VQ(t.localStore,e);iD(t,r,null),rD(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield hs(t,i)}catch(i){yield po(i)}})}function lY(n,e,t){return g(this,null,function*(){let r=Q(n);try{let i=yield function(o,a){let c=Q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(se(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);iD(r,e,t),rD(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield hs(r,i)}catch(i){yield po(i)}})}function uY(n,e){return g(this,null,function*(){let t=Q(n);go(t.remoteStore)||B("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=Q(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Oa.get(r)||[];i.push(e),t.Oa.set(r,i)}catch(r){let i=$l(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function rD(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function iD(n,e,t){let r=Q(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Pl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||MV(n,r)})}function MV(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(kl(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),sD(n))}function pS(n,e,t){for(let r of t)r instanceof q_?(n.Ma.addReference(r.key,e),dY(n,r)):r instanceof G_?(B("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||MV(n,r.key)):ne()}function dY(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(B("SyncEngine","New document in limbo: "+t),n.Ca.add(r),sD(n))}function sD(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new Y(Oe.fromString(e)),r=n.Na.next();n.Fa.set(r,new hS(t)),n.va=n.va.insert(t,r),sy(n.remoteStore,new Dl(kn(Vl(t.path)),r,"TargetPurposeLimboResolution",rr.oe))}}function hs(n,e,t){return g(this,null,function*(){let r=Q(n),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let d=l&&!l.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);let d=GT.Ki(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,l){return g(this,null,function*(){let d=Q(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>P.forEach(l,p=>P.forEach(p.qi,_=>d.persistence.referenceDelegate.addReference(h,p.targetId,_)).next(()=>P.forEach(p.Qi,_=>d.persistence.referenceDelegate.removeReference(h,p.targetId,_)))))}catch(h){if(!mo(h))throw h;B("LocalStore","Failed to update sequence numbers: "+h)}for(let h of l){let p=h.targetId;if(!h.fromCache){let _=d.ns.get(p),E=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(E);d.ns=d.ns.insert(p,A)}}})}(r.localStore,s))})}function hY(n,e){return g(this,null,function*(){let t=Q(n);if(!t.currentUser.isEqual(e)){B("SyncEngine","User change. New user:",e.toKey());let r=yield vV(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new V(O.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield hs(t,r.us)}})}function fY(n,e){let t=Q(n),r=t.Fa.get(e);if(r&&r.wa)return ve().add(r.key);{let i=ve(),s=t.Da.get(e);if(!s)return i;for(let o of s){let a=t.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function pY(n,e){return g(this,null,function*(){let t=Q(n),r=yield O_(t.localStore,e.query,!0),i=e.view.pa(r);return t.isPrimaryClient&&pS(t,e.targetId,i.fa),i})}function mY(n,e){return g(this,null,function*(){let t=Q(n);return bV(t.localStore,e).then(r=>hs(t,r))})}function gY(n,e,t,r){return g(this,null,function*(){let i=Q(n),s=yield function(a,c){let l=Q(a),d=Q(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(p=>p?l.localDocuments.getDocuments(h,p):P.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Bl(i.remoteStore):t==="acknowledged"||t==="rejected"?(iD(i,e,r||null),rD(i,e),function(a,c){Q(Q(a).mutationQueue).Mn(c)}(i.localStore,e)):ne(),yield hs(i,s)):B("SyncEngine","Cannot apply mutation batch with id: "+e)})}function _Y(n,e){return g(this,null,function*(){let t=Q(n);if(oy(t),oD(t),e===!0&&t.La!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield iL(t,r.toArray());t.La=!0,yield iS(t.remoteStore,!0);for(let s of i)sy(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let r=[],i=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Pl(t,o),Rl(t.localStore,o,!0))),kl(t.remoteStore,o)}),yield i,yield iL(t,r),function(o){let a=Q(o);a.Fa.forEach((c,l)=>{kl(a.remoteStore,l)}),a.Ma.mr(),a.Fa=new Map,a.va=new lt(Y.comparator)}(t),t.La=!1,yield iS(t.remoteStore,!1)}})}function iL(n,e,t){return g(this,null,function*(){let r=Q(n),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield xl(r.localStore,kn(c[0]));for(let l of c){let d=r.ba.get(l),h=yield pY(r,d);h.snapshot&&s.push(h.snapshot)}}else{let l=yield IV(r.localStore,o);a=yield xl(r.localStore,l),yield nD(r,OV(l),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function OV(n){return ML(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function yY(n){return function(t){return Q(Q(t).persistence).Bi()}(Q(n).localStore)}function vY(n,e,t,r){return g(this,null,function*(){let i=Q(n);if(i.La)return void B("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield bV(i.localStore,LL(s[0])),a=Ph.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Yt.EMPTY_BYTE_STRING);yield hs(i,o,a);break}case"rejected":yield Rl(i.localStore,e,!0),Pl(i,e,r);break;default:ne()}})}function wY(n,e,t){return g(this,null,function*(){let r=oy(n);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){B("SyncEngine","Adding an already active target "+i);continue}let s=yield IV(r.localStore,i),o=yield xl(r.localStore,s);yield nD(r,OV(s),o.targetId,!1,o.resumeToken),sy(r.remoteStore,o)}for(let i of t)r.Da.has(i)&&(yield Rl(r.localStore,i,!1).then(()=>{kl(r.remoteStore,i),Pl(r,i)}).catch(po))}})}function oy(n){let e=Q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=PV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fY.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aY.bind(null,e),e.Sa.h_=eY.bind(null,e.eventManager),e.Sa.ka=tY.bind(null,e.eventManager),e}function oD(n){let e=Q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cY.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lY.bind(null,e),e}function EY(n,e,t){let r=Q(n);(function(s,o,a){return g(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(_,E){let A=Q(_),R=xt(E.createTime);return A.persistence.runTransaction("hasNewerBundle","readonly",U=>A.$r.getBundleMetadata(U,E.id)).then(U=>!!U&&U.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(kV(c));let l=new uS(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let p=yield l._a(d);p&&a._updateProgress(p),d=yield o.qa()}let h=yield l.complete();return yield hs(s,h.ca,void 0),yield function(_,E){let A=Q(_);return A.persistence.runTransaction("Save bundle","readwrite",R=>A.$r.saveBundleMetadata(R,E))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return Ir("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var $h=class{constructor(){this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){this.serializer=Yh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return yV(this.persistence,new M_,e.initialUser,this.serializer)}createPersistence(e){return new N_(P_.Hr,this.serializer)}createSharedClientState(e){return new V_}terminate(){return g(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var K_=class n extends $h{constructor(e,t,r){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return g(this,null,function*(){yield Xr(n.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield oD(this.Qa.syncEngine),yield Bl(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return yV(this.persistence,new M_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new kT(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new KC(t,this.persistence);return new WC(e.asyncQueue,r)}createPersistence(e){let t=QS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Er.withCacheSize(this.cacheSizeBytes):Er.DEFAULT;return new qT(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,TV(),o_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new V_}},mS=class n extends K_{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return g(this,null,function*(){yield Xr(n.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof bh&&(this.sharedClientState.syncEngine={Zs:gY.bind(null,t),Xs:vY.bind(null,t),eo:wY.bind(null,t),Bi:yY.bind(null,t),Ys:mY.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>g(this,null,function*(){yield _Y(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=TV();if(!bh.D(t))throw new V(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=QS(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bh(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Hh=class{initialize(e,t){return g(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>rL(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=hY.bind(null,this.syncEngine),yield iS(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new aS}()}createDatastore(e){let t=Yh(e.databaseInfo.databaseId),r=function(s){return new XT(s)}(e.databaseInfo);return function(s,o,a,c){return new tS(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new rS(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>rL(this.syncEngine,t,0),function(){return U_.D()?new U_:new YT}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let h=new fS(i,s,o,a,c,l);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return g(this,null,function*(){var e;yield function(r){return g(this,null,function*(){let i=Q(r);B("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Ul(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function sL(n,e=10240){let t=0;return{read(){return g(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return g(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Ml=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):St("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var gS=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Dt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return g(this,null,function*(){return this.metadata.promise})}qa(){return g(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return g(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),r=Number(t);isNaN(r)&&this.ja(`length string (${t}) is not valid number`);let i=yield this.Ha(r);return new lS(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return g(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return g(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return g(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var _S=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new V(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return g(this,null,function*(){let o=Q(i),a={documents:s.map(h=>Oh(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Oe.emptyPath(),a,s.length),l=new Map;c.forEach(h=>{let p=TQ(o.serializer,h);l.set(p.key.toString(),p)});let d=[];return s.forEach(h=>{let p=l.get(h.toString());se(!!p),d.push(p)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ho(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return g(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=Y.fromPath(r);this.mutations.push(new Rh(i,this.precondition(i)))}),yield function(r,i){return g(this,null,function*(){let s=Q(r),o={writes:i.map(a=>Fh(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Oe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ne();t=ae.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new V(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ae.min())?Ct.exists(!1):Ct.updateTime(t):Ct.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ae.min()))throw new V(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ct.updateTime(t)}return Ct.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var yS=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new Bh(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>g(this,null,function*(){let e=new _S(this.datastore),t=this.tu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let t=this.updateFunction(e);return!Gh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!JL(t)}return!1}};var vS=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ut.UNAUTHENTICATED,this.clientId=l_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>g(this,null,function*(){B("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(B("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new V(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=$l(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function a_(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),B("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>g(this,null,function*(){r.isEqual(i)||(yield vV(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function wS(n,e){return g(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield aD(n);B("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>tL(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>tL(e.remoteStore,i)),n._onlineComponents=e})}function FV(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function aD(n){return g(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B("FirestoreClient","Using user provided OfflineComponentProvider");try{yield a_(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!FV(t))throw t;Ir("Error using user provided cache. Falling back to memory cache: "+t),yield a_(n,new $h)}}else B("FirestoreClient","Using default OfflineComponentProvider"),yield a_(n,new $h);return n._offlineComponents})}function ay(n){return g(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(B("FirestoreClient","Using user provided OnlineComponentProvider"),yield wS(n,n._uninitializedComponentsProvider._online)):(B("FirestoreClient","Using default OnlineComponentProvider"),yield wS(n,new Hh))),n._onlineComponents})}function LV(n){return aD(n).then(e=>e.persistence)}function cD(n){return aD(n).then(e=>e.localStore)}function VV(n){return ay(n).then(e=>e.remoteStore)}function lD(n){return ay(n).then(e=>e.syncEngine)}function UV(n){return ay(n).then(e=>e.datastore)}function Ol(n){return g(this,null,function*(){let e=yield ay(n),t=e.eventManager;return t.onListen=nY.bind(null,e.syncEngine),t.onUnlisten=iY.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rY.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=sY.bind(null,e.syncEngine),t})}function IY(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield LV(n),t=yield VV(n);return e.setNetworkEnabled(!0),function(i){let s=Q(i);return s.M_.delete(0),Jh(s)}(t)}))}function bY(n){return n.asyncQueue.enqueue(()=>g(this,null,function*(){let e=yield LV(n),t=yield VV(n);return e.setNetworkEnabled(!1),function(i){return g(this,null,function*(){let s=Q(i);s.M_.add(0),yield Ul(s),s.N_.set("Offline")})}(t)}))}function CY(n,e){let t=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield function(l,d){let h=Q(l);return h.persistence.runTransaction("read document","readonly",p=>h.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new V(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=$l(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield cD(n),e,t)})),t.promise}function BV(n,e,t={}){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Ml({next:p=>{o.enqueueAndForget(()=>eD(s,h));let _=p.docs.has(a);!_&&p.fromCache?l.reject(new V(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?l.reject(new V(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new jh(Vl(a.path),d,{includeMetadataChanges:!0,ra:!0});return ZS(s,h)}(yield Ol(n),n.asyncQueue,e,t,r)})),r.promise}function TY(n,e){let t=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s,o){return g(this,null,function*(){try{let a=yield O_(i,s,!0),c=new W_(s,a.hs),l=c.da(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=$l(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield cD(n),e,t)})),t.promise}function jV(n,e,t={}){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(s,o,a,c,l){let d=new Ml({next:p=>{o.enqueueAndForget(()=>eD(s,h)),p.fromCache&&c.source==="server"?l.reject(new V(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),h=new jh(a,d,{includeMetadataChanges:!0,ra:!0});return ZS(s,h)}(yield Ol(n),n.asyncQueue,e,t,r)})),r.promise}function SY(n,e,t){let r=new Dt;return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){try{let i=yield UV(n);r.resolve(function(o,a,c){return g(this,null,function*(){var l;let d=Q(o),{request:h,ut:p,parent:_}=AQ(d.serializer,lQ(a),c);d.connection.Do||delete h.parent;let E=(yield d.xo("RunAggregationQuery",d.serializer.databaseId,_,h,1)).filter(R=>!!R.result);se(E.length===1);let A=(l=E[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(A).reduce((R,U)=>(R[p[U]]=A[U],R),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function DY(n,e){let t=new Ml(e);return n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){Q(i).z_.add(s),s.next()}(yield Ol(n),t)})),()=>{t.$a(),n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return function(i,s){Q(i).z_.delete(s)}(yield Ol(n),t)}))}}function AY(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?ZL().encode(o):o,function(d,h){return new gS(d,h)}(function(d,h){if(d instanceof Uint8Array)return sL(d,h);if(d instanceof ArrayBuffer)return sL(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Yh(e));n.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){EY(yield lD(n),i,r)}))}function xY(n,e){return n.asyncQueue.enqueue(()=>g(this,null,function*(){return function(r,i){let s=Q(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield cD(n),e)}))}function $V(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var oL=new Map;function uD(n,e,t){if(!t)throw new V(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function dD(n,e,t,r){if(e===!0&&r===!0)throw new V(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function aL(n){if(!Y.isDocumentKey(n))throw new V(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cL(n){if(Y.isDocumentKey(n))throw new V(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function cy(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ne()}function Ne(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=cy(n);throw new V(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function HV(n,e){if(e<=0)throw new V(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Q_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new V(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$V((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new V(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ka=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Q_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new V(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new V(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Q_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new LC;switch(r.type){case"firstParty":return new jC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=oL.get(t);r&&(B("ComponentProvider","Removing Datastore"),oL.delete(t),r.terminate())}(this),Promise.resolve()}};function zV(n,e,t,r={}){var i;let s=(n=Ne(n,ka))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ir("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Ut.MOCK_USER;else{a=Gc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new V(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ut(l)}n._authCredentials=new VC(new c_(a,c))}}var nn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},st=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Di(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Di=class n extends nn{constructor(e,t,r){super(e,t,Vl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new st(this.firestore,null,new Y(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Tr(n,e,...t){if(n=K(n),uD("collection","path",e),n instanceof ka){let r=Oe.fromString(e,...t);return cL(r),new Di(n,null,r)}{if(!(n instanceof st||n instanceof Di))throw new V(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Oe.fromString(e,...t));return cL(r),new Di(n.firestore,null,r)}}function qV(n,e){if(n=Ne(n,ka),uD("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new V(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new nn(n,null,function(r){return new qr(Oe.emptyPath(),r)}(e))}function Xh(n,e,...t){if(n=K(n),arguments.length===1&&(e=l_.newId()),uD("doc","path",e),n instanceof ka){let r=Oe.fromString(e,...t);return aL(r),new st(n,null,new Y(r))}{if(!(n instanceof st||n instanceof Di))throw new V(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Oe.fromString(e,...t));return aL(r),new st(n.firestore,n instanceof Di?n.converter:null,new Y(r))}}function hD(n,e){return n=K(n),e=K(e),(n instanceof st||n instanceof Di)&&(e instanceof st||e instanceof Di)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function fD(n,e){return n=K(n),e=K(e),n instanceof nn&&e instanceof nn&&n.firestore===e.firestore&&Kh(n._query,e._query)&&n.converter===e.converter}var ES=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Bh(this,"async_queue_retry"),this.hu=()=>{let t=o_();t&&B("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=o_();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=o_();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Dt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return g(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!mo(e))throw e;B("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw St("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=sS.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&ne()}verifyOperationInProgress(){}du(){return g(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function IS(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var bS=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var GV=-1,ut=class extends ka{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new ES}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||WV(this),this._firestoreClient.terminate()}};function jt(n){return n._firestoreClient||WV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function WV(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new QC(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,$V(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new vS(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function KV(n,e){r2(n=Ne(n,ut));let t=jt(n);if(t._uninitializedComponentsProvider)throw new V(O.FAILED_PRECONDITION,"SDK cache is already specified.");Ir("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Hh;return YV(t,i,new K_(i,r.cacheSizeBytes,e?.forceOwnership))}function QV(n){r2(n=Ne(n,ut));let e=jt(n);if(e._uninitializedComponentsProvider)throw new V(O.FAILED_PRECONDITION,"SDK cache is already specified.");Ir("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Hh;return YV(e,r,new mS(r,t.cacheSizeBytes))}function YV(n,e,t){let r=new Dt;return n.asyncQueue.enqueue(()=>g(this,null,function*(){try{yield a_(n,t),yield wS(n,e),r.resolve()}catch(i){let s=i;if(!FV(s))throw s;Ir("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function JV(n){if(n._initialized&&!n._terminated)throw new V(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Dt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>g(this,null,function*(){try{yield function(r){return g(this,null,function*(){if(!io.D())return Promise.resolve();let i=r+"main";yield io.delete(i)})}(QS(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function XV(n){return function(t){let r=new Dt;return t.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return uY(yield lD(t),r)})),r.promise}(jt(n=Ne(n,ut)))}function ZV(n){return IY(jt(n=Ne(n,ut)))}function e2(n){return bY(jt(n=Ne(n,ut)))}function t2(n,e){let t=jt(n=Ne(n,ut)),r=new bS;return AY(t,n._databaseId,e,r),r}function n2(n,e){return xY(jt(n=Ne(n,ut)),e).then(t=>t?new nn(n,null,t.query):null)}function r2(n){if(n._initialized||n._terminated)throw new V(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var CS=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},TS=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var ki=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Yt.fromBase64String(e))}catch(t){throw new V(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Yt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Wr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new At(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ds=class{constructor(e){this._methodName=e}};var Na=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return _e(this._lat,e._lat)||_e(this._long,e._long)}};var RY=/^__.*__$/,SS=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new uo(e,this.data,t,this.fieldTransforms)}},Y_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function i2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne()}}var J_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return X_(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(i2(this.fu)&&RY.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},DS=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Yh(e)}Fu(e,t,r,i=!1){return new J_({fu:e,methodName:t,vu:r,path:At.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Fa(n){let e=n._freezeSettings(),t=Yh(n._databaseId);return new DS(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ly(n,e,t,r,i,s={}){let o=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);gD("Data must be an object, but it was:",o,r);let a=a2(r,o),c,l;if(s.merge)c=new ir(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let p=NS(e,h,t);if(!o.contains(p))throw new V(O.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);l2(d,p)||d.push(p)}c=new ir(d),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new SS(new _n(a),c,l)}var zh=class n extends ds{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function s2(n,e,t){return new J_({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var AS=class n extends ds{_toFieldTransform(e){return new Aa(e.path,new co)}isEqual(e){return e instanceof n}},xS=class n extends ds{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=s2(this,e,!0),r=this.Mu.map(s=>La(s,t)),i=new ls(r);return new Aa(e.path,i)}isEqual(e){return e instanceof n&&Bs(this.Mu,e.Mu)}},RS=class n extends ds{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=s2(this,e,!0),r=this.Mu.map(s=>La(s,t)),i=new us(r);return new Aa(e.path,i)}isEqual(e){return e instanceof n&&Bs(this.Mu,e.Mu)}},kS=class n extends ds{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new lo(e.serializer,zL(e.serializer,this.xu));return new Aa(e.path,t)}isEqual(e){return e instanceof n&&this.xu===e.xu}};function pD(n,e,t,r){let i=n.Fu(1,e,t);gD("Data must be an object, but it was:",i,r);let s=[],o=_n.empty();Oa(r,(c,l)=>{let d=_D(e,c,t);l=K(l);let h=i.Su(d);if(l instanceof zh)s.push(d);else{let p=La(l,h);p!=null&&(s.push(d),o.set(d,p))}});let a=new ir(s);return new Y_(o,a,i.fieldTransforms)}function mD(n,e,t,r,i,s){let o=n.Fu(1,e,t),a=[NS(e,r,t)],c=[i];if(s.length%2!=0)throw new V(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(NS(e,s[p])),c.push(s[p+1]);let l=[],d=_n.empty();for(let p=a.length-1;p>=0;--p)if(!l2(l,a[p])){let _=a[p],E=c[p];E=K(E);let A=o.Su(_);if(E instanceof zh)l.push(_);else{let R=La(E,A);R!=null&&(l.push(_),d.set(_,R))}}let h=new ir(l);return new Y_(d,h,o.fieldTransforms)}function o2(n,e,t,r=!1){return La(t,n.Fu(r?4:3,e))}function La(n,e){if(c2(n=K(n)))return gD("Unsupported field value:",e,n),a2(n,e);if(n instanceof ds)return function(r,i){if(!i2(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=La(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=K(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return zL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=mt.fromDate(r);return{timestampValue:Sl(i.serializer,s)}}if(r instanceof mt){let s=new mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Sl(i.serializer,s)}}if(r instanceof Na)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ki)return{bytesValue:eV(i.serializer,r._byteString)};if(r instanceof st){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:qS(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${cy(r)}`)}(n,e)}function a2(n,e){let t={};return TL(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oa(n,(r,i)=>{let s=La(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function c2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof mt||n instanceof Na||n instanceof ki||n instanceof st||n instanceof ds)}function gD(n,e,t){if(!c2(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=cy(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function NS(n,e,t){if((e=K(e))instanceof Wr)return e._internalPath;if(typeof e=="string")return _D(n,e);throw X_("Field path arguments must be of type string or ",n,!1,void 0,t)}var kY=new RegExp("[~\\*/\\[\\]]");function _D(n,e,t){if(e.search(kY)>=0)throw X_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Wr(...e.split("."))._internalPath}catch{throw X_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function X_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new V(O.INVALID_ARGUMENT,a+n+c)}function l2(n,e){return n.some(t=>t.isEqual(e))}var Pa=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new st(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new PS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(uy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},PS=class extends Pa{data(){return super.data()}};function uy(n,e){return typeof e=="string"?_D(n,e):e instanceof Wr?e._internalPath:e._delegate._internalPath}function u2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new V(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var qh=class{},Ma=class extends qh{};function Yn(n,e,...t){let r=[];e instanceof qh&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof MS).length,a=s.filter(c=>c instanceof Z_).length;if(o>1||o>0&&a>0)throw new V(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Z_=class n extends Ma{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return v2(e._query,t),new nn(e.firestore,e.converter,cT(e._query,t))}_parse(e){let t=Fa(e.firestore);return function(s,o,a,c,l,d,h){let p;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new V(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){uL(h,d);let _=[];for(let E of h)_.push(lL(c,s,E));p={arrayValue:{values:_}}}else p=lL(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||uL(h,d),p=o2(a,o,h,d==="in"||d==="not-in");return ke.create(l,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Va(n,e,t){let r=e,i=uy("where",n);return Z_._create(i,r,t)}var MS=class n extends qh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)v2(o,c),o=cT(o,c)}(e._query,t),new nn(e.firestore,e.converter,cT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var OS=class n extends Ma{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new V(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new V(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Sa(s,o)}(e._query,this._field,this._direction);return new nn(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new qr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function d2(n,e="asc"){let t=e,r=uy("orderBy",n);return OS._create(r,t)}var ey=class n extends Ma{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new nn(e.firestore,e.converter,v_(e._query,this._limit,this._limitType))}};function h2(n){return HV("limit",n),ey._create("limit",n,"F")}function f2(n){return HV("limitToLast",n),ey._create("limitToLast",n,"L")}var ty=class n extends Ma{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=y2(e,this.type,this._docOrFields,this._inclusive);return new nn(e.firestore,e.converter,function(i,s){return new qr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function p2(...n){return ty._create("startAt",n,!0)}function m2(...n){return ty._create("startAfter",n,!1)}var ny=class n extends Ma{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=y2(e,this.type,this._docOrFields,this._inclusive);return new nn(e.firestore,e.converter,function(i,s){return new qr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function g2(...n){return ny._create("endBefore",n,!1)}function _2(...n){return ny._create("endAt",n,!0)}function y2(n,e,t,r){if(t[0]=K(t[0]),t[0]instanceof Pa)return function(s,o,a,c,l){if(!c)throw new V(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of yl(s))if(h.field.isKeyField())d.push(Ta(o,c.key));else{let p=c.data.field(h.field);if(iy(p))throw new V(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let _=h.field.canonicalString();throw new V(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(p)}return new xi(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Fa(n.firestore);return function(o,a,c,l,d,h){let p=o.explicitOrderBy;if(d.length>p.length)throw new V(O.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let _=[];for(let E=0;E<d.length;E++){let A=d[E];if(p[E].field.isKeyField()){if(typeof A!="string")throw new V(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof A}`);if(!HS(o)&&A.indexOf("/")!==-1)throw new V(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${A}' contains a slash.`);let R=o.path.child(Oe.fromString(A));if(!Y.isDocumentKey(R))throw new V(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let U=new Y(R);_.push(Ta(a,U))}else{let R=o2(c,l,A);_.push(R)}}return new xi(_,h)}(n._query,n.firestore._databaseId,i,e,t,r)}}function lL(n,e,t){if(typeof(t=K(t))=="string"){if(t==="")throw new V(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HS(e)&&t.indexOf("/")!==-1)throw new V(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Oe.fromString(t));if(!Y.isDocumentKey(r))throw new V(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ta(n,new Y(r))}if(t instanceof st)return Ta(n,t._key);throw new V(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cy(t)}.`)}function uL(n,e){if(!Array.isArray(n)||n.length===0)throw new V(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function v2(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new V(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Fl=class{convertValue(e,t="none"){switch(Ca(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(so(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ne()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Oa(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Na(bt(e.latitude),bt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=jS(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Dh(e));default:return null}}convertTimestamp(e){let t=cs(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Oe.fromString(e);se(uV(r));let i=new oo(r.get(1),r.get(3)),s=new Y(r.popFirst(5));return i.isEqual(t)||St(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function dy(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var FS=class extends Fl{constructor(e){super(),this.firestore=e}convertBytes(e){return new ki(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new st(this.firestore,null,t)}};function NY(){return new CS("count")}var as=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Cr=class extends Pa{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new no(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(uy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},no=class extends Cr{data(e={}){return super.data(e)}},Kr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new as(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new no(this._firestore,this._userDataWriter,r.key,r,new as(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new no(i._firestore,i._userDataWriter,a.doc.key,a.doc,new as(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new no(i._firestore,i._userDataWriter,a.doc.key,a.doc,new as(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:PY(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function PY(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne()}}function yD(n,e){return n instanceof Cr&&e instanceof Cr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Kr&&e instanceof Kr&&n._firestore===e._firestore&&fD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function w2(n){n=Ne(n,st);let e=Ne(n.firestore,ut);return BV(jt(e),n._key).then(t=>ED(e,n,t))}var Ni=class extends Fl{constructor(e){super(),this.firestore=e}convertBytes(e){return new ki(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new st(this.firestore,null,t)}};function E2(n){n=Ne(n,st);let e=Ne(n.firestore,ut),t=jt(e),r=new Ni(e);return CY(t,n._key).then(i=>new Cr(e,r,n._key,i,new as(i!==null&&i.hasLocalMutations,!0),n.converter))}function I2(n){n=Ne(n,st);let e=Ne(n.firestore,ut);return BV(jt(e),n._key,{source:"server"}).then(t=>ED(e,n,t))}function b2(n){n=Ne(n,nn);let e=Ne(n.firestore,ut),t=jt(e),r=new Ni(e);return u2(n._query),jV(t,n._query).then(i=>new Kr(e,r,n,i))}function C2(n){n=Ne(n,nn);let e=Ne(n.firestore,ut),t=jt(e),r=new Ni(e);return TY(t,n._query).then(i=>new Kr(e,r,n,i))}function T2(n){n=Ne(n,nn);let e=Ne(n.firestore,ut),t=jt(e),r=new Ni(e);return jV(t,n._query,{source:"server"}).then(i=>new Kr(e,r,n,i))}function vD(n,e,t){n=Ne(n,st);let r=Ne(n.firestore,ut),i=dy(n.converter,e,t);return Hl(r,[ly(Fa(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ct.none())])}function wD(n,e,t,...r){n=Ne(n,st);let i=Ne(n.firestore,ut),s=Fa(i),o;return o=typeof(e=K(e))=="string"||e instanceof Wr?mD(s,"updateDoc",n._key,e,t,r):pD(s,"updateDoc",n._key,e),Hl(i,[o.toMutation(n._key,Ct.exists(!0))])}function S2(n){return Hl(Ne(n.firestore,ut),[new ho(n._key,Ct.none())])}function D2(n,e){let t=Ne(n.firestore,ut),r=Xh(n),i=dy(n.converter,e);return Hl(t,[ly(Fa(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ct.exists(!1))]).then(()=>r)}function Zh(n,...e){var t,r,i;n=K(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||IS(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(IS(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,d;if(n instanceof st)l=Ne(n.firestore,ut),d=Vl(n._key.path),c={next:h=>{e[o]&&e[o](ED(l,n,h))},error:e[o+1],complete:e[o+2]};else{let h=Ne(n,nn);l=Ne(h.firestore,ut),d=h._query;let p=new Ni(l);c={next:_=>{e[o]&&e[o](new Kr(l,p,h,_))},error:e[o+1],complete:e[o+2]},u2(n._query)}return function(p,_,E,A){let R=new Ml(A),U=new jh(_,R,E);return p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return ZS(yield Ol(p),U)})),()=>{R.$a(),p.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return eD(yield Ol(p),U)}))}}(jt(l),d,a,c)}function A2(n,e){return DY(jt(n=Ne(n,ut)),IS(e)?e:{next:e})}function Hl(n,e){return function(r,i){let s=new Dt;return r.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){return oY(yield lD(r),i,s)})),s.promise}(jt(n),e)}function ED(n,e,t){let r=t.docs.get(e._key),i=new Ni(n);return new Cr(n,i,e._key,r,new as(t.hasPendingWrites,t.fromCache),e.converter)}function Ua(n){return MY(n,{count:NY()})}function MY(n,e){let t=Ne(n.firestore,ut),r=jt(t),i=iQ(e,(s,o)=>new dT(o,s.aggregateType,s._internalFieldPath));return SY(r,n._query,i).then(s=>function(a,c,l){let d=new Ni(a);return new TS(c,d,l)}(t,n,s))}var OY={maxAttempts:5};var ry=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fa(e)}set(e,t,r){this._verifyNotCommitted();let i=eo(e,this._firestore),s=dy(i.converter,t,r),o=ly(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ct.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=eo(e,this._firestore),o;return o=typeof(t=K(t))=="string"||t instanceof Wr?mD(this._dataReader,"WriteBatch.update",s._key,t,r,i):pD(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Ct.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=eo(e,this._firestore);return this._mutations=this._mutations.concat(new ho(t._key,Ct.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new V(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function eo(n,e){if((n=K(n)).firestore!==e)throw new V(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var LS=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Fa(t)}get(t){let r=eo(t,this._firestore),i=new FS(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return ne();let o=s[0];if(o.isFoundDocument())return new Pa(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Pa(this._firestore,i,r._key,null,r.converter);throw ne()})}set(t,r,i){let s=eo(t,this._firestore),o=dy(s.converter,r,i),a=ly(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=eo(t,this._firestore),a;return a=typeof(r=K(r))=="string"||r instanceof Wr?mD(this._dataReader,"Transaction.update",o._key,r,i,s):pD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=eo(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=eo(e,this._firestore),r=new Ni(this._firestore);return super.get(e).then(i=>new Cr(this._firestore,r,t._key,i._document,new as(!1,!1),t.converter))}};function x2(n,e,t){n=Ne(n,ut);let r=Object.assign(Object.assign({},OY),t);return function(s){if(s.maxAttempts<1)throw new V(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Dt;return s.asyncQueue.enqueueAndForget(()=>g(this,null,function*(){let l=yield UV(s);new yS(s.asyncQueue,l,a,o,c).Xa()})),c.promise}(jt(n),i=>e(new LS(n,i)),r)}function R2(){return new zh("deleteField")}function k2(){return new AS("serverTimestamp")}function N2(...n){return new xS("arrayUnion",n)}function P2(...n){return new RS("arrayRemove",n)}function M2(n){return new kS("increment",n)}(function(e,t=!0){(function(i){Ll=i})(xn),An(new Ye("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ut(new UC(r.getProvider("auth-internal")),new HC(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new V(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Tt(dF,"4.6.3",e),Tt(dF,"4.6.3","esm2017")})();var FY="@firebase/firestore-compat",LY="0.3.32";function DD(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new V("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function O2(){if(typeof Uint8Array>"u")throw new V("unimplemented","Uint8Arrays are not available in this environment.")}function F2(){if(!SL())throw new V("unimplemented","Blobs are unavailable in Firestore in this environment.")}var hy=class n{constructor(e){this._delegate=e}static fromBase64String(e){return F2(),new n(ki.fromBase64String(e))}static fromUint8Array(e){return O2(),new n(ki.fromUint8Array(e))}toBase64(){return F2(),this._delegate.toBase64()}toUint8Array(){return O2(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function ID(n){return VY(n,["next","error","complete"])}function VY(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var bD=class{enableIndexedDbPersistence(e,t){return KV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return QV(e._delegate)}clearIndexedDbPersistence(e){return JV(e._delegate)}},fy=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof oo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ir("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){zV(this._delegate,e,t,r)}enableNetwork(){return ZV(this._delegate)}disableNetwork(){return e2(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,dD("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return XV(this._delegate)}onSnapshotsInSync(e){return A2(this._delegate,e)}get app(){if(!this._appCompat)throw new V("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Gl(this,Tr(this._delegate,e))}catch(t){throw Nn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Pi(this,Xh(this._delegate,e))}catch(t){throw Nn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ha(this,qV(this._delegate,e))}catch(t){throw Nn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return x2(this._delegate,t=>e(new py(this,t)))}batch(){return jt(this._delegate),new my(new ry(this._delegate,e=>Hl(this._delegate,e)))}loadBundle(e){return t2(this._delegate,e)}namedQuery(e){return n2(this._delegate,e).then(t=>t?new Ha(this,t):null)}},zl=class extends Fl{constructor(e){super(),this.firestore=e}convertBytes(e){return new hy(new ki(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Pi.forKey(t,this.firestore,null)}};function UY(n){hL(n)}var py=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new zl(e)}get(e){let t=Ba(e);return this._delegate.get(t).then(r=>new ja(this._firestore,new Cr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Ba(e);return r?(DD("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Ba(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Ba(e);return this._delegate.delete(t),this}},my=class{constructor(e){this._delegate=e}set(e,t,r){let i=Ba(e);return r?(DD("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Ba(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Ba(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},ql=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new no(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new $a(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new zl(e),t),i.set(t,s)),s}};ql.INSTANCES=new WeakMap;var Pi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new zl(e)}static forPath(e,t,r){if(e.length%2!==0)throw new V("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new st(t._delegate,r,new Y(e)))}static forKey(e,t,r){return new n(t,new st(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Gl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Gl(this.firestore,Tr(this._delegate,e))}catch(t){throw Nn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=K(e),e instanceof st?hD(this._delegate,e):!1}set(e,t){t=DD("DocumentReference.set",t);try{return t?vD(this._delegate,e,t):vD(this._delegate,e)}catch(r){throw Nn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?wD(this._delegate,e):wD(this._delegate,e,t,...r)}catch(i){throw Nn(i,"updateDoc()","DocumentReference.update()")}}delete(){return S2(this._delegate)}onSnapshot(...e){let t=L2(e),r=V2(e,i=>new ja(this.firestore,new Cr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Zh(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=E2(this._delegate):e?.source==="server"?t=I2(this._delegate):t=w2(this._delegate),t.then(r=>new ja(this.firestore,new Cr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(ql.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Nn(n,e,t){return n.message=n.message.replace(e,t),n}function L2(n){for(let e of n)if(typeof e=="object"&&!ID(e))return e;return{}}function V2(n,e){var t,r;let i;return ID(n[0])?i=n[0]:ID(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ja=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Pi(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return yD(this._delegate,e._delegate)}},$a=class extends ja{data(e){let t=this._delegate.data(e);return this._delegate._converter||fL(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Ha=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new zl(e)}where(e,t,r){try{return new n(this.firestore,Yn(this._delegate,Va(e,t,r)))}catch(i){throw Nn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Yn(this._delegate,d2(e,t)))}catch(r){throw Nn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Yn(this._delegate,h2(e)))}catch(t){throw Nn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Yn(this._delegate,f2(e)))}catch(t){throw Nn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Yn(this._delegate,p2(...e)))}catch(t){throw Nn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Yn(this._delegate,m2(...e)))}catch(t){throw Nn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Yn(this._delegate,g2(...e)))}catch(t){throw Nn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Yn(this._delegate,_2(...e)))}catch(t){throw Nn(t,"endAt()","Query.endAt()")}}isEqual(e){return fD(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=C2(this._delegate):e?.source==="server"?t=T2(this._delegate):t=b2(this._delegate),t.then(r=>new ef(this.firestore,new Kr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=L2(e),r=V2(e,i=>new ef(this.firestore,new Kr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Zh(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(ql.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},CD=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new $a(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},ef=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ha(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new $a(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new CD(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new $a(this._firestore,r))})}isEqual(e){return yD(this._delegate,e._delegate)}},Gl=class n extends Ha{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Pi(this.firestore,e):null}doc(e){try{return e===void 0?new Pi(this.firestore,Xh(this._delegate)):new Pi(this.firestore,Xh(this._delegate,e))}catch(t){throw Nn(t,"doc()","CollectionReference.doc()")}}add(e){return D2(this._delegate,e).then(t=>new Pi(this.firestore,t))}isEqual(e){return hD(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(ql.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ba(n){return Ne(n,st)}var TD=class n{constructor(...e){this._delegate=new Wr(...e)}static documentId(){return new n(At.keyField().canonicalString())}isEqual(e){return e=K(e),e instanceof Wr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var SD=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=k2();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=R2();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=N2(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=P2(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=M2(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var BY={Firestore:fy,GeoPoint:Na,Timestamp:mt,Blob:hy,Transaction:py,WriteBatch:my,DocumentReference:Pi,DocumentSnapshot:ja,Query:Ha,QueryDocumentSnapshot:$a,QuerySnapshot:ef,CollectionReference:Gl,FieldPath:TD,FieldValue:SD,setLogLevel:UY,CACHE_SIZE_UNLIMITED:GV};function jY(n,e){n.INTERNAL.registerComponent(new Ye("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},BY)))}function $Y(n){jY(n,(e,t)=>new fy(e,t,new bD)),n.registerVersion(FY,LY)}$Y(L);var W2="firebasestorage.googleapis.com",K2="storageBucket",HY=2*60*1e3,zY=10*60*1e3,qY=1e3;var gt=class n extends wt{constructor(e,t,r=0){super(AD(e),`Firebase Storage: ${t} (${AD(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return AD(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},dt=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(dt||{});function AD(n){return"storage/"+n}function FD(){let n="An unknown error occurred, please check the error payload for server response.";return new gt(dt.UNKNOWN,n)}function GY(n){return new gt(dt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function WY(n){return new gt(dt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function KY(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gt(dt.UNAUTHENTICATED,n)}function QY(){return new gt(dt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function YY(n){return new gt(dt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Q2(){return new gt(dt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Y2(){return new gt(dt.CANCELED,"User canceled the upload/download.")}function JY(n){return new gt(dt.INVALID_URL,"Invalid URL '"+n+"'.")}function XY(n){return new gt(dt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function ZY(){return new gt(dt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+K2+"' property when initializing the app?")}function J2(){return new gt(dt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function eJ(){return new gt(dt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function tJ(){return new gt(dt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function nJ(n){return new gt(dt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function za(n){return new gt(dt.INVALID_ARGUMENT,n)}function X2(){return new gt(dt.APP_DELETED,"The Firebase app was deleted.")}function LD(n){return new gt(dt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function nf(n,e){return new gt(dt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function tf(n){throw new gt(dt.INTERNAL_ERROR,"Internal error: "+n)}var Pn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw XY(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(ee){ee.path.charAt(ee.path.length-1)==="/"&&(ee.path_=ee.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(ee){ee.path_=decodeURIComponent(ee.path)}let d="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${h}/${d}/b/${i}/o${p}`,"i"),E={bucket:1,path:3},A=t===W2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",U=new RegExp(`^https?://${A}/${i}/${R}`,"i"),H=[{regex:a,indices:c,postModify:s},{regex:_,indices:E,postModify:l},{regex:U,indices:{bucket:1,path:2},postModify:l}];for(let ee=0;ee<H.length;ee++){let fe=H[ee],re=fe.regex.exec(e);if(re){let S=re[fe.indices.bucket],b=re[fe.indices.path];b||(b=""),r=new n(S,b),fe.postModify(r);break}}if(r==null)throw JY(e);return r}},RD=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function rJ(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...R){l||(l=!0,e.apply(null,R))}function h(R){i=setTimeout(()=>{i=null,n(_,c())},R)}function p(){s&&clearTimeout(s)}function _(R,...U){if(l){p();return}if(R){p(),d.call(null,R,...U);return}if(c()||o){p(),d.call(null,R,...U);return}r<64&&(r*=2);let H;a===1?(a=2,H=0):H=(r+Math.random())*1e3,h(H)}let E=!1;function A(R){E||(E=!0,p(),!l&&(i!==null?(R||(a=2),clearTimeout(i),h(0)):R||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,A(!0)},t),A}function iJ(n){n(!1)}function sJ(n){return n!==void 0}function oJ(n){return typeof n=="function"}function aJ(n){return typeof n=="object"&&!Array.isArray(n)}function yy(n){return typeof n=="string"||n instanceof String}function U2(n){return VD()&&n instanceof Blob}function VD(){return typeof Blob<"u"}function kD(n,e,t,r){if(r<e)throw za(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw za(`Invalid value for '${n}'. Expected ${t} or less.`)}function _o(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Z2(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Ql=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Ql||{});function eU(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var ND=class{constructor(e,t,r,i,s,o,a,c,l,d,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,E)=>{this.resolve_=_,this.reject_=E,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Kl(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Ql.NO_ERROR,c=s.getStatus();if(!a||eU(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Ql.ABORT;r(!1,new Kl(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Kl(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());sJ(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=FD();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?X2():Y2();o(c)}else{let c=Q2();o(c)}};this.canceled_?t(!1,new Kl(!1,null,!0)):this.backoffId_=rJ(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&iJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Kl=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function cJ(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function lJ(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function uJ(n,e){e&&(n["X-Firebase-GMPID"]=e)}function dJ(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function hJ(n,e,t,r,i,s,o=!0){let a=Z2(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return uJ(l,e),cJ(l,t),lJ(l,s),dJ(l,r),new ND(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function fJ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function pJ(...n){let e=fJ();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(VD())return new Blob(n);throw new gt(dt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function mJ(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function gJ(n){if(typeof atob>"u")throw nJ("base-64");return atob(n)}var sr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},rf=class{constructor(e,t){this.data=e,this.contentType=t||null}};function UD(n,e){switch(n){case sr.RAW:return new rf(tU(e));case sr.BASE64:case sr.BASE64URL:return new rf(nU(n,e));case sr.DATA_URL:return new rf(yJ(e),vJ(e))}throw FD()}function tU(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function _J(n){let e;try{e=decodeURIComponent(n)}catch{throw nf(sr.DATA_URL,"Malformed data URL.")}return tU(e)}function nU(n,e){switch(n){case sr.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw nf(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case sr.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw nf(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=gJ(e)}catch(i){throw i.message.includes("polyfill")?i:nf(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var _y=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw nf(sr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=wJ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function yJ(n){let e=new _y(n);return e.base64?nU(sr.BASE64,e.rest):_J(e.rest)}function vJ(n){return new _y(n).contentType}function wJ(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Yl=class n{constructor(e,t){let r=0,i="";U2(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(U2(this.data_)){let r=this.data_,i=mJ(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(VD()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(pJ.apply(null,t))}else{let t=e.map(o=>yy(o)?UD(sr.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function BD(n){let e;try{e=JSON.parse(n)}catch{return null}return aJ(e)?e:null}function EJ(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function IJ(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function rU(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function bJ(n,e){return e}var rn=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||bJ}},gy=null;function CJ(n){return!yy(n)||n.length<2?n:rU(n)}function vy(){if(gy)return gy;let n=[];n.push(new rn("bucket")),n.push(new rn("generation")),n.push(new rn("metageneration")),n.push(new rn("name","fullPath",!0));function e(s,o){return CJ(o)}let t=new rn("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new rn("size");return i.xform=r,n.push(i),n.push(new rn("timeCreated")),n.push(new rn("updated")),n.push(new rn("md5Hash",null,!0)),n.push(new rn("cacheControl",null,!0)),n.push(new rn("contentDisposition",null,!0)),n.push(new rn("contentEncoding",null,!0)),n.push(new rn("contentLanguage",null,!0)),n.push(new rn("contentType",null,!0)),n.push(new rn("metadata","customMetadata",!0)),gy=n,gy}function TJ(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Pn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function SJ(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return TJ(r,n),r}function iU(n,e,t){let r=BD(e);return r===null?null:SJ(n,r,t)}function DJ(n,e,t,r){let i=BD(e);if(i===null||!yy(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,h=n.fullPath,p="/b/"+o(d)+"/o/"+o(h),_=_o(p,t,r),E=Z2({alt:"media",token:l});return _+E})[0]}function jD(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var B2="prefixes",j2="items";function AJ(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[B2])for(let i of t[B2]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new Pn(e,s));r.prefixes.push(o)}if(t[j2])for(let i of t[j2]){let s=n._makeStorageReference(new Pn(e,i.name));r.items.push(s)}return r}function xJ(n,e,t){let r=BD(t);return r===null?null:AJ(n,e,r)}var Qr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Oi(n){if(!n)throw FD()}function wy(n,e){function t(r,i){let s=iU(n,i,e);return Oi(s!==null),s}return t}function RJ(n,e){function t(r,i){let s=xJ(n,e,i);return Oi(s!==null),s}return t}function kJ(n,e){function t(r,i){let s=iU(n,i,e);return Oi(s!==null),DJ(s,i,n.host,n._protocol)}return t}function Zl(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=QY():i=KY():t.getStatus()===402?i=WY(n.bucket):t.getStatus()===403?i=YY(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Ey(n){let e=Zl(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=GY(n.path)),s.serverResponse=i.serverResponse,s}return t}function sU(n,e,t){let r=e.fullServerUrl(),i=_o(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Qr(i,s,wy(n,t),o);return a.errorHandler=Ey(e),a}function NJ(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=_o(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new Qr(a,c,RJ(n,e.bucket),l);return d.urlParams=s,d.errorHandler=Zl(e),d}function PJ(n,e,t){let r=e.fullServerUrl(),i=_o(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new Qr(i,s,kJ(n,t),o);return a.errorHandler=Ey(e),a}function MJ(n,e,t,r){let i=e.fullServerUrl(),s=_o(i,n.host,n._protocol),o="PATCH",a=jD(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new Qr(s,o,wy(n,r),l);return d.headers=c,d.body=a,d.errorHandler=Ey(e),d}function OJ(n,e){let t=e.fullServerUrl(),r=_o(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new Qr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Ey(e),a}function FJ(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function oU(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=FJ(null,e)),r}function LJ(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let H="";for(let ee=0;ee<2;ee++)H=H+Math.random().toString().slice(2);return H}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=oU(e,r,i),d=jD(l,t),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=Yl.getBlob(h,r,p);if(_===null)throw J2();let E={name:l.fullPath},A=_o(s,n.host,n._protocol),R="POST",U=n.maxUploadRetryTime,J=new Qr(A,R,wy(n,t),U);return J.urlParams=E,J.headers=o,J.body=_.uploadData(),J.errorHandler=Zl(e),J}var Jl=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function $D(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Oi(!1)}return Oi(!!t&&(e||["active"]).indexOf(t)!==-1),t}function VJ(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=oU(e,r,i),a={name:o.fullPath},c=_o(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=jD(o,t),p=n.maxUploadRetryTime;function _(A){$D(A);let R;try{R=A.getResponseHeader("X-Goog-Upload-URL")}catch{Oi(!1)}return Oi(yy(R)),R}let E=new Qr(c,l,_,p);return E.urlParams=a,E.headers=d,E.body=h,E.errorHandler=Zl(e),E}function UJ(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=$D(l,["active","final"]),h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Oi(!1)}h||Oi(!1);let p=Number(h);return Oi(!isNaN(p)),new Jl(p,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new Qr(t,o,s,a);return c.headers=i,c.errorHandler=Zl(e),c}var $2=256*1024;function BJ(n,e,t,r,i,s,o,a){let c=new Jl(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw eJ();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let h=c.current,p=h+d,_="";d===0?_="finalize":l===d?_="upload, finalize":_="upload";let E={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${c.current}`},A=r.slice(h,p);if(A===null)throw J2();function R(ee,fe){let re=$D(ee,["active","final"]),S=c.current+d,b=r.size(),C;return re==="final"?C=wy(e,s)(ee,fe):C=null,new Jl(S,b,re==="final",C)}let U="POST",J=e.maxUploadRetryTime,H=new Qr(t,U,R,J);return H.headers=E,H.body=A.uploadData(),H.progressCallback=a||null,H.errorHandler=Zl(n),H}var aU={STATE_CHANGED:"state_changed"},yn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function xD(n){switch(n){case"running":case"pausing":case"canceling":return yn.RUNNING;case"paused":return yn.PAUSED;case"success":return yn.SUCCESS;case"canceled":return yn.CANCELED;case"error":return yn.ERROR;default:return yn.ERROR}}var PD=class{constructor(e,t,r){if(oJ(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Wl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var H2=null,MD=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ql.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ql.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ql.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw tf("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw tf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw tf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw tf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw tf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},OD=class extends MD{initXhr(){this.xhr_.responseType="text"}};function Mi(){return H2?H2():new OD}var sf=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=vy(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(dt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(eU(i.status,[]))if(s)i=Q2();else{this.sleepTime=Math.max(this.sleepTime*2,qY),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(dt.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=VJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Mi,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=UJ(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Mi,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=$2*this._chunkMultiplier,t=new Jl(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=BJ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Mi,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){$2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=sU(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Mi,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=LJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Mi,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=Y2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=xD(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new PD(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(xD(this._state)){case yn.SUCCESS:Wl(this._resolve.bind(null,this.snapshot))();break;case yn.CANCELED:case yn.ERROR:let t=this._reject;Wl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(xD(this._state)){case yn.RUNNING:case yn.PAUSED:e.next&&Wl(e.next.bind(e,this.snapshot))();break;case yn.SUCCESS:e.complete&&Wl(e.complete.bind(e))();break;case yn.CANCELED:case yn.ERROR:e.error&&Wl(e.error.bind(e,this._error))();break;default:e.error&&Wl(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Xl=class n{constructor(e,t){this._service=e,t instanceof Pn?this._location=t:this._location=Pn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rU(this._location.path)}get storage(){return this._service}get parent(){let e=EJ(this._location.path);if(e===null)return null;let t=new Pn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw LD(e)}};function jJ(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new sf(n,new Yl(e),t)}function $J(n){let e={prefixes:[],items:[]};return cU(n,e).then(()=>e)}function cU(n,e,t){return g(this,null,function*(){let i=yield lU(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield cU(n,e,i.nextPageToken))})}function lU(n,e){e!=null&&typeof e.maxResults=="number"&&kD("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=NJ(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Mi)}function HJ(n){n._throwIfRoot("getMetadata");let e=sU(n.storage,n._location,vy());return n.storage.makeRequestWithTokens(e,Mi)}function zJ(n,e){n._throwIfRoot("updateMetadata");let t=MJ(n.storage,n._location,e,vy());return n.storage.makeRequestWithTokens(t,Mi)}function qJ(n){n._throwIfRoot("getDownloadURL");let e=PJ(n.storage,n._location,vy());return n.storage.makeRequestWithTokens(e,Mi).then(t=>{if(t===null)throw tJ();return t})}function GJ(n){n._throwIfRoot("deleteObject");let e=OJ(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Mi)}function uU(n,e){let t=IJ(n._location.path,e),r=new Pn(n._location.bucket,t);return new Xl(n.storage,r)}function WJ(n){return/^[A-Za-z]+:\/\//.test(n)}function KJ(n,e){return new Xl(n,e)}function dU(n,e){if(n instanceof of){let t=n;if(t._bucket==null)throw ZY();let r=new Xl(t,t._bucket);return e!=null?dU(r,e):r}else return e!==void 0?uU(n,e):n}function QJ(n,e){if(e&&WJ(e)){if(n instanceof of)return KJ(n,e);throw za("To use ref(service, url), the first argument must be a Storage instance.")}else return dU(n,e)}function z2(n,e){let t=e?.[K2];return t==null?null:Pn.makeFromBucketSpec(t,n)}function YJ(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Gc(i,n.app.options.projectId))}var of=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=W2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HY,this._maxUploadRetryTime=zY,this._requests=new Set,i!=null?this._bucket=Pn.makeFromBucketSpec(i,this._host):this._bucket=z2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Pn.makeFromBucketSpec(this._url,e):this._bucket=z2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){kD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){kD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xl(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new RD(X2());{let o=hJ(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return g(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},q2="@firebase/storage",G2="0.12.5";var JJ="storage";function eu(n,e,t){return n=K(n),jJ(n,e,t)}function hU(n){return n=K(n),HJ(n)}function fU(n,e){return n=K(n),zJ(n,e)}function pU(n,e){return n=K(n),lU(n,e)}function mU(n){return n=K(n),$J(n)}function tu(n){return n=K(n),qJ(n)}function nu(n){return n=K(n),GJ(n)}function fs(n,e){return n=K(n),QJ(n,e)}function gU(n,e){return uU(n,e)}function _U(n,e,t,r={}){YJ(n,e,t,r)}function XJ(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new of(t,r,i,e,xn)}function ZJ(){An(new Ye(JJ,XJ,"PUBLIC").setMultipleInstances(!0)),Tt(q2,G2,""),Tt(q2,G2,"esm2017")}ZJ();var ru=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var Iy=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new ru(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new ru(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new ru(o,this,this._ref)):s={next:t.next?o=>t.next(new ru(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},by=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new qa(e,this._service))}get items(){return this._delegate.items.map(e=>new qa(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var qa=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=gU(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Iy(eu(this._delegate,e,t),this)}putString(e,t=sr.RAW,r){this._throwIfRoot("putString");let i=UD(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new Iy(new sf(this._delegate,new Yl(i.data,!0),s),this)}listAll(){return mU(this._delegate).then(e=>new by(e,this.storage))}list(e){return pU(this._delegate,e||void 0).then(t=>new by(t,this.storage))}getMetadata(){return hU(this._delegate)}updateMetadata(e){return fU(this._delegate,e)}getDownloadURL(){return tu(this._delegate)}delete(){return this._throwIfRoot("delete"),nu(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw LD(e)}};var Cy=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(yU(e))throw za("ref() expected a child path but got a URL, use refFromURL instead.");return new qa(fs(this._delegate,e),this)}refFromURL(e){if(!yU(e))throw za("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Pn.makeFromUrl(e,this._delegate.host)}catch{throw za("refFromUrl() expected a valid full URL but got an invalid one.")}return new qa(fs(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){_U(this._delegate,e,t,r)}};function yU(n){return/^[A-Za-z]+:\/\//.test(n)}var eX="@firebase/storage-compat",tX="0.3.8";var nX="storage-compat";function rX(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new Cy(t,r)}function iX(n){let e={TaskState:yn,TaskEvent:aU,StringFormat:sr,Storage:Cy,Reference:qa};n.INTERNAL.registerComponent(new Ye(nX,rX,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(eX,tX)}iX(L);var vU="@firebase/database",wU="1.0.5";var ex="";function tx(n){ex=n}var YD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Pt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:zc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var JD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var JU=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new YD(e)}}catch{}return new JD},Wa=JU("localStorage"),XD=JU("sessionStorage");var au=new Wn("@firebase/database"),XU=function(){let n=1;return function(){return n++}}(),ZU=function(n){let e=OM(n),t=new ug;t.update(e);let r=t.digest();return dg.encodeByteArray(r)},Rf=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Rf.apply(null,r):typeof r=="object"?e+=Pt(r):e+=r,e+=" "}return e},Ka=null,EU=!0,eB=function(n,e){z(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(au.logLevel=Ee.VERBOSE,Ka=au.log.bind(au),e&&XD.set("logging_enabled",!0)):typeof n=="function"?Ka=n:(Ka=null,XD.remove("logging_enabled"))},Xt=function(...n){if(EU===!0&&(EU=!1,Ka===null&&XD.get("logging_enabled")===!0&&eB(!0)),Ka){let e=Rf.apply(null,n);Ka(e)}},kf=function(n){return function(...e){Xt(n,...e)}},ZD=function(...n){let e="FIREBASE INTERNAL ERROR: "+Rf(...n);au.error(e)},Vi=function(...n){let e=`FIREBASE FATAL ERROR: ${Rf(...n)}`;throw au.error(e),new Error(e)},vn=function(...n){let e="FIREBASE WARNING: "+Rf(...n);au.warn(e)},sX=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&vn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Xy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},oX=function(n){if(mi()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Eo="[MIN_NAME]",ps="[MAX_NAME]",Ya=function(n,e){if(n===e)return 0;if(n===Eo||e===ps)return-1;if(e===Eo||n===ps)return 1;{let t=IU(n),r=IU(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},aX=function(n,e){return n===e?0:n<e?-1:1},af=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Pt(e))},nx=function(n){if(typeof n!="object"||n===null)return Pt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Pt(e[r]),t+=":",t+=nx(n[e[r]]);return t+="}",t},tB=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Zt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var nB=function(n){z(!Xy(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),h="";for(c=0;c<64;c+=8){let p=parseInt(d.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},cX=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},lX=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function uX(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var dX=new RegExp("^-?(0*)\\d{1,10}$"),hX=-2147483648,fX=2147483647,IU=function(n){if(dX.test(n)){let e=Number(n);if(e>=hX&&e<=fX)return e}return null},gu=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw vn("Exception was thrown by user callback.",t),e},Math.floor(0))}},pX=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},df=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var eA=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){vn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var tA=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Xt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vn(e)}},hf=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Sy="5",rB="v",iB="s",sB="r",oB="f",aB=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,cB="ls",lB="p",nA="ac",uB="websocket",dB="long_polling";var Dy=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Wa.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Wa.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function mX(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function hB(n,e,t){z(typeof e=="string","typeof type must == string"),z(typeof t=="object","typeof params must == object");let r;if(e===uB)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===dB)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);mX(n)&&(t.ns=n.namespace);let i=[];return Zt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var rA=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return xM(this.counters_)}};var HD={},zD={};function rx(n){let e=n.toString();return HD[e]||(HD[e]=new rA),HD[e]}function gX(n,e){let t=n.toString();return zD[t]||(zD[t]=e()),zD[t]}var iA=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&gu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var bU="start",_X="close",yX="pLPCommand",vX="pRTLPCB",fB="id",pB="pw",mB="ser",wX="cb",EX="seg",IX="ts",bX="d",CX="dframe",gB=1870,_B=30,TX=gB-_B,SX=25e3,DX=3e4,gf=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=kf(e),this.stats_=rx(t),this.urlFn=c=>(this.appCheckToken&&(c[nA]=this.appCheckToken),hB(t,dB,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new iA(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(DX)),oX(()=>{if(this.isClosed_)return;this.scriptTagHolder=new sA((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===bU)this.id=a,this.password=c;else if(o===_X)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[bU]="t",r[mB]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[wX]=this.scriptTagHolder.uniqueCallbackIdentifier),r[rB]=Sy,this.transportSessionId&&(r[iB]=this.transportSessionId),this.lastSessionId&&(r[cB]=this.lastSessionId),this.applicationId&&(r[lB]=this.applicationId),this.appCheckToken&&(r[nA]=this.appCheckToken),typeof location<"u"&&location.hostname&&aB.test(location.hostname)&&(r[sB]=oB);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return mi()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!cX()&&!lX()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Pt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=bI(t),i=tB(r,TX);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(mi())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[CX]="t",r[fB]=e,r[pB]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Pt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},sA=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,mi())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=XU(),window[yX+this.uniqueCallbackIdentifier]=e,window[vX+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Xt("frame writing exception"),a.stack&&Xt(a.stack),Xt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Xt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[fB]=this.myID,e[pB]=this.myPW,e[mB]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+_B+r.length<=gB;){let o=this.pendingSegs.shift();r=r+"&"+EX+i+"="+o.seg+"&"+IX+i+"="+o.ts+"&"+bX+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(SX)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){mi()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Xt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var AX=16384,xX=45e3,Ay=null;typeof MozWebSocket<"u"?Ay=MozWebSocket:typeof WebSocket<"u"&&(Ay=WebSocket);var su=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=kf(this.connId),this.stats_=rx(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[rB]=Sy,!mi()&&typeof location<"u"&&location.hostname&&aB.test(location.hostname)&&(a[sB]=oB),r&&(a[iB]=r),i&&(a[cB]=i),s&&(a[nA]=s),o&&(a[lB]=o),hB(t,uB,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Wa.set("previous_websocket_failure",!0);try{let i;if(mi()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Sy}/${ex}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Ay(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Ay!==null&&!n.forceDisallow_}static previouslyFailed(){return Wa.isInMemoryStorage||Wa.get("previous_websocket_failure")===!0}markConnectionHealthy(){Wa.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=zc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(z(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Pt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=tB(r,AX);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(xX))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),yB=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[gf,su]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=su&&su.isAvailable(),i=r&&!su.previouslyFailed();if(t.webSocketOnly&&(r||vn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[su];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),RX=6e4,kX=5e3,NX=10*1024,PX=100*1024,qD="t",CU="d",MX="s",TU="r",OX="e",SU="o",DU="a",AU="n",xU="p",FX="h",oA=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=kf("c:"+this.id+":"),this.transportManager_=new yB(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=df(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>PX?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>NX?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(qD in e){let t=e[qD];t===DU?this.upgradeIfSecondaryHealthy_():t===TU?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===SU&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=af("t",e),r=af("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:xU,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:DU,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:AU,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=af("t",e),r=af("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=af(qD,e);if(CU in e){let r=e[CU];if(t===FX){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===AU){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===MX?this.onConnectionShutdown_(r):t===TU?this.onReset_(r):t===OX?ZD("Server Error: "+r):t===SU?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ZD("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Sy!==r&&vn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),df(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(RX))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):df(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(kX))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:xU,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Wa.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var xy=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Ry=class{constructor(e){this.allowedEvents_=e,this.listeners_={},z(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){z(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var ky=class n extends Ry{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Vd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return z(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var RU=32,kU=768,ze=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function He(){return new ze("")}function Ie(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Io(n){return n.pieces_.length-n.pieceNum_}function tt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ze(n.pieces_,e)}function ix(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function LX(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function _f(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function vB(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ze(e,0)}function ht(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof ze)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new ze(t,0)}function be(n){return n.pieceNum_>=n.pieces_.length}function Mn(n,e){let t=Ie(n),r=Ie(e);if(t===null)return e;if(t===r)return Mn(tt(n),tt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function VX(n,e){let t=_f(n,0),r=_f(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=Ya(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function sx(n,e){if(Io(n)!==Io(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Sr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Io(n)>Io(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var aA=class{constructor(e,t){this.errorPrefix_=t,this.parts_=_f(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Bd(this.parts_[r]);wB(this)}};function UX(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Bd(e),wB(n)}function BX(n){let e=n.parts_.pop();n.byteLength_-=Bd(e),n.parts_.length>0&&(n.byteLength_-=1)}function wB(n){if(n.byteLength_>kU)throw new Error(n.errorPrefix_+"has a key path longer than "+kU+" bytes ("+n.byteLength_+").");if(n.parts_.length>RU)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+RU+") or object contains a cycle "+Ga(n))}function Ga(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var cA=class n extends Ry{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return z(e==="visible","Unknown event type: "+e),[this.visible_]}};var cf=1e3,jX=60*5*1e3,NU=30*1e3,$X=1.3,HX=3e4,zX="server_kill",PU=3,ox=(()=>{class n extends xy{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=kf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=cf,this.maxReconnectDelay_=jX,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!mi())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");cA.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&ky.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Pt(o)),z(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new zt,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),z(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),z(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Dn(t,"w")){let i=Us(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();vn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||MM(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=NU)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=PM(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),z(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Pt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):ZD("Unrecognized action received from server: "+Pt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){z(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=cf,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=cf,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>HX&&(this.reconnectDelay_=cf),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*$X)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(p){z(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(p)};this.realtime_={close:l,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[p,_]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?Xt("getToken() completed but was canceled"):(Xt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=_&&_.token,c=new oA(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,E=>{vn(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(zX)},o))}catch(p){this.log_("Failed to get token: "+p),a||(this.repoInfo_.nodeAdmin&&vn(p),l())}}})}interrupt(t){Xt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Xt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Wc(this.interruptReasons_)&&(this.reconnectDelay_=cf,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>nx(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new ze(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Xt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=PU&&(this.reconnectDelay_=NU,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Xt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=PU&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";mi()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+ex.replace(/\./g,"-")]=1,Vd()?t["framework.cordova"]=1:Zo()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=ky.getInstance().currentlyOnline();return Wc(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),Se=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var cu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new Se(Eo,e),i=new Se(Eo,t);return this.compare(r,i)!==0}minPost(){return Se.MIN}};var Ty,Ny=class extends cu{static get __EMPTY_NODE(){return Ty}static set __EMPTY_NODE(e){Ty=e}compare(e,t){return Ya(e.name,t.name)}isDefinedOn(e){throw Xo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Se.MIN}maxPost(){return new Se(ps,Ty)}makePost(e,t){return z(typeof e=="string","KeyIndex indexValue must always be a string."),new Se(e,Ty)}toString(){return".key"}},Li=new Ny;var ou=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Yr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Dr.EMPTY_NODE,this.right=o??Dr.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Dr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Dr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),lA=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Yr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Dr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Yr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Yr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ou(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ou(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ou(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ou(this.root_,null,this.comparator_,!0,e)}};Dr.EMPTY_NODE=new lA;function qX(n,e){return Ya(n.name,e.name)}function ax(n,e){return Ya(n,e)}var uA;function GX(n){uA=n}var EB=function(n){return typeof n=="number"?"number:"+nB(n):"string:"+n},IB=function(n){if(n.isLeafNode()){let e=n.val();z(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else z(n===uA||n.isEmpty(),"priority of unexpected type.");z(n===uA||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var MU,lu=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,z(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),IB(this.priorityNode_)}static set __childrenNodeConstructor(t){MU=t}static get __childrenNodeConstructor(){return MU}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return be(t)?this:Ie(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Ie(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(z(i!==".priority"||Io(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(tt(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+EB(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=nB(this.value_):t+=this.value_,this.lazyHash_=ZU(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(z(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return z(s>=0,"Unknown leaf type: "+r),z(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),bB,CB;function WX(n){bB=n}function KX(n){CB=n}var dA=class extends cu{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Ya(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Se.MIN}maxPost(){return new Se(ps,new lu("[PRIORITY-POST]",CB))}makePost(e,t){let r=bB(e);return new Se(t,new lu("[PRIORITY-POST]",r))}toString(){return".priority"}},ot=new dA;var QX=Math.log(2),hA=class{constructor(e){let t=s=>parseInt(Math.log(s)/QX,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Py=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,h,p;if(d===0)return null;if(d===1)return h=n[c],p=t?t(h):h,new Yr(p,h.node,Yr.BLACK,null,null);{let _=parseInt(d/2,10)+c,E=i(c,_),A=i(_+1,l);return h=n[_],p=t?t(h):h,new Yr(p,h.node,Yr.BLACK,E,A)}},s=function(c){let l=null,d=null,h=n.length,p=function(E,A){let R=h-E,U=h;h-=E;let J=i(R+1,U),H=n[R],ee=t?t(H):H;_(new Yr(ee,H.node,A,null,J))},_=function(E){l?(l.left=E,l=E):(d=E,l=E)};for(let E=0;E<c.count;++E){let A=c.nextBitIsOne(),R=Math.pow(2,c.count-(E+1));A?p(R,Yr.BLACK):(p(R,Yr.BLACK),p(R,Yr.RED))}return d},o=new hA(n.length),a=s(o);return new Dr(r||e,a)};var GD,iu={},uu=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return z(iu&&ot,"ChildrenNode.ts has not been loaded"),GD=GD||new n({".priority":iu},{".priority":ot}),GD}get(e){let t=Us(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Dr?t:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,t){z(e!==Li,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Se.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Py(r,e.getCompare()):a=iu;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=Ud(this.indexes_,(i,s)=>{let o=Us(this.indexSet_,s);if(z(o,"Missing index implementation for "+s),i===iu)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(Se.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Py(a,o.getCompare())}else return iu;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new Se(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Ud(this.indexes_,i=>{if(i===iu)return i;{let s=t.get(e.name);return s?i.remove(new Se(e.name,s)):i}});return new n(r,this.indexSet_)}};var lf,ye=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&IB(this.priorityNode_),this.children_.isEmpty()&&z(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return lf||(lf=new n(new Dr(ax),null,uu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||lf}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?lf:r}}getChild(t){let r=Ie(t);return r===null?this:this.getImmediateChild(r).getChild(tt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(z(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Se(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?lf:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=Ie(t);if(i===null)return r;{z(Ie(t)!==".priority"||Io(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(tt(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(ot,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+EB(this.getPriority().val())+":"),this.forEachChild(ot,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":ZU(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Se(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Se(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Se(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Se.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Se.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Nf?-1:0}withIndex(t){if(t===Li||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Li||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(ot),s=r.getIterator(ot),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Li?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),fA=class extends ye{constructor(){super(new Dr(ax),ye.EMPTY_NODE,uu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ye.EMPTY_NODE}isEmpty(){return!1}},Nf=new fA;Object.defineProperties(Se,{MIN:{value:new Se(Eo,ye.EMPTY_NODE)},MAX:{value:new Se(ps,Nf)}});Ny.__EMPTY_NODE=ye.EMPTY_NODE;lu.__childrenNodeConstructor=ye;GX(Nf);KX(Nf);var YX=!0;function _t(n,e=null){if(n===null)return ye.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),z(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new lu(t,_t(e))}if(!(n instanceof Array)&&YX){let t=[],r=!1;if(Zt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=_t(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Se(o,c)))}}),t.length===0)return ye.EMPTY_NODE;let s=Py(t,qX,o=>o.name,ax);if(r){let o=Py(t,ot.getCompare());return new ye(s,_t(e),new uu({".priority":o},{".priority":ot}))}else return new ye(s,_t(e),uu.Default)}else{let t=ye.EMPTY_NODE;return Zt(n,(r,i)=>{if(Dn(n,r)&&r.substring(0,1)!=="."){let s=_t(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(_t(e))}}WX(_t);var yf=class extends cu{constructor(e){super(),this.indexPath_=e,z(!be(e)&&Ie(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Ya(e.name,t.name):s}makePost(e,t){let r=_t(e),i=ye.EMPTY_NODE.updateChild(this.indexPath_,r);return new Se(t,i)}maxPost(){let e=ye.EMPTY_NODE.updateChild(this.indexPath_,Nf);return new Se(ps,e)}toString(){return _f(this.indexPath_,0).join("/")}};var pA=class extends cu{compare(e,t){let r=e.node.compareTo(t.node);return r===0?Ya(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Se.MIN}maxPost(){return Se.MAX}makePost(e,t){let r=_t(e);return new Se(t,r)}toString(){return".value"}},cx=new pA;function TB(n){return{type:"value",snapshotNode:n}}function du(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function vf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function wf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function JX(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Ef=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){z(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(vf(t,a)):z(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(du(t,r)):o.trackChildChange(wf(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ot,(i,s)=>{t.hasChild(i)||r.trackChildChange(vf(i,s))}),t.isLeafNode()||t.forEachChild(ot,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(wf(i,s,o))}else r.trackChildChange(du(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ye.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var My=class n{constructor(e){this.indexedFilter_=new Ef(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Se(t,r))||(r=ye.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=ye.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(ye.EMPTY_NODE);let s=this;return t.forEachChild(ot,(o,a)=>{s.matches(new Se(o,a))||(i=i.updateImmediateChild(o,ye.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var mA=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new My(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Se(t,r))||(r=ye.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=ye.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=ye.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(ye.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ye.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(p,_)=>h(_,p)}else o=this.index_.getCompare();let a=e;z(a.numChildren()===this.limit_,"");let c=new Se(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let h=a.getImmediateChild(t),p=i.getChildAfterChild(this.index_,l,this.reverse_);for(;p!=null&&(p.name===t||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);let _=p==null?1:o(p,c);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(wf(t,r,h)),a.updateImmediateChild(t,r);{s?.trackChildChange(vf(t,h));let A=a.updateImmediateChild(t,ye.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(s?.trackChildChange(du(p.name,p.node)),A.updateImmediateChild(p.name,p.node)):A}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(vf(l.name,l.node)),s.trackChildChange(du(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,ye.EMPTY_NODE)):e}};var If=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ot}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return z(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return z(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Eo}hasEnd(){return this.endSet_}getIndexEndValue(){return z(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return z(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ps}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return z(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ot}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function XX(n){return n.loadsAllData()?new Ef(n.getIndex()):n.hasLimit()?new mA(n):new My(n)}function ZX(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function eZ(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function gA(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function tZ(n,e,t){let r;return n.index_===Li||t?r=gA(n,e,t):r=gA(n,e,ps),r.startAfterSet_=!0,r}function _A(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function nZ(n,e,t){let r;return n.index_===Li||t?r=_A(n,e,t):r=_A(n,e,Eo),r.endBeforeSet_=!0,r}function Zy(n,e){let t=n.copy();return t.index_=e,t}function OU(n){let e={};if(n.isDefault())return e;let t;if(n.index_===ot?t="$priority":n.index_===cx?t="$value":n.index_===Li?t="$key":(z(n.index_ instanceof yf,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Pt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Pt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Pt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Pt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Pt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function FU(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==ot&&(e.i=n.index_.toString()),e}var yA=class n extends xy{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=kf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(z(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=OU(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let h=d;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Us(this.listens_,o)===a){let p;l?l===401?p="permission_denied":p="rest_error:"+l:p="ok",i(p,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=OU(e._queryParams),r=e._path.toString(),i=new zt;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ts(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=zc(a.responseText)}catch{vn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&vn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var vA=class{constructor(){this.rootNode_=ye.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Oy(){return{value:null,children:new Map}}function _u(n,e,t){if(be(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=Ie(e);n.children.has(r)||n.children.set(r,Oy());let i=n.children.get(r);e=tt(e),_u(i,e,t)}}function wA(n,e){if(be(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(ot,(r,i)=>{_u(n,new ze(r),i)}),wA(n,e)}}else if(n.children.size>0){let t=Ie(e);return e=tt(e),n.children.has(t)&&wA(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function EA(n,e,t){n.value!==null?t(e,n.value):rZ(n,(r,i)=>{let s=new ze(e.toString()+"/"+r);EA(i,s,t)})}function rZ(n,e){n.children.forEach((t,r)=>{e(r,t)})}var IA=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Zt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var LU=10*1e3,iZ=30*1e3,sZ=5*60*1e3,bA=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new IA(e);let r=LU+(iZ-LU)*Math.random();df(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Zt(e,(i,s)=>{s>0&&Dn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),df(this.reportStats_.bind(this),Math.floor(Math.random()*2*sZ))}};var Fi=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Fi||{});function lx(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ux(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function dx(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var CA=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Fi.ACK_USER_WRITE,this.source=lx()}operationForChild(e){if(be(this.path)){if(this.affectedTree.value!=null)return z(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new ze(e));return new n(He(),t,this.revert)}}else return z(Ie(this.path)===e,"operationForChild called for unrelated child."),new n(tt(this.path),this.affectedTree,this.revert)}};var Fy=class n{constructor(e,t){this.source=e,this.path=t,this.type=Fi.LISTEN_COMPLETE}operationForChild(e){return be(this.path)?new n(this.source,He()):new n(this.source,tt(this.path))}};var hu=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Fi.OVERWRITE}operationForChild(e){return be(this.path)?new n(this.source,He(),this.snap.getImmediateChild(e)):new n(this.source,tt(this.path),this.snap)}};var bf=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Fi.MERGE}operationForChild(e){if(be(this.path)){let t=this.children.subtree(new ze(e));return t.isEmpty()?null:t.value?new hu(this.source,He(),t.value):new n(this.source,He(),t)}else return z(Ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,tt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Ui=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(be(e))return this.isFullyInitialized()&&!this.filtered_;let t=Ie(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var TA=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function oZ(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(JX(o.childName,o.snapshotNode))}),uf(n,i,"child_removed",e,r,t),uf(n,i,"child_added",e,r,t),uf(n,i,"child_moved",s,r,t),uf(n,i,"child_changed",e,r,t),uf(n,i,"value",e,r,t),i}function uf(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>cZ(n,a,c)),o.forEach(a=>{let c=aZ(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function aZ(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function cZ(n,e,t){if(e.childName==null||t.childName==null)throw Xo("Should only compare child_ events.");let r=new Se(e.childName,e.snapshotNode),i=new Se(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function ev(n,e){return{eventCache:n,serverCache:e}}function ff(n,e,t,r){return ev(new Ui(e,t,r),n.serverCache)}function SB(n,e,t,r){return ev(n.eventCache,new Ui(e,t,r))}function Ly(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Qa(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var WD,lZ=()=>(WD||(WD=new Dr(aX)),WD),On=class n{constructor(e,t=lZ()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Zt(e,(r,i)=>{t=t.set(new ze(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:He(),value:this.value};if(be(e))return null;{let r=Ie(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(tt(e),t);return s!=null?{path:ht(new ze(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(be(e))return this;{let t=Ie(e),r=this.children.get(t);return r!==null?r.subtree(tt(e)):new n(null)}}set(e,t){if(be(e))return new n(t,this.children);{let r=Ie(e),s=(this.children.get(r)||new n(null)).set(tt(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(be(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=Ie(e),r=this.children.get(t);if(r){let i=r.remove(tt(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(be(e))return this.value;{let t=Ie(e),r=this.children.get(t);return r?r.get(tt(e)):null}}setTree(e,t){if(be(e))return t;{let r=Ie(e),s=(this.children.get(r)||new n(null)).setTree(tt(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(He(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ht(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,He(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(be(e))return null;{let s=Ie(e),o=this.children.get(s);return o?o.findOnPath_(tt(e),ht(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,He(),t)}foreachOnPath_(e,t,r){if(be(e))return this;{this.value&&r(t,this.value);let i=Ie(e),s=this.children.get(i);return s?s.foreachOnPath_(tt(e),ht(t,i),r):new n(null)}}foreach(e){this.foreach_(He(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(ht(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Jr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new On(null))}};function pf(n,e,t){if(be(e))return new Jr(new On(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Mn(i,e);return s=s.updateChild(o,t),new Jr(n.writeTree_.set(i,s))}else{let i=new On(t),s=n.writeTree_.setTree(e,i);return new Jr(s)}}}function SA(n,e,t){let r=n;return Zt(t,(i,s)=>{r=pf(r,ht(e,i),s)}),r}function VU(n,e){if(be(e))return Jr.empty();{let t=n.writeTree_.setTree(e,new On(null));return new Jr(t)}}function DA(n,e){return Ja(n,e)!=null}function Ja(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Mn(t.path,e)):null}function UU(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(ot,(r,i)=>{e.push(new Se(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new Se(r,i.value))}),e}function vo(n,e){if(be(e))return n;{let t=Ja(n,e);return t!=null?new Jr(new On(t)):new Jr(n.writeTree_.subtree(e))}}function AA(n){return n.writeTree_.isEmpty()}function fu(n,e){return DB(He(),n.writeTree_,e)}function DB(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(z(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=DB(ht(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(ht(n,".priority"),r)),t}}function tv(n,e){return kB(e,n)}function uZ(n,e,t,r,i){z(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=pf(n.visibleWrites,e,t)),n.lastWriteId=r}function dZ(n,e,t,r){z(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=SA(n.visibleWrites,e,t),n.lastWriteId=r}function hZ(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function fZ(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);z(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&pZ(a,r.path)?i=!1:Sr(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return mZ(n),!0;if(r.snap)n.visibleWrites=VU(n.visibleWrites,r.path);else{let a=r.children;Zt(a,c=>{n.visibleWrites=VU(n.visibleWrites,ht(r.path,c))})}return!0}else return!1}function pZ(n,e){if(n.snap)return Sr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Sr(ht(n.path,t),e))return!0;return!1}function mZ(n){n.visibleWrites=AB(n.allWrites,gZ,He()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function gZ(n){return n.visible}function AB(n,e,t){let r=Jr.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)Sr(t,o)?(a=Mn(t,o),r=pf(r,a,s.snap)):Sr(o,t)&&(a=Mn(o,t),r=pf(r,He(),s.snap.getChild(a)));else if(s.children){if(Sr(t,o))a=Mn(t,o),r=SA(r,a,s.children);else if(Sr(o,t))if(a=Mn(o,t),be(a))r=SA(r,He(),s.children);else{let c=Us(s.children,Ie(a));if(c){let l=c.getChild(tt(a));r=pf(r,He(),l)}}}else throw Xo("WriteRecord should have .snap or .children")}}return r}function xB(n,e,t,r,i){if(!r&&!i){let s=Ja(n.visibleWrites,e);if(s!=null)return s;{let o=vo(n.visibleWrites,e);if(AA(o))return t;if(t==null&&!DA(o,He()))return null;{let a=t||ye.EMPTY_NODE;return fu(o,a)}}}else{let s=vo(n.visibleWrites,e);if(!i&&AA(s))return t;if(!i&&t==null&&!DA(s,He()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Sr(l.path,e)||Sr(e,l.path))},a=AB(n.allWrites,o,e),c=t||ye.EMPTY_NODE;return fu(a,c)}}}function _Z(n,e,t){let r=ye.EMPTY_NODE,i=Ja(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ot,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=vo(n.visibleWrites,e);return t.forEachChild(ot,(o,a)=>{let c=fu(vo(s,new ze(o)),a);r=r.updateImmediateChild(o,c)}),UU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=vo(n.visibleWrites,e);return UU(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function yZ(n,e,t,r,i){z(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ht(e,t);if(DA(n.visibleWrites,s))return null;{let o=vo(n.visibleWrites,s);return AA(o)?i.getChild(t):fu(o,i.getChild(t))}}function vZ(n,e,t,r){let i=ht(e,t),s=Ja(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=vo(n.visibleWrites,i);return fu(o,r.getNode().getImmediateChild(t))}else return null}function wZ(n,e){return Ja(n.visibleWrites,e)}function EZ(n,e,t,r,i,s,o){let a,c=vo(n.visibleWrites,e),l=Ja(c,He());if(l!=null)a=l;else if(t!=null)a=fu(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),p=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),_=p.getNext();for(;_&&d.length<i;)h(_,r)!==0&&d.push(_),_=p.getNext();return d}else return[]}function IZ(){return{visibleWrites:Jr.empty(),allWrites:[],lastWriteId:-1}}function Vy(n,e,t,r){return xB(n.writeTree,n.treePath,e,t,r)}function hx(n,e){return _Z(n.writeTree,n.treePath,e)}function BU(n,e,t,r){return yZ(n.writeTree,n.treePath,e,t,r)}function Uy(n,e){return wZ(n.writeTree,ht(n.treePath,e))}function bZ(n,e,t,r,i,s){return EZ(n.writeTree,n.treePath,e,t,r,i,s)}function fx(n,e,t){return vZ(n.writeTree,n.treePath,e,t)}function RB(n,e){return kB(ht(n.treePath,e),n.writeTree)}function kB(n,e){return{treePath:n,writeTree:e}}var xA=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;z(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),z(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,wf(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,vf(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,du(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,wf(r,e.snapshotNode,i.oldSnap));else throw Xo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var RA=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},NB=new RA,Cf=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Ui(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fx(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Qa(this.viewCache_),s=bZ(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function CZ(n){return{filter:n}}function TZ(n,e){z(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),z(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function SZ(n,e,t,r,i){let s=new xA,o,a;if(t.type===Fi.OVERWRITE){let l=t;l.source.fromUser?o=kA(n,e,l.path,l.snap,r,i,s):(z(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!be(l.path),o=By(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Fi.MERGE){let l=t;l.source.fromUser?o=AZ(n,e,l.path,l.children,r,i,s):(z(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=NA(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Fi.ACK_USER_WRITE){let l=t;l.revert?o=kZ(n,e,l.path,r,i,s):o=xZ(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Fi.LISTEN_COMPLETE)o=RZ(n,e,t.path,r,s);else throw Xo("Unknown operation type: "+t.type);let c=s.getChanges();return DZ(e,o,c),{viewCache:o,changes:c}}function DZ(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Ly(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(TB(Ly(e)))}}function PB(n,e,t,r,i,s){let o=e.eventCache;if(Uy(r,t)!=null)return e;{let a,c;if(be(t))if(z(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Qa(e),d=l instanceof ye?l:ye.EMPTY_NODE,h=hx(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let l=Vy(r,Qa(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=Ie(t);if(l===".priority"){z(Io(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=BU(r,t,d,c);h!=null?a=n.filter.updatePriority(d,h):a=o.getNode()}else{let d=tt(t),h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let p=BU(r,t,o.getNode(),c);p!=null?h=o.getNode().getImmediateChild(l).updateChild(d,p):h=o.getNode().getImmediateChild(l)}else h=fx(r,l,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),l,h,d,i,s):a=o.getNode()}}return ff(e,a,o.isFullyInitialized()||be(t),n.filter.filtersNodes())}}function By(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(be(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),_,null)}else{let _=Ie(t);if(!c.isCompleteForPath(t)&&Io(t)>1)return e;let E=tt(t),R=c.getNode().getImmediateChild(_).updateChild(E,r);_===".priority"?l=d.updatePriority(c.getNode(),R):l=d.updateChild(c.getNode(),_,R,E,NB,null)}let h=SB(e,l,c.isFullyInitialized()||be(t),d.filtersNodes()),p=new Cf(i,h,s);return PB(n,h,t,i,p,a)}function kA(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new Cf(i,e,s);if(be(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=ff(e,l,!0,n.filter.filtersNodes());else{let h=Ie(t);if(h===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=ff(e,l,a.isFullyInitialized(),a.isFiltered());else{let p=tt(t),_=a.getNode().getImmediateChild(h),E;if(be(p))E=r;else{let A=d.getCompleteChild(h);A!=null?ix(p)===".priority"&&A.getChild(vB(p)).isEmpty()?E=A:E=A.updateChild(p,r):E=ye.EMPTY_NODE}if(_.equals(E))c=e;else{let A=n.filter.updateChild(a.getNode(),h,E,p,d,o);c=ff(e,A,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function jU(n,e){return n.eventCache.isCompleteForChild(e)}function AZ(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=ht(t,c);jU(e,Ie(d))&&(a=kA(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=ht(t,c);jU(e,Ie(d))||(a=kA(n,a,d,l,i,s,o))}),a}function $U(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function NA(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;be(t)?l=r:l=new On(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((h,p)=>{if(d.hasChild(h)){let _=e.serverCache.getNode().getImmediateChild(h),E=$U(n,_,p);c=By(n,c,new ze(h),E,i,s,o,a)}}),l.children.inorderTraversal((h,p)=>{let _=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!d.hasChild(h)&&!_){let E=e.serverCache.getNode().getImmediateChild(h),A=$U(n,E,p);c=By(n,c,new ze(h),A,i,s,o,a)}}),c}function xZ(n,e,t,r,i,s,o){if(Uy(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(be(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return By(n,e,t,c.getNode().getChild(t),i,s,a,o);if(be(t)){let l=new On(null);return c.getNode().forEachChild(Li,(d,h)=>{l=l.set(new ze(d),h)}),NA(n,e,t,l,i,s,a,o)}else return e}else{let l=new On(null);return r.foreach((d,h)=>{let p=ht(t,d);c.isCompleteForPath(p)&&(l=l.set(d,c.getNode().getChild(p)))}),NA(n,e,t,l,i,s,a,o)}}function RZ(n,e,t,r,i){let s=e.serverCache,o=SB(e,s.getNode(),s.isFullyInitialized()||be(t),s.isFiltered());return PB(n,o,t,r,NB,i)}function kZ(n,e,t,r,i,s){let o;if(Uy(r,t)!=null)return e;{let a=new Cf(r,e,i),c=e.eventCache.getNode(),l;if(be(t)||Ie(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Vy(r,Qa(e));else{let h=e.serverCache.getNode();z(h instanceof ye,"serverChildren would be complete if leaf node"),d=hx(r,h)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=Ie(t),h=fx(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?l=n.filter.updateChild(c,d,h,tt(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,ye.EMPTY_NODE,tt(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Vy(r,Qa(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Uy(r,He())!=null,ff(e,l,o,n.filter.filtersNodes())}}var PA=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Ef(r.getIndex()),s=XX(r);this.processor_=CZ(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(ye.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(ye.EMPTY_NODE,a.getNode(),null),d=new Ui(c,o.isFullyInitialized(),i.filtersNodes()),h=new Ui(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ev(h,d),this.eventGenerator_=new TA(this.query_)}get query(){return this.query_}};function NZ(n){return n.viewCache_.serverCache.getNode()}function PZ(n){return Ly(n.viewCache_)}function MZ(n,e){let t=Qa(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!be(e)&&!t.getImmediateChild(Ie(e)).isEmpty())?t.getChild(e):null}function HU(n){return n.eventRegistrations_.length===0}function OZ(n,e){n.eventRegistrations_.push(e)}function zU(n,e,t){let r=[];if(t){z(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function qU(n,e,t,r){e.type===Fi.MERGE&&e.source.queryId!==null&&(z(Qa(n.viewCache_),"We should always have a full cache before handling merges"),z(Ly(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=SZ(n.processor_,i,e,t,r);return TZ(n.processor_,s.viewCache),z(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,MB(n,s.changes,s.viewCache.eventCache.getNode(),null)}function FZ(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(ot,(s,o)=>{r.push(du(s,o))}),t.isFullyInitialized()&&r.push(TB(t.getNode())),MB(n,r,t.getNode(),e)}function MB(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return oZ(n.eventGenerator_,e,t,i)}var jy,$y=class{constructor(){this.views=new Map}};function LZ(n){z(!jy,"__referenceConstructor has already been defined"),jy=n}function VZ(){return z(jy,"Reference.ts has not been loaded"),jy}function UZ(n){return n.views.size===0}function px(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return z(s!=null,"SyncTree gave us an op for an invalid query."),qU(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(qU(o,e,t,r));return s}}function OB(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=Vy(t,i?r:null),c=!1;a?c=!0:r instanceof ye?(a=hx(t,r),c=!1):(a=ye.EMPTY_NODE,c=!1);let l=ev(new Ui(a,c,!1),new Ui(r,i,!1));return new PA(e,l)}return o}function BZ(n,e,t,r,i,s){let o=OB(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),OZ(o,t),FZ(o,t)}function jZ(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=bo(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(zU(l,t,r)),HU(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(zU(c,t,r)),HU(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!bo(n)&&s.push(new(VZ())(e._repo,e._path)),{removed:s,events:o}}function FB(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function wo(n,e){let t=null;for(let r of n.views.values())t=t||MZ(r,e);return t}function LB(n,e){if(e._queryParams.loadsAllData())return nv(n);{let r=e._queryIdentifier;return n.views.get(r)}}function VB(n,e){return LB(n,e)!=null}function bo(n){return nv(n)!=null}function nv(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Hy;function $Z(n){z(!Hy,"__referenceConstructor has already been defined"),Hy=n}function HZ(){return z(Hy,"Reference.ts has not been loaded"),Hy}var zZ=1,zy=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new On(null),this.pendingWriteTree_=IZ(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function mx(n,e,t,r,i){return uZ(n.pendingWriteTree_,e,t,r,i),i?yu(n,new hu(lx(),e,t)):[]}function qZ(n,e,t,r){dZ(n.pendingWriteTree_,e,t,r);let i=On.fromObject(t);return yu(n,new bf(lx(),e,i))}function yo(n,e,t=!1){let r=hZ(n.pendingWriteTree_,e);if(fZ(n.pendingWriteTree_,e)){let s=new On(null);return r.snap!=null?s=s.set(He(),!0):Zt(r.children,o=>{s=s.set(new ze(o),!0)}),yu(n,new CA(r.path,s,t))}else return[]}function Pf(n,e,t){return yu(n,new hu(ux(),e,t))}function GZ(n,e,t){let r=On.fromObject(t);return yu(n,new bf(ux(),e,r))}function WZ(n,e){return yu(n,new Fy(ux(),e))}function KZ(n,e,t){let r=gx(n,t);if(r){let i=_x(r),s=i.path,o=i.queryId,a=Mn(s,e),c=new Fy(dx(o),a);return yx(n,s,c)}else return[]}function qy(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||VB(o,e))){let c=jZ(o,e,t,r);UZ(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(p,_)=>bo(_));if(d&&!h){let p=n.syncPointTree_.subtree(s);if(!p.isEmpty()){let _=JZ(p);for(let E=0;E<_.length;++E){let A=_[E],R=A.query,U=$B(n,A);n.listenProvider_.startListening(mf(R),Tf(n,R),U.hashFn,U.onComplete)}}}!h&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(mf(e),null):l.forEach(p=>{let _=n.queryToTagMap.get(iv(p));n.listenProvider_.stopListening(mf(p),_)}))}XZ(n,l)}return a}function UB(n,e,t,r){let i=gx(n,r);if(i!=null){let s=_x(i),o=s.path,a=s.queryId,c=Mn(o,e),l=new hu(dx(a),c,t);return yx(n,o,l)}else return[]}function QZ(n,e,t,r){let i=gx(n,r);if(i){let s=_x(i),o=s.path,a=s.queryId,c=Mn(o,e),l=On.fromObject(t),d=new bf(dx(a),c,l);return yx(n,o,d)}else return[]}function MA(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(p,_)=>{let E=Mn(p,i);s=s||wo(_,E),o=o||bo(_)});let a=n.syncPointTree_.get(i);a?(o=o||bo(a),s=s||wo(a,He())):(a=new $y,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ye.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((_,E)=>{let A=wo(E,He());A&&(s=s.updateImmediateChild(_,A))}));let l=VB(a,e);if(!l&&!e._queryParams.loadsAllData()){let p=iv(e);z(!n.queryToTagMap.has(p),"View does not exist, but we have a tag");let _=ZZ();n.queryToTagMap.set(p,_),n.tagToQueryMap.set(_,p)}let d=tv(n.pendingWriteTree_,i),h=BZ(a,e,t,d,s,c);if(!l&&!o&&!r){let p=LB(a,e);h=h.concat(eee(n,e,p))}return h}function rv(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=Mn(o,e),l=wo(a,c);if(l)return l});return xB(i,e,s,t,!0)}function YZ(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let h=Mn(l,t);r=r||wo(d,h)});let i=n.syncPointTree_.get(t);i?r=r||wo(i,He()):(i=new $y,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Ui(r,!0,!1):null,a=tv(n.pendingWriteTree_,e._path),c=OB(i,e,a,s?o.getNode():ye.EMPTY_NODE,s);return PZ(c)}function yu(n,e){return BB(e,n.syncPointTree_,null,tv(n.pendingWriteTree_,He()))}function BB(n,e,t,r){if(be(n.path))return jB(n,e,t,r);{let i=e.get(He());t==null&&i!=null&&(t=wo(i,He()));let s=[],o=Ie(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=RB(r,o);s=s.concat(BB(a,c,l,d))}return i&&(s=s.concat(px(i,n,r,t))),s}}function jB(n,e,t,r){let i=e.get(He());t==null&&i!=null&&(t=wo(i,He()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=RB(r,o),d=n.operationForChild(o);d&&(s=s.concat(jB(d,a,c,l)))}),i&&(s=s.concat(px(i,n,r,t))),s}function $B(n,e){let t=e.query,r=Tf(n,t);return{hashFn:()=>(NZ(e)||ye.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?KZ(n,t._path,r):WZ(n,t._path);{let s=uX(i,t);return qy(n,t,null,s)}}}}function Tf(n,e){let t=iv(e);return n.queryToTagMap.get(t)}function iv(n){return n._path.toString()+"$"+n._queryIdentifier}function gx(n,e){return n.tagToQueryMap.get(e)}function _x(n){let e=n.indexOf("$");return z(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ze(n.substr(0,e))}}function yx(n,e,t){let r=n.syncPointTree_.get(e);z(r,"Missing sync point for query tag that we're tracking");let i=tv(n.pendingWriteTree_,e);return px(r,t,i,null)}function JZ(n){return n.fold((e,t,r)=>{if(t&&bo(t))return[nv(t)];{let i=[];return t&&(i=FB(t)),Zt(r,(s,o)=>{i=i.concat(o)}),i}})}function mf(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(HZ())(n._repo,n._path):n}function XZ(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=iv(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function ZZ(){return zZ++}function eee(n,e,t){let r=e._path,i=Tf(n,e),s=$B(n,t),o=n.listenProvider_.startListening(mf(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)z(!bo(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,h)=>{if(!be(l)&&d&&bo(d))return[nv(d).query];{let p=[];return d&&(p=p.concat(FB(d).map(_=>_.query))),Zt(h,(_,E)=>{p=p.concat(E)}),p}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(mf(d),Tf(n,d))}}return o}var OA=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},FA=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=ht(this.path_,e);return new n(this.syncTree_,t)}node(){return rv(this.syncTree_,this.path_)}},tee=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},GU=function(n,e,t){if(!n||typeof n!="object")return n;if(z(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return nee(n[".sv"],e,t);if(typeof n[".sv"]=="object")return ree(n[".sv"],e);z(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},nee=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:z(!1,"Unexpected server value: "+n)}},ree=function(n,e,t){n.hasOwnProperty("increment")||z(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&z(!1,"Unexpected increment value: "+r);let i=e.node();if(z(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},HB=function(n,e,t,r){return wx(e,new FA(t,n),r)},vx=function(n,e,t){return wx(n,new OA(e),t)};function wx(n,e,t){let r=n.getPriority().val(),i=GU(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=GU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new lu(a,_t(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new lu(i))),o.forEachChild(ot,(a,c)=>{let l=wx(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Sf=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function sv(n,e){let t=e instanceof ze?e:new ze(e),r=n,i=Ie(t);for(;i!==null;){let s=Us(r.node.children,i)||{children:{},childCount:0};r=new Sf(i,r,s),t=tt(t),i=Ie(t)}return r}function Xa(n){return n.node.value}function Ex(n,e){n.node.value=e,LA(n)}function zB(n){return n.node.childCount>0}function iee(n){return Xa(n)===void 0&&!zB(n)}function ov(n,e){Zt(n.node.children,(t,r)=>{e(new Sf(t,n,r))})}function qB(n,e,t,r){t&&!r&&e(n),ov(n,i=>{qB(i,e,!0,r)}),t&&r&&e(n)}function see(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Mf(n){return new ze(n.parent===null?n.name:Mf(n.parent)+"/"+n.name)}function LA(n){n.parent!==null&&oee(n.parent,n.name,n)}function oee(n,e,t){let r=iee(t),i=Dn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,LA(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,LA(n))}var aee=/[\[\].#$\/\u0000-\u001F\u007F]/,cee=/[\[\].#$\u0000-\u001F\u007F]/,KD=10*1024*1024,av=function(n){return typeof n=="string"&&n.length!==0&&!aee.test(n)},GB=function(n){return typeof n=="string"&&n.length!==0&&!cee.test(n)},lee=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),GB(n)},Df=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Xy(n)||n&&typeof n=="object"&&Dn(n,".sv")},Bi=function(n,e,t,r){r&&e===void 0||Of(pn(n,"value"),e,t)},Of=function(n,e,t){let r=t instanceof ze?new aA(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Ga(r));if(typeof e=="function")throw new Error(n+"contains a function "+Ga(r)+" with contents = "+e.toString());if(Xy(e))throw new Error(n+"contains "+e.toString()+" "+Ga(r));if(typeof e=="string"&&e.length>KD/3&&Bd(e)>KD)throw new Error(n+"contains a string greater than "+KD+" utf8 bytes "+Ga(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Zt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!av(o)))throw new Error(n+" contains an invalid key ("+o+") "+Ga(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);UX(r,o),Of(n,a,r),BX(r)}),i&&s)throw new Error(n+' contains ".value" child '+Ga(r)+" in addition to actual children.")}},uee=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=_f(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!av(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(VX);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&Sr(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},WB=function(n,e,t,r){if(r&&e===void 0)return;let i=pn(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Zt(e,(o,a)=>{let c=new ze(o);if(Of(i,a,ht(t,c)),ix(c)===".priority"&&!Df(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),uee(i,s)},Ix=function(n,e,t){if(!(t&&e===void 0)){if(Xy(e))throw new Error(pn(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Df(e))throw new Error(pn(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ff=function(n,e,t,r){if(!(r&&t===void 0)&&!av(t))throw new Error(pn(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},vu=function(n,e,t,r){if(!(r&&t===void 0)&&!GB(t))throw new Error(pn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},dee=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),vu(n,e,t,r)},or=function(n,e){if(Ie(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},KB=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!av(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!lee(t))throw new Error(pn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var VA=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function cv(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!sx(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function QB(n,e,t){cv(n,t),YB(n,r=>sx(r,e))}function ar(n,e,t){cv(n,t),YB(n,r=>Sr(r,e)||Sr(e,r))}function YB(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(hee(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function hee(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Ka&&Xt("event: "+t.toString()),gu(r)}}}var JB="repo_interrupt",fee=25,UA=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new VA,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Oy(),this.transactionQueueTree_=new Sf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function pee(n,e,t){if(n.stats_=rx(n.repoInfo_),n.forceRestClient_||pX())n.server_=new yA(n.repoInfo_,(r,i,s,o)=>{WU(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>KU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Pt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new ox(n.repoInfo_,e,(r,i,s,o)=>{WU(n,r,i,s,o)},r=>{KU(n,r)},r=>{mee(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=gX(n.repoInfo_,()=>new bA(n.stats_,n.server_)),n.infoData_=new vA,n.infoSyncTree_=new zy({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=Pf(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),bx(n,"connected",!1),n.serverSyncTree_=new zy({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);ar(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function XB(n){let t=n.infoData_.getNode(new ze(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Lf(n){return tee({timestamp:XB(n)})}function WU(n,e,t,r,i){n.dataUpdateCount++;let s=new ze(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=Ud(t,l=>_t(l));o=QZ(n.serverSyncTree_,s,c,i)}else{let c=_t(t);o=UB(n.serverSyncTree_,s,c,i)}else if(r){let c=Ud(t,l=>_t(l));o=GZ(n.serverSyncTree_,s,c)}else{let c=_t(t);o=Pf(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=pu(n,s)),ar(n.eventQueue_,a,o)}function KU(n,e){bx(n,"connected",e),e===!1&&yee(n)}function mee(n,e){Zt(e,(t,r)=>{bx(n,t,r)})}function bx(n,e,t){let r=new ze("/.info/"+e),i=_t(t);n.infoData_.updateSnapshot(r,i);let s=Pf(n.infoSyncTree_,r,i);ar(n.eventQueue_,r,s)}function lv(n){return n.nextWriteId_++}function gee(n,e,t){let r=YZ(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=_t(i).withIndex(e._queryParams.getIndex());MA(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Pf(n.serverSyncTree_,e._path,s);else{let a=Tf(n.serverSyncTree_,e);o=UB(n.serverSyncTree_,e._path,s,a)}return ar(n.eventQueue_,e._path,o),qy(n.serverSyncTree_,e,t,null,!0),s},i=>(wu(n,"get for query "+Pt(e)+" failed: "+i),Promise.reject(new Error(i))))}function Cx(n,e,t,r,i){wu(n,"set",{path:e.toString(),value:t,priority:r});let s=Lf(n),o=_t(t,r),a=rv(n.serverSyncTree_,e),c=vx(o,a,s),l=lv(n),d=mx(n.serverSyncTree_,e,c,l,!0);cv(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(p,_)=>{let E=p==="ok";E||vn("set at "+e+" failed: "+p);let A=yo(n.serverSyncTree_,l,!E);ar(n.eventQueue_,e,A),Co(n,i,p,_)});let h=Sx(n,e);pu(n,h),ar(n.eventQueue_,h,[])}function _ee(n,e,t,r){wu(n,"update",{path:e.toString(),value:t});let i=!0,s=Lf(n),o={};if(Zt(t,(a,c)=>{i=!1,o[a]=HB(ht(e,a),_t(c),n.serverSyncTree_,s)}),i)Xt("update() called with empty data.  Don't do anything."),Co(n,r,"ok",void 0);else{let a=lv(n),c=qZ(n.serverSyncTree_,e,o,a);cv(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let h=l==="ok";h||vn("update at "+e+" failed: "+l);let p=yo(n.serverSyncTree_,a,!h),_=p.length>0?pu(n,e):e;ar(n.eventQueue_,_,p),Co(n,r,l,d)}),Zt(t,l=>{let d=Sx(n,ht(e,l));pu(n,d)}),ar(n.eventQueue_,e,[])}}function yee(n){wu(n,"onDisconnectEvents");let e=Lf(n),t=Oy();EA(n.onDisconnect_,He(),(i,s)=>{let o=HB(i,s,n.serverSyncTree_,e);_u(t,i,o)});let r=[];EA(t,He(),(i,s)=>{r=r.concat(Pf(n.serverSyncTree_,i,s));let o=Sx(n,i);pu(n,o)}),n.onDisconnect_=Oy(),ar(n.eventQueue_,He(),r)}function vee(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&wA(n.onDisconnect_,e),Co(n,t,r,i)})}function QU(n,e,t,r){let i=_t(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&_u(n.onDisconnect_,e,i),Co(n,r,s,o)})}function wee(n,e,t,r,i){let s=_t(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&_u(n.onDisconnect_,e,s),Co(n,i,o,a)})}function Eee(n,e,t,r){if(Wc(t)){Xt("onDisconnect().update() called with empty data.  Don't do anything."),Co(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&Zt(t,(o,a)=>{let c=_t(a);_u(n.onDisconnect_,ht(e,o),c)}),Co(n,r,i,s)})}function Iee(n,e,t){let r;Ie(e._path)===".info"?r=MA(n.infoSyncTree_,e,t):r=MA(n.serverSyncTree_,e,t),QB(n.eventQueue_,e._path,r)}function BA(n,e,t){let r;Ie(e._path)===".info"?r=qy(n.infoSyncTree_,e,t):r=qy(n.serverSyncTree_,e,t),QB(n.eventQueue_,e._path,r)}function ZB(n){n.persistentConnection_&&n.persistentConnection_.interrupt(JB)}function bee(n){n.persistentConnection_&&n.persistentConnection_.resume(JB)}function wu(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Xt(t,...e)}function Co(n,e,t,r){e&&gu(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function Cee(n,e,t,r,i,s){wu(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:XU(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Tx(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Of("transaction failed: Data returned ",c,o.path),o.status=0;let l=sv(n.transactionQueueTree_,e),d=Xa(l)||[];d.push(o),Ex(l,d);let h;typeof c=="object"&&c!==null&&Dn(c,".priority")?(h=Us(c,".priority"),z(Df(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(rv(n.serverSyncTree_,e)||ye.EMPTY_NODE).getPriority().val();let p=Lf(n),_=_t(c,h),E=vx(_,a,p);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=E,o.currentWriteId=lv(n);let A=mx(n.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);ar(n.eventQueue_,e,A),uv(n,n.transactionQueueTree_)}}function Tx(n,e,t){return rv(n.serverSyncTree_,e,t)||ye.EMPTY_NODE}function uv(n,e=n.transactionQueueTree_){if(e||dv(n,e),Xa(e)){let t=tj(n,e);z(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&Tee(n,Mf(e),t)}else zB(e)&&ov(e,t=>{uv(n,t)})}function Tee(n,e,t){let r=t.map(l=>l.currentWriteId),i=Tx(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];z(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=Mn(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{wu(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let h=[];for(let p=0;p<t.length;p++)t[p].status=2,d=d.concat(yo(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&h.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();dv(n,sv(n.transactionQueueTree_,e)),uv(n,n.transactionQueueTree_),ar(n.eventQueue_,e,d);for(let p=0;p<h.length;p++)gu(h[p])}else{if(l==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{vn("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=l}pu(n,e)}},o)}function pu(n,e){let t=ej(n,e),r=Mf(t),i=tj(n,t);return See(n,i,r),r}function See(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=Mn(t,c.path),d=!1,h;if(z(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(yo(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=fee)d=!0,h="maxretry",i=i.concat(yo(n.serverSyncTree_,c.currentWriteId,!0));else{let p=Tx(n,c.path,o);c.currentInputSnapshot=p;let _=e[a].update(p.val());if(_!==void 0){Of("transaction failed: Data returned ",_,c.path);let E=_t(_);typeof _=="object"&&_!=null&&Dn(_,".priority")||(E=E.updatePriority(p.getPriority()));let R=c.currentWriteId,U=Lf(n),J=vx(E,p,U);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=J,c.currentWriteId=lv(n),o.splice(o.indexOf(R),1),i=i.concat(mx(n.serverSyncTree_,c.path,J,c.currentWriteId,c.applyLocally)),i=i.concat(yo(n.serverSyncTree_,R,!0))}else d=!0,h="nodata",i=i.concat(yo(n.serverSyncTree_,c.currentWriteId,!0))}ar(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}dv(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)gu(r[a]);uv(n,n.transactionQueueTree_)}function ej(n,e){let t,r=n.transactionQueueTree_;for(t=Ie(e);t!==null&&Xa(r)===void 0;)r=sv(r,t),e=tt(e),t=Ie(e);return r}function tj(n,e){let t=[];return nj(n,e,t),t.sort((r,i)=>r.order-i.order),t}function nj(n,e,t){let r=Xa(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);ov(e,i=>{nj(n,i,t)})}function dv(n,e){let t=Xa(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,Ex(e,t.length>0?t:void 0)}ov(e,r=>{dv(n,r)})}function Sx(n,e){let t=Mf(ej(n,e)),r=sv(n.transactionQueueTree_,e);return see(r,i=>{QD(n,i)}),QD(n,r),qB(r,i=>{QD(n,i)}),t}function QD(n,e){let t=Xa(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(z(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(z(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(yo(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Ex(e,void 0):t.length=s+1,ar(n.eventQueue_,Mf(e),i);for(let o=0;o<r.length;o++)gu(r[o])}}function Dee(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Aee(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):vn(`Invalid query segment '${t}' in query '${n}'`)}return e}var jA=function(n,e){let t=xee(n),r=t.namespace;t.domain==="firebase.com"&&Vi(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Vi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||sX();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Dy(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new ze(t.pathString)}},xee=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(d,h)),d<h&&(i=Dee(n.substring(d,h)));let p=Aee(n.substring(Math.min(n.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let _=e.slice(0,l);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),t=e.substring(E+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var YU="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ree=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=YU.charAt(t%64),t=Math.floor(t/64);z(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=YU.charAt(e[i]);return z(o.length===20,"nextPushId: Length should be 20."),o}}();var Gy=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Pt(this.snapshot.exportVal())}},Wy=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Af=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return z(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Ky=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new zt;return vee(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){or("OnDisconnect.remove",this._path);let e=new zt;return QU(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){or("OnDisconnect.set",this._path),Bi("OnDisconnect.set",e,this._path,!1);let t=new zt;return QU(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){or("OnDisconnect.setWithPriority",this._path),Bi("OnDisconnect.setWithPriority",e,this._path,!1),Ix("OnDisconnect.setWithPriority",t,!1);let r=new zt;return wee(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){or("OnDisconnect.update",this._path),WB("OnDisconnect.update",e,this._path,!1);let t=new zt;return Eee(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var Fn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return be(this._path)?null:ix(this._path)}get ref(){return new cr(this._repo,this._path)}get _queryIdentifier(){let e=FU(this._queryParams),t=nx(e);return t==="{}"?"default":t}get _queryObject(){return FU(this._queryParams)}isEqual(e){if(e=K(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=sx(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+LX(this._path)}};function hv(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function So(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Li){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Eo)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==ps)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===ot){if(e!=null&&!Df(e)||t!=null&&!Df(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(z(n.getIndex()instanceof yf||n.getIndex()===cx,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function fv(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var cr=class n extends Fn{constructor(e,t){super(e,t,new If,!1)}get parent(){let e=vB(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},mu=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new ze(e),r=To(this.ref,e);return new n(this._node.getChild(t),r,ot)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,To(this.ref,r),ot)))}hasChild(e){let t=new ze(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Dx(n,e){return n=K(n),n._checkNotDeleted("ref"),e!==void 0?To(n._root,e):n._root}function Ax(n,e){n=K(n),n._checkNotDeleted("refFromURL");let t=jA(e,n._repo.repoInfo_.nodeAdmin);KB("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Vi("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Dx(n,t.path.toString())}function To(n,e){return n=K(n),Ie(n._path)===null?dee("child","path",e,!1):vu("child","path",e,!1),new cr(n._repo,ht(n._path,e))}function rj(n,e){n=K(n),or("push",n._path),Bi("push",e,n._path,!0);let t=XB(n._repo),r=Ree(t),i=To(n,r),s=To(n,r),o;return e!=null?o=pv(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function ij(n){return or("remove",n._path),pv(n,null)}function pv(n,e){n=K(n),or("set",n._path),Bi("set",e,n._path,!1);let t=new zt;return Cx(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function sj(n,e){n=K(n),or("setPriority",n._path),Ix("setPriority",e,!1);let t=new zt;return Cx(n._repo,ht(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function oj(n,e,t){if(or("setWithPriority",n._path),Bi("setWithPriority",e,n._path,!1),Ix("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new zt;return Cx(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function aj(n,e){WB("update",e,n._path,!1);let t=new zt;return _ee(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function cj(n){n=K(n);let e=new Af(()=>{}),t=new xf(e);return gee(n._repo,n,t).then(r=>new mu(r,new cr(n._repo,n._path),n._queryParams.getIndex()))}var xf=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new Gy("value",this,new mu(e.snapshotNode,new cr(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Wy(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Qy=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Wy(this,e,t):null}createEvent(e,t){z(e.childName!=null,"Child events should have a childName.");let r=To(new cr(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Gy(e.type,this,new mu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Vf(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,h)=>{BA(n._repo,n,a),c(d,h)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Af(t,s||void 0),a=e==="value"?new xf(o):new Qy(e,o);return Iee(n._repo,n,a),()=>BA(n._repo,n,a)}function mv(n,e,t,r){return Vf(n,"value",e,t,r)}function xx(n,e,t,r){return Vf(n,"child_added",e,t,r)}function Rx(n,e,t,r){return Vf(n,"child_changed",e,t,r)}function kx(n,e,t,r){return Vf(n,"child_moved",e,t,r)}function Nx(n,e,t,r){return Vf(n,"child_removed",e,t,r)}function Px(n,e,t){let r=null,i=t?new Af(t):null;e==="value"?r=new xf(i):e&&(r=new Qy(e,i)),BA(n._repo,n,r)}var lr=class{},Yy=class extends lr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Bi("endAt",this._value,e._path,!0);let t=_A(e._queryParams,this._value,this._key);if(fv(t),So(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Fn(e._repo,e._path,t,e._orderByCalled)}};function lj(n,e){return Ff("endAt","key",e,!0),new Yy(n,e)}var $A=class extends lr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Bi("endBefore",this._value,e._path,!1);let t=nZ(e._queryParams,this._value,this._key);if(fv(t),So(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Fn(e._repo,e._path,t,e._orderByCalled)}};function uj(n,e){return Ff("endBefore","key",e,!0),new $A(n,e)}var Jy=class extends lr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Bi("startAt",this._value,e._path,!0);let t=gA(e._queryParams,this._value,this._key);if(fv(t),So(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Fn(e._repo,e._path,t,e._orderByCalled)}};function dj(n=null,e){return Ff("startAt","key",e,!0),new Jy(n,e)}var HA=class extends lr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Bi("startAfter",this._value,e._path,!1);let t=tZ(e._queryParams,this._value,this._key);if(fv(t),So(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Fn(e._repo,e._path,t,e._orderByCalled)}};function hj(n,e){return Ff("startAfter","key",e,!0),new HA(n,e)}var zA=class extends lr{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Fn(e._repo,e._path,ZX(e._queryParams,this._limit),e._orderByCalled)}};function fj(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new zA(n)}var qA=class extends lr{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Fn(e._repo,e._path,eZ(e._queryParams,this._limit),e._orderByCalled)}};function pj(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new qA(n)}var GA=class extends lr{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){hv(e,"orderByChild");let t=new ze(this._path);if(be(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new yf(t),i=Zy(e._queryParams,r);return So(i),new Fn(e._repo,e._path,i,!0)}};function mj(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return vu("orderByChild","path",n,!1),new GA(n)}var WA=class extends lr{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){hv(e,"orderByKey");let t=Zy(e._queryParams,Li);return So(t),new Fn(e._repo,e._path,t,!0)}};function gj(){return new WA}var KA=class extends lr{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){hv(e,"orderByPriority");let t=Zy(e._queryParams,ot);return So(t),new Fn(e._repo,e._path,t,!0)}};function _j(){return new KA}var QA=class extends lr{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){hv(e,"orderByValue");let t=Zy(e._queryParams,cx);return So(t),new Fn(e._repo,e._path,t,!0)}};function yj(){return new QA}var YA=class extends lr{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Bi("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Yy(this._value,this._key)._apply(new Jy(this._value,this._key)._apply(e))}};function vj(n,e){return Ff("equalTo","key",e,!0),new YA(n,e)}function Ar(n,...e){let t=K(n);for(let r of e)t=r._apply(t);return t}LZ(cr);$Z(cr);var kee="FIREBASE_DATABASE_EMULATOR_HOST",JA={},Nee=!1;function Pee(n,e,t,r){n.repoInfo_=new Dy(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function Mx(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Vi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Xt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=jA(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[kee]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=jA(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new hf(hf.OWNER):new tA(n.name,n.options,e);KB("Invalid Firebase Database URL",o),be(o.path)||Vi("Database URL must point to the root of a Firebase Database (not including a child path).");let h=Oee(a,n,d,new eA(n.name,t));return new XA(h,n)}function Mee(n,e){let t=JA[e];(!t||t[n.key]!==n)&&Vi(`Database ${e}(${n.repoInfo_}) has already been deleted.`),ZB(n),delete t[n.key]}function Oee(n,e,t,r){let i=JA[e.name];i||(i={},JA[e.name]=i);let s=i[n.toURLString()];return s&&Vi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new UA(n,Nee,t,r),i[n.toURLString()]=s,s}var XA=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(pee(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new cr(this._repo,He())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Mee(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Vi("Cannot call "+e+" on a deleted database.")}};function wj(){yB.IS_TRANSPORT_INITIALIZED&&vn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Ej(){wj(),gf.forceDisallow()}function Ij(){wj(),su.forceDisallow(),gf.forceAllow()}function bj(n,e,t,r={}){n=K(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Vi("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Vi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new hf(hf.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Gc(r.mockUserToken,n.app.options.projectId);s=new hf(o)}Pee(i,e,t,s)}function Cj(n){n=K(n),n._checkNotDeleted("goOffline"),ZB(n._repo)}function Tj(n){n=K(n),n._checkNotDeleted("goOnline"),bee(n._repo)}function Sj(n,e){eB(n,e)}function Fee(n){tx(xn),An(new Ye("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Mx(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),Tt(vU,wU,n),Tt(vU,wU,"esm2017")}var Lee={".sv":"timestamp"};function Dj(){return Lee}function Aj(n){return{".sv":{increment:n}}}var ZA=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function xj(n,e,t){var r;if(n=K(n),or("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new zt,o=(c,l,d)=>{let h=null;c?s.reject(c):(h=new mu(d,new cr(n._repo,n._path),ot),s.resolve(new ZA(l,h)))},a=mv(n,()=>{});return Cee(n._repo,n._path,e,o,a,i),s.promise}ox.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};ox.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};Fee();var Vee="@firebase/database-compat",Uee="1.0.5";var Bee=new Wn("@firebase/database-compat"),Rj=function(n){let e="FIREBASE WARNING: "+n;Bee.warn(e)};var jee=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(pn(n,e)+"must be a boolean.")},$ee=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(pn(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var Ox=class{constructor(e){this._delegate=e}cancel(e){ue("OnDisconnect.cancel",0,1,arguments.length),qt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ue("OnDisconnect.remove",0,1,arguments.length),qt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ue("OnDisconnect.set",1,2,arguments.length),qt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ue("OnDisconnect.setWithPriority",2,3,arguments.length),qt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ue("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Rj("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var Fx=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ue("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Za=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ue("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ue("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ue("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ue("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ue("DataSnapshot.child",0,1,arguments.length),e=String(e),vu("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ue("DataSnapshot.hasChild",1,1,arguments.length),vu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ue("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ue("DataSnapshot.forEach",1,1,arguments.length),qt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ue("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ue("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ue("DataSnapshot.ref",0,0,arguments.length),new ms(this._database,this._delegate.ref)}get ref(){return this.getRef()}},gv=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ue("Query.on",2,4,arguments.length),qt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new Za(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return mv(this._delegate,a,c),t;case"child_added":return xx(this._delegate,a,c),t;case"child_removed":return Nx(this._delegate,a,c),t;case"child_changed":return Rx(this._delegate,a,c),t;case"child_moved":return kx(this._delegate,a,c),t;default:throw new Error(pn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ue("Query.off",0,3,arguments.length),$ee("Query.off",e,!0),qt("Query.off","callback",t,!0),DI("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,Px(this._delegate,e,i)}else Px(this._delegate,e)}get(){return cj(this._delegate).then(e=>new Za(this.database,e))}once(e,t,r,i){ue("Query.once",1,4,arguments.length),qt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new zt,a=(l,d)=>{let h=new Za(this.database,l);t&&t.call(s.context,h,d),o.resolve(h)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":mv(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":xx(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":Nx(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":Rx(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":kx(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(pn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ue("Query.limitToFirst",1,1,arguments.length),new n(this.database,Ar(this._delegate,fj(e)))}limitToLast(e){return ue("Query.limitToLast",1,1,arguments.length),new n(this.database,Ar(this._delegate,pj(e)))}orderByChild(e){return ue("Query.orderByChild",1,1,arguments.length),new n(this.database,Ar(this._delegate,mj(e)))}orderByKey(){return ue("Query.orderByKey",0,0,arguments.length),new n(this.database,Ar(this._delegate,gj()))}orderByPriority(){return ue("Query.orderByPriority",0,0,arguments.length),new n(this.database,Ar(this._delegate,_j()))}orderByValue(){return ue("Query.orderByValue",0,0,arguments.length),new n(this.database,Ar(this._delegate,yj()))}startAt(e=null,t){return ue("Query.startAt",0,2,arguments.length),new n(this.database,Ar(this._delegate,dj(e,t)))}startAfter(e=null,t){return ue("Query.startAfter",0,2,arguments.length),new n(this.database,Ar(this._delegate,hj(e,t)))}endAt(e=null,t){return ue("Query.endAt",0,2,arguments.length),new n(this.database,Ar(this._delegate,lj(e,t)))}endBefore(e=null,t){return ue("Query.endBefore",0,2,arguments.length),new n(this.database,Ar(this._delegate,uj(e,t)))}equalTo(e,t){return ue("Query.equalTo",1,2,arguments.length),new n(this.database,Ar(this._delegate,vj(e,t)))}toString(){return ue("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ue("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ue("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,qt(e,"cancel",i.cancel,!0),i.context=r,DI(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(pn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new ms(this.database,new cr(this._delegate._repo,this._delegate._path))}},ms=class n extends gv{constructor(e,t){super(e,new Fn(t._repo,t._path,new If,!1)),this.database=e,this._delegate=t}getKey(){return ue("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ue("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,To(this._delegate,e))}getParent(){ue("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ue("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ue("Reference.set",1,2,arguments.length),qt("Reference.set","onComplete",t,!0);let r=pv(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ue("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Rj("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}or("Reference.update",this._delegate._path),qt("Reference.update","onComplete",t,!0);let r=aj(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ue("Reference.setWithPriority",2,3,arguments.length),qt("Reference.setWithPriority","onComplete",r,!0);let i=oj(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ue("Reference.remove",0,1,arguments.length),qt("Reference.remove","onComplete",e,!0);let t=ij(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ue("Reference.transaction",1,3,arguments.length),qt("Reference.transaction","transactionUpdate",e,!1),qt("Reference.transaction","onComplete",t,!0),jee("Reference.transaction","applyLocally",r,!0);let i=xj(this._delegate,e,{applyLocally:r}).then(s=>new Fx(s.committed,new Za(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ue("Reference.setPriority",1,2,arguments.length),qt("Reference.setPriority","onComplete",t,!0);let r=sj(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ue("Reference.push",0,2,arguments.length),qt("Reference.push","onComplete",t,!0);let r=rj(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return or("Reference.onDisconnect",this._delegate._path),new Ox(new Ky(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var ec=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Ej,forceLongPolling:Ij}}useEmulator(e,t,r={}){bj(this._delegate,e,t,r)}ref(e){if(ue("database.ref",0,1,arguments.length),e instanceof ms){let t=Ax(this._delegate,e.toString());return new ms(this,t)}else{let t=Dx(this._delegate,e);return new ms(this,t)}}refFromURL(e){ue("database.refFromURL",1,1,arguments.length);let r=Ax(this._delegate,e);return new ms(this,r)}goOffline(){return ue("database.goOffline",0,0,arguments.length),Cj(this._delegate)}goOnline(){return ue("database.goOnline",0,0,arguments.length),Tj(this._delegate)}};ec.ServerValue={TIMESTAMP:Dj(),increment:n=>Aj(n)};function Hee({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){tx(t);let a=new $s("database-standalone"),c=new ta("auth-internal",a);c.setComponent(new Ye("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new ta("app-check-internal",a),l.setComponent(new Ye("app-check-internal",()=>i,"PRIVATE"))),{instance:new ec(Mx(n,c,l,e,o),n),namespace:s}}var zee=Object.freeze({__proto__:null,initStandalone:Hee});var qee=ec.ServerValue;function Gee(n){n.INTERNAL.registerComponent(new Ye("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new ec(i,r)},"PUBLIC").setServiceProps({Reference:ms,Query:gv,Database:ec,DataSnapshot:Za,enableLogging:Sj,INTERNAL:zee,ServerValue:qee}).setMultipleInstances(!0)),n.registerVersion(Vee,Uee)}Gee(L);var Wee="firebase",Kee="10.12.2";L.registerVersion(Wee,Kee,"app-compat");var Ke=(()=>{let e=class e{constructor(r){this.router=r,this.isUserLogged=!1,this.sidebarOpen=!1,this.currentSectorId="",this.linkObject={},this.linkCounter=0,this.ticketLinkObject={},this.ticketLinkCounter=0,this.ticketToRead=!1,this.isAdmin=!1}getUserData(){L.auth().onAuthStateChanged(r=>{r?(this.isUserLogged=!0,L.firestore().collection("users_data").doc(r.uid).get().then(i=>{if(i.exists){var s=i.data();this.currentUser=s}else this.presentToast("Nessun utente trovato"),this.router.navigate(["/login"])}).catch(i=>{this.presentToast("Errore durante il recupero dell'utente:"+i.message)})):(this.isUserLogged=!1,console.log("Nessun utente loggato."),this.router.navigate(["/login"]))})}convertTimestamp(r){let i=new Date(r),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getFullYear()),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}/${o}/${a} ${c}:${l}:${d}`}presentToast(r,i=3e3){let s=document.createElement("div");s.className="toast",s.textContent=r,document.body.appendChild(s),requestAnimationFrame(()=>s.classList.add("show")),setTimeout(()=>{s.classList.remove("show"),s.addEventListener("transitionend",()=>s.remove(),{once:!0})},i)}openCloseSidebar(){this.sidebarOpen==!0?this.sidebarOpen=!1:this.sidebarOpen=!0}animate1(r){var i=document.getElementById(r),s=[{opacity:0},{opacity:1}],o={duration:150,easing:"ease-in-out"};i.animate(s,o)}animateFadeOut(r){var i=document.getElementById(r),s=[{opacity:1},{opacity:0}],o={duration:150,easing:"ease-out"};i.animate(s,o)}getOpenTicketsNumber(){return g(this,null,function*(){let r=Tr(L.firestore(),"tickets"),i=Yn(r,Va("status","==","open")),s=yield Ua(i);document.getElementById("open-tickets-sidebar-display").innerText=s.data().count+"",s.data().count!=0?document.getElementById("open-tickets-counter-container").style.display="flex":document.getElementById("open-tickets-counter-container").style.display="none"})}};e.\u0275fac=function(i){return new(i||e)(le(it))},e.\u0275prov=ce({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Uj=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(Z(Ji),Z(li))},e.\u0275dir=dn({type:e});let n=e;return n})(),jx=(()=>{let e=class e extends Uj{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wo(e)))(s||e)}})(),e.\u0275dir=dn({type:e,features:[Rs]});let n=e;return n})(),wv=new de("");var Qee={provide:wv,useExisting:qo(()=>Iu),multi:!0};function Yee(){let n=di()?di().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Jee=new de(""),Iu=(()=>{let e=class e extends Uj{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Yee())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(Z(Ji),Z(li),Z(Jee,8))},e.\u0275dir=dn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&j("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[ud([Qee]),Rs]});let n=e;return n})();var Xee=new de(""),Zee=new de("");function Bj(n){return n!=null}function jj(n){return Ns(n)?ft(n):n}function $j(n){let e={};return n.forEach(t=>{e=t!=null?q(q({},e),t):e}),Object.keys(e).length===0?null:e}function Hj(n,e){return e.map(t=>t(n))}function ete(n){return!n.validate}function zj(n){return n.map(e=>ete(e)?e:t=>e.validate(t))}function tte(n){if(!n)return null;let e=n.filter(Bj);return e.length==0?null:function(t){return $j(Hj(t,e))}}function qj(n){return n!=null?tte(zj(n)):null}function nte(n){if(!n)return null;let e=n.filter(Bj);return e.length==0?null:function(t){let r=Hj(t,e).map(jj);return hw(r).pipe(xe($j))}}function Gj(n){return n!=null?nte(zj(n)):null}function kj(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function rte(n){return n._rawValidators}function ite(n){return n._rawAsyncValidators}function Lx(n){return n?Array.isArray(n)?n:[n]:[]}function yv(n,e){return Array.isArray(n)?n.includes(e):n===e}function Nj(n,e){let t=Lx(e);return Lx(n).forEach(i=>{yv(t,i)||t.push(i)}),t}function Pj(n,e){return Lx(e).filter(t=>!yv(n,t))}var vv=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=qj(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Gj(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Vx=class extends vv{get formDirective(){return null}get path(){return null}},jf=class extends vv{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ux=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},ste={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Dhe=Qe(q({},ste),{"[class.ng-submitted]":"isSubmitted"}),Ev=(()=>{let e=class e extends Ux{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Z(jf,2))},e.\u0275dir=dn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&tE("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Rs]});let n=e;return n})();var Uf="VALID",_v="INVALID",Eu="PENDING",Bf="DISABLED";function ote(n){return(Iv(n)?n.validators:n)||null}function ate(n){return Array.isArray(n)?qj(n):n||null}function cte(n,e){return(Iv(e)?e.asyncValidators:n)||null}function lte(n){return Array.isArray(n)?Gj(n):n||null}function Iv(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var Bx=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Uf}get invalid(){return this.status===_v}get pending(){return this.status==Eu}get disabled(){return this.status===Bf}get enabled(){return this.status!==Bf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Nj(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Nj(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Pj(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Pj(e,this._rawAsyncValidators))}hasValidator(e){return yv(this._rawValidators,e)}hasAsyncValidator(e){return yv(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Eu,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Bf,this.errors=null,this._forEachChild(r=>{r.disable(Qe(q({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Qe(q({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Uf,this._forEachChild(r=>{r.enable(Qe(q({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Qe(q({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Uf||this.status===Eu)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Bf:Uf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Eu,this._hasOwnPendingAsyncValidator=!0;let t=jj(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ht,this.statusChanges=new Ht}_calculateStatus(){return this._allControlsDisabled()?Bf:this.errors?_v:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Eu)?Eu:this._anyControlsHaveStatus(_v)?_v:Uf}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Iv(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=ate(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=lte(this._rawAsyncValidators)}};var Wj=new de("CallSetDisabledState",{providedIn:"root",factory:()=>$x}),$x="always";function ute(n,e){return[...e.path,n]}function dte(n,e,t=$x){fte(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),pte(n,e),gte(n,e),mte(n,e),hte(n,e)}function Mj(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function hte(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function fte(n,e){let t=rte(n);e.validator!==null?n.setValidators(kj(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=ite(n);e.asyncValidator!==null?n.setAsyncValidators(kj(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Mj(e._rawValidators,i),Mj(e._rawAsyncValidators,i)}function pte(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Kj(n,e)})}function mte(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Kj(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Kj(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function gte(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function _te(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function yte(n){return Object.getPrototypeOf(n.constructor)===jx}function vte(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===Iu?t=s:yte(s)?r=s:i=s}),i||r||t||null}function Oj(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Fj(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var wte=class extends Bx{constructor(e=null,t,r){super(ote(t),cte(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Iv(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Fj(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Oj(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Oj(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Fj(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Ete={provide:jf,useExisting:qo(()=>$f)},Lj=Promise.resolve(),$f=(()=>{let e=class e extends jf{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new wte,this._registered=!1,this.name="",this.update=new Ht,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=vte(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),_te(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){dte(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Lj.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Qo(i);Lj.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?ute(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(Z(Vx,9),Z(Xee,10),Z(Zee,10),Z(wv,10),Z(Ps,8),Z(Wj,8))},e.\u0275dir=dn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Tn.None,"disabled","isDisabled"],model:[Tn.None,"ngModel","model"],options:[Tn.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ud([Ete]),Rs,Go]});let n=e;return n})();var Ite={provide:wv,useExisting:qo(()=>Yj),multi:!0};function Qj(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function bte(n){return n.split(":")[0]}var Yj=(()=>{let e=class e extends jx{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=Qj(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=bte(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wo(e)))(s||e)}})(),e.\u0275dir=dn({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&j("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[ud([Ite]),Rs]});let n=e;return n})(),bv=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(Qj(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(Z(li),Z(Ji),Z(Yj,9))},e.\u0275dir=dn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})(),Cte={provide:wv,useExisting:qo(()=>Jj),multi:!0};function Vj(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function Tte(n){return n.split(":")[0]}var Jj=(()=>{let e=class e extends jx{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let l=a[c],d=this._getOptionValue(l.value);s.push(d)}}else{let a=i.options;for(let c=0;c<a.length;c++){let l=a[c];if(l.selected){let d=this._getOptionValue(l.value);s.push(d)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=Tte(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Wo(e)))(s||e)}})(),e.\u0275dir=dn({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&j("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[ud([Cte]),Rs]});let n=e;return n})(),Cv=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Vj(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Vj(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(Z(li),Z(Ji),Z(Jj,9))},e.\u0275dir=dn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let n=e;return n})();var Ste=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({});let n=e;return n})();var Xj=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:Wj,useValue:r.callSetDisabledState??$x}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({imports:[Ste]});let n=e;return n})();var Zj=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.email="",this.password=""}ngOnInit(){}login(){L.auth().signInWithEmailAndPassword(this.email,this.password).then(r=>{var i=r.user;this.generalService.presentToast("Login effettuato con successo"),this.router.navigate(["/company"])}).catch(r=>{if(r.code=="auth/invalid-credential"){this.generalService.presentToast("Email o password non validi");return}this.generalService.presentToast("Errore durante il login: "+r.message)})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-login"]],decls:40,vars:2,consts:[[2,"height","100%","width","100%","display","flex","flex-wrap","wrap","flex-direction","row","overflow-y","auto","overflow-x","hidden"],[1,"desktop-element",2,"flex","1","max-width","40rem","min-width","20rem","border-right","1px solid rgba(0, 0, 0, 0.122)","overflow","hidden","position","relative"],["src","assets/imgs/photo1.jpeg",2,"height","100%","width","100%","object-fit","cover"],[2,"display","flex","flex-direction","column","align-items","center","justify-content","center","position","absolute","top","0","left","0","width","100%","height","100%","background-color","rgba(71, 69, 69, 0.72)"],[2,"width","100%","max-width","30rem"],[2,"margin","1rem"],[2,"color","white","margin-bottom","0.8rem"],[2,"color","white","margin-top","0rem"],[1,"button-action"],[2,"flex","1","min-width","20rem","display","flex","flex-direction","column","align-items","center","justify-content","center"],[1,"mobile-element",2,"width","100%","display","flex","flex-direction","row","align-items","center","justify-content","start"],["src","assets\\imgs\\movysoft.png","alt","Movysoft logo",2,"width","10rem","margin-left","0.5rem"],[2,"flex","1"],[2,"width","100%","max-width","33rem"],[2,"padding-left","1rem","padding-right","1rem","height","100%","display","flex","flex-direction","column","gap","1rem"],[2,"margin-bottom","0rem"],[1,"inputGroup"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem"],["type","text","id","login-email-input","placeholder","Email",1,"input",3,"ngModelChange","ngModel"],["type","password","id","login-password-input","placeholder","Password",1,"input",3,"ngModelChange","ngModel"],[2,"width","100%"],[1,"button-action",2,"width","100%",3,"click"],["routerLink","/change-password"],["routerLink","/register"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1),te(2,"img",2),v(3,"div",3)(4,"div",4)(5,"div",5)(6,"h1",6),I(7,"Migliora la produttivit\xE0"),w(),v(8,"p",7),I(9,"Osserva come le aziende utilizzano le infrastutture digitali per ottimizzare i processi e migliorare l'organizzazione interna"),w(),v(10,"button",8),I(11,"Case studies"),w()()()()(),v(12,"div",9)(13,"div",10),te(14,"img",11),w(),te(15,"div",12),v(16,"div",13)(17,"div",14)(18,"h2",15),I(19,"Effettua l'accesso"),w(),v(20,"div",16)(21,"span",17),I(22,"mail"),w(),v(23,"input",18),Vr("ngModelChange",function(a){return ui(s.email,a)||(s.email=a),a}),w()(),v(24,"div",16)(25,"span",17),I(26,"key"),w(),v(27,"input",19),Vr("ngModelChange",function(a){return ui(s.password,a)||(s.password=a),a}),w()(),v(28,"div",20)(29,"button",21),j("click",function(){return s.login()}),I(30,"Accedi"),w(),v(31,"p"),I(32,"Password dimenticata? "),v(33,"a",22),I(34,"Vai al reset"),w()()(),v(35,"p"),I(36,"Non hai un account? "),v(37,"a",23),I(38,"Registrati"),w()()()(),te(39,"div",12),w()()),i&2&&(F(23),Lr("ngModel",s.email),F(4),Lr("ngModel",s.password))},dependencies:[Iu,Ev,$f,Hc]});let n=e;return n})();var e$=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.name="",this.surname="",this.companyName="",this.email="",this.password="",this.confirmPassword=""}ngOnInit(){}register(){this.password==this.confirmPassword?L.auth().createUserWithEmailAndPassword(this.email,this.password).then(r=>{let i=r.user;var s=L.firestore();s.collection("users_data").doc(i.uid).set({uid:i.uid,name:this.name,surname:this.surname,companyName:this.companyName,email:this.email,registration_date:L.firestore.FieldValue.serverTimestamp()}).catch(o=>{this.generalService.presentToast("Errore nel salvataggio dei dati dell'utente durante la registrazione: "+o.message)}),this.generalService.presentToast("Registrazione completata con successo"),this.router.navigate(["/company"])}).catch(r=>{if(r.code=="auth/invalid-email"){this.generalService.presentToast("Email non valida");return}if(r.code=="auth/weak-password"){this.generalService.presentToast("Password troppo debole");return}this.generalService.presentToast("Errore durante la registrazione: "+r.message)}):this.generalService.presentToast("Le password inserite non corrispondono")}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-register"]],decls:52,vars:6,consts:[[2,"height","100%","width","100%","display","flex","flex-wrap","wrap","flex-direction","row","overflow-y","auto","overflow-x","hidden"],[1,"desktop-element",2,"flex","1","max-width","40rem","min-width","20rem","border-right","1px solid rgba(255, 255, 255, 0.122)","overflow","hidden","position","relative"],["src","assets/imgs/photo2.jpeg",2,"height","100%","width","100%","object-fit","cover"],[2,"display","flex","flex-direction","column","align-items","center","justify-content","center","position","absolute","top","0","left","0","width","100%","height","100%","background-color","rgba(71, 69, 69, 0.72)"],[2,"width","100%","max-width","30rem"],[2,"margin","1rem"],[2,"color","white","margin-bottom","0.8rem"],[2,"color","white","margin-top","0rem"],[1,"button-action"],[2,"flex","1","min-width","20rem","display","flex","flex-direction","column","align-items","center","justify-content","center"],[1,"mobile-element",2,"width","100%","display","flex","flex-direction","row","align-items","center","justify-content","start"],["src","assets\\imgs\\movysoft.png","alt","Movysoft logo",2,"width","10rem","margin-left","0.5rem"],[2,"flex","1"],[2,"width","100%","max-width","33rem"],[2,"padding-left","1rem","padding-right","1rem","display","flex","flex-direction","column","gap","1rem"],[2,"margin-bottom","0rem"],[1,"inputGroup"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem"],["type","text","id","register-company-name-input","placeholder","Ragione sociale",1,"input",3,"ngModelChange","ngModel"],[2,"width","100%","gap","1rem","display","flex","flex-direction","row","flex-wrap","wrap"],[1,"inputGroup",2,"flex","1","min-width","10rem"],["type","text","id","register-name-input","placeholder","Nome",1,"input",3,"ngModelChange","ngModel"],["type","text","id","register-surname-input","placeholder","Cognome",1,"input",3,"ngModelChange","ngModel"],["type","text","id","register-email-input","placeholder","Email",1,"input",3,"ngModelChange","ngModel"],["type","password","id","register-password-input","placeholder","Password",1,"input",3,"ngModelChange","ngModel"],["type","password","id","register-confirm-password-input","placeholder","Conferma password",1,"input",3,"ngModelChange","ngModel"],[1,"button-action",2,"width","100%",3,"click"],["routerLink","/login"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1),te(2,"img",2),v(3,"div",3)(4,"div",4)(5,"div",5)(6,"h1",6),I(7,"Migliora la produttivit\xE0"),w(),v(8,"p",7),I(9,"Osserva come le aziende utilizzano le infrastutture digitali per ottimizzare i processi e migliorare l'organizzazione interna"),w(),v(10,"button",8),I(11,"Case studies"),w()()()()(),v(12,"div",9)(13,"div",10),te(14,"img",11),w(),te(15,"div",12),v(16,"div",13)(17,"div",14)(18,"h2",15),I(19,"Esegui la registrazione"),w(),v(20,"div",16)(21,"span",17),I(22,"apartment"),w(),v(23,"input",18),Vr("ngModelChange",function(a){return ui(s.companyName,a)||(s.companyName=a),a}),w()(),v(24,"div",19)(25,"div",20)(26,"span",17),I(27,"person"),w(),v(28,"input",21),Vr("ngModelChange",function(a){return ui(s.name,a)||(s.name=a),a}),w()(),v(29,"div",20)(30,"span",17),I(31,"person"),w(),v(32,"input",22),Vr("ngModelChange",function(a){return ui(s.surname,a)||(s.surname=a),a}),w()()(),v(33,"div",16)(34,"span",17),I(35,"mail"),w(),v(36,"input",23),Vr("ngModelChange",function(a){return ui(s.email,a)||(s.email=a),a}),w()(),v(37,"div",16)(38,"span",17),I(39,"key"),w(),v(40,"input",24),Vr("ngModelChange",function(a){return ui(s.password,a)||(s.password=a),a}),w()(),v(41,"div",16)(42,"span",17),I(43,"key"),w(),v(44,"input",25),Vr("ngModelChange",function(a){return ui(s.confirmPassword,a)||(s.confirmPassword=a),a}),w()(),v(45,"button",26),j("click",function(){return s.register()}),I(46,"Registati ora"),w(),v(47,"p"),I(48,"Hai gi\xE0 un account? "),v(49,"a",27),I(50,"Accedi"),w()()()(),te(51,"div",12),w()()),i&2&&(F(23),Lr("ngModel",s.companyName),F(5),Lr("ngModel",s.name),F(4),Lr("ngModel",s.surname),F(4),Lr("ngModel",s.email),F(4),Lr("ngModel",s.password),F(4),Lr("ngModel",s.confirmPassword))},dependencies:[Iu,Ev,$f,Hc]});let n=e;return n})();function Dte(n,e){n&1&&(v(0,"div",2)(1,"p"),I(2,"Seleziona una chat"),w()())}function Ate(n,e){if(n&1){let t=Ge();v(0,"span",16),j("click",function(){Ve(t);let i=ie(2);return Ue(i.changeChat(i.chatName))}),I(1,"edit"),w()}}function xte(n,e){if(n&1){let t=Ge();v(0,"span",16),j("click",function(){Ve(t);let i=ie(2);return Ue(i.deleteChat())}),I(1,"delete"),w()}}function Rte(n,e){if(n&1){let t=Ge();v(0,"button",17),j("click",function(){Ve(t);let i=ie(2);return Ue(i.getMoreChatMessages())}),I(1,"Carica altri messaggi"),w()}}function kte(n,e){if(n&1){let t=Ge();v(0,"span",23),j("click",function(){Ve(t);let i=ie().$implicit,s=ie(2);return Ue(s.deleteMessage(i))}),I(1,"delete"),w()}}function Nte(n,e){if(n&1&&(v(0,"div",18)(1,"span",19)(2,"strong"),I(3),w(),v(4,"span"),I(5),w(),te(6,"div",20),he(7,kte,2,0,"span",21),w(),v(8,"p",22),I(9),w()()),n&2){let t=e.$implicit,r=ie(2);fn("id","chat-message-id-",t.id,""),F(3),nE("",t.creator_name," ",t.creator_surname," ",r.formatTimestamp(t.createdAt),""),F(2),rt(t.creator_agency_name),F(2),G("ngIf",r.generalService.isAdmin==!0),F(2),rt(t.message)}}function Pte(n,e){if(n&1){let t=Ge();v(0,"div",3)(1,"div",4)(2,"h2",5),I(3),w(),he(4,Ate,2,0,"span",6)(5,xte,2,0,"span",6),w(),v(6,"p",7),I(7),w(),v(8,"div",8),he(9,Rte,2,0,"button",9),v(10,"div",10),he(11,Nte,10,8,"div",11),zn(12,"async"),w()(),v(13,"div",12)(14,"input",13),j("keydown.enter",function(){Ve(t);let i=ie();return Ue(i.sendMessage())}),w(),v(15,"button",14),j("click",function(){Ve(t);let i=ie();return Ue(i.sendMessage())}),v(16,"span",15),I(17,"send"),w()()()()}if(n&2){let t=ie();F(3),rt(t.chatName),F(),G("ngIf",t.generalService.isAdmin==!0),F(),G("ngIf",t.generalService.isAdmin==!0),F(2),rt(t.chatDescription),F(2),G("ngIf",t.nextPageAvailable),F(2),G("ngForOf",qn(12,6,t.documents))}}var t$=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.route=i,this.router=s,this.chatName="",this.chatDescription="",this.showChatPlaceholder=!0,this.documents=new Ae([]),this.nextPageAvailable=!1}ngOnInit(){this.route.queryParams.subscribe(r=>{this.currentChatId=r.id,this.generalService.currentChatId=r.id,this.chatName=r.name,this.chatDescription=r.description,this.currentChatId?(this.showChatPlaceholder=!1,this.getChatMessages(),setTimeout(()=>{document.getElementById(this.currentChatId+"-to-read-messages-count").style.display="none"},1e3),this.chatName=r.name):this.showChatPlaceholder=!0})}sendMessage(){var r={creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,creator_email:this.generalService.currentUser.email,chat_id:this.currentChatId,createdAt:L.firestore.FieldValue.serverTimestamp(),message:document.getElementById("chat-message-input").value};L.firestore().collection("chat_messages").doc().set(r).then(()=>{document.getElementById("chat-message-input").value=""}).catch(i=>{this.generalService.presentToast("Errore durante l'invio del messaggio:"+i.message)})}deleteChat(){confirm("Sei sicuro di voler cancellare questa chat?")&&L.firestore().collection("chats").doc(this.currentChatId).delete().then(()=>{this.showChatPlaceholder=!0,this.generalService.presentToast("Chat eliminata con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'eliminazione della chat: "+r.message)})}changeChat(r){document.getElementById("change-chat-popup").style.display="flex",document.getElementById("change-chat-name-input").value=r,document.getElementById("change-chat-description-input").value=this.chatDescription}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}getChatMessages(){return L.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).limit(40).onSnapshot(r=>{let i=[];if(r.forEach(o=>{i.push(q({id:o.id},o.data()))}),r){var s=i.length>0?i[0]:null;s!=null&&localStorage.setItem(this.currentChatId+"-last-message-seconds-timestamp-check",s.createdAt.seconds)}i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+r.message)})}getMoreChatMessages(){!this.lastVisible||!this.nextPageAvailable||L.firestore().collection("chat_messages").orderBy("createdAt","desc").where("chat_id","==",this.currentChatId).startAfter(this.lastVisible).limit(40).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteMessage(r){confirm("Sei sicuro di voler eliminare questo messaggio?")&&(document.getElementById("chat-message-id-"+r.id).innerHTML="Messaggio eliminato",L.firestore().collection("chat_messages").doc(r.id).delete().then(()=>{this.generalService.presentToast("Messaggio eliminato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del messaggio: "+i.message)}))}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(jr),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-chat"]],decls:2,vars:2,consts:[["style","height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],["style","height: 100%; display: flex; flex-direction: column; padding-left: 1rem; overflow-x: hidden; overflow-y: hidden;",4,"ngIf"],[2,"height","100%","display","flex","flex-direction","column","align-items","center","justify-content","center","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-top","1.5rem"],["id","open-chat-name-display",2,"margin-bottom","0rem","margin-top","0rem"],["style","color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","column","gap","1rem","overflow-y","auto","height","calc(100% - 4rem)","padding-top","1rem"],["class","button",3,"click",4,"ngIf"],["id","chat-container",2,"display","flex","flex-direction","column","gap","1rem"],["class","chat-card","style","padding-top: 0.5rem;",3,"id",4,"ngFor","ngForOf"],[2,"height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem","margin-top","1rem","margin-right","1rem"],["id","chat-message-input","placeholder","Inserisci qui il tuo messaggio",2,"width","calc(100% - 3.5rem)","border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'",3,"keydown.enter"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer",3,"click"],[1,"button",3,"click"],[1,"chat-card",2,"padding-top","0.5rem",3,"id"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.2rem"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0.2rem","margin-bottom","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"]],template:function(i,s){i&1&&he(0,Dte,3,0,"div",0)(1,Pte,18,8,"div",1),i&2&&(G("ngIf",s.showChatPlaceholder==!0),F(),G("ngIf",s.showChatPlaceholder==!1))},dependencies:[mr,Wt,gr]});let n=e;return n})();var n$=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Z(Ke))},e.\u0275cmp=$e({type:e,selectors:[["app-company"]],decls:32,vars:0,consts:[[2,"height","100%","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[1,"card",2,"padding","1rem","margin-top","1rem"],[2,"display","flex","flex-direction","column","gap","0.5rem"],[2,"margin","0rem"],[2,"width","100%","max-width","45rem","margin-bottom","0rem"],[2,"width","100%","max-width","45rem","margin-top","0rem"],[2,"max-width","80%"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","flex-wrap","wrap","gap","1rem"],["href","https://www.google.com","target","_blank",1,"a_button",2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem"],[2,"margin-top","0rem","margin-bottom","0rem","color","black"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),I(4,"La nostra mission e la nostra direzione | Annuncio nuova web app"),w(),v(5,"p",4)(6,"strong"),I(7,"La nostra missione \xE8 ridefinire il settore dei servizi, stabilendoci come l'architetto di fiducia che trasforma la complessit\xE0 in chiarezza operativa."),w()(),v(8,"p",5),I(9,"Siamo nati per semplificare la complessit\xE0 che i nostri clienti affrontano quotidianamente. "),v(10,"strong"),I(11,"Il nostro impegno va oltre la semplice fornitura di servizi specifici"),w(),I(12," come consulenziali, logistici, di supporto: "),v(13,"strong"),I(14,"ci concentriamo sulla trasformazione proattiva delle sfide in tangibili opportunit\xE0 di crescita e innovazione."),w()(),v(15,"p",5)(16,"strong"),I(17,"Ogni attivit\xE0 fondamentale, necessita di uno strumento dedicato"),w(),I(18,", pertanto abbiamo il piacere di introdurvi la "),v(19,"strong"),I(20,"nuova piattaforma web aziendale che agevoler\xE0"),w(),I(21," una gestione centralizzata e chiara di "),v(22,"strong"),I(23,"tutte le attivit\xE0 e i compiti aziendali"),w()()(),te(24,"p",6),v(25,"div",7)(26,"a",8)(27,"p",9),I(28,"Sito Web | Servizi"),w()(),v(29,"a",8)(30,"p",9),I(31,"Presentazione Web App"),w()()()()())}});let n=e;return n})();function Mte(n,e){if(n&1){let t=Ge();v(0,"span",26),j("click",function(){Ve(t);let i=ie();return Ue(i.changeSector())}),I(1,"edit"),w()}}function Ote(n,e){if(n&1){let t=Ge();v(0,"span",26),j("click",function(){Ve(t);let i=ie();return Ue(i.deleteSector())}),I(1,"delete"),w()}}function Fte(n,e){if(n&1){let t=Ge();v(0,"span",41),j("click",function(){Ve(t);let i=ie().$implicit,s=ie(2);return Ue(s.deleteSectorFolder(i))}),I(1,"delete"),w()}}function Lte(n,e){if(n&1){let t=Ge();v(0,"div",37),j("click",function(){let i=Ve(t).$implicit,s=ie(2);return Ue(s.openSectorFolder(i))}),v(1,"span",38),I(2,"folder"),w(),v(3,"span",39),I(4),w(),he(5,Fte,2,0,"span",40),w()}if(n&2){let t=e.$implicit,r=ie(2);F(3),ks("id",t),F(),rt(t),F(),G("ngIf",r.generalService.isAdmin==!0)}}function Vte(n,e){if(n&1&&(v(0,"div",34)(1,"h4",35),I(2,"Cartelle:"),w(),he(3,Lte,6,3,"div",36),w()),n&2){let t=e.ngIf;F(3),G("ngForOf",t)}}function Ute(n,e){n&1&&(v(0,"div",42)(1,"p",43),I(2,"Questa cartella \xE8 vuota"),w()())}function Bte(n,e){n&1&&(v(0,"div",42)(1,"p",43),I(2,"Questo settore \xE8 vuoto (seleziona una cartella)"),w()())}function jte(n,e){if(n&1){let t=Ge();v(0,"span",53),j("click",function(){Ve(t);let i=ie().$implicit,s=ie();return Ue(s.deleteProcedura(i))}),I(1,"delete"),w()}}function $te(n,e){n&1&&(v(0,"span",57),I(1,"link"),w())}function Hte(n,e){n&1&&(v(0,"span",57),I(1,"picture_as_pdf"),w())}function zte(n,e){n&1&&(v(0,"span",57),I(1,"movie"),w())}function qte(n,e){n&1&&(v(0,"span",57),I(1,"movie"),w())}function Gte(n,e){n&1&&(v(0,"span",57),I(1,"movie"),w())}function Wte(n,e){n&1&&(v(0,"span",57),I(1,"volume_up"),w())}function Kte(n,e){if(n&1&&(v(0,"a",54)(1,"div",55),he(2,$te,2,0,"span",56)(3,Hte,2,0,"span",56)(4,zte,2,0,"span",56)(5,qte,2,0,"span",56)(6,Gte,2,0,"span",56)(7,Wte,2,0,"span",56),I(8),w()()),n&2){let t=e.$implicit,r=ie().$implicit;G("href",r.links[t].link,Yi),F(2),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("wmv")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),F(),Xi(" ",r.links[t].label," ")}}function Qte(n,e){n&1&&(v(0,"span",57),I(1,"picture_as_pdf"),w())}function Yte(n,e){n&1&&(v(0,"span",57),I(1,"movie"),w())}function Jte(n,e){n&1&&(v(0,"span",57),I(1,"movie"),w())}function Xte(n,e){n&1&&(v(0,"span",57),I(1,"movie"),w())}function Zte(n,e){n&1&&(v(0,"span",57),I(1,"volume_up"),w())}function ene(n,e){if(n&1&&(v(0,"a",54)(1,"div",55)(2,"span",57),I(3,"draft"),w(),I(4," Download "),he(5,Qte,2,0,"span",56)(6,Yte,2,0,"span",56)(7,Jte,2,0,"span",56)(8,Xte,2,0,"span",56)(9,Zte,2,0,"span",56),w()()),n&2){let t=ie().$implicit;ks("href",t.storage_resource_link,Yi),F(5),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("pdf")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp4")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mkv")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("wmv")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp3"))}}function tne(n,e){if(n&1&&(v(0,"div",44)(1,"h3",45),I(2),te(3,"div",46),he(4,jte,2,0,"span",47),w(),v(5,"h4",48),I(6),w(),v(7,"p",49),I(8),w(),v(9,"div",50),he(10,Kte,9,8,"a",51)(11,ene,10,6,"a",52),w()()),n&2){let t=e.$implicit,r=ie();fn("id","procedure-id-",t.id,""),F(2),iE(" ",t.creator_name," ",t.creator_surname," | ",t.creator_agency_name," | ",r.formatTimestamp(t.timestamp)," /",t.folder_name," "),F(2),G("ngIf",r.generalService.isAdmin==!0||r.generalService.currentUser.uid==t.creator_uid),F(2),rt(t.name),F(2),rt(t.description),F(2),G("ngForOf",r.getObjectKeys(t.links)),F(),G("ngIf",t.storage_resource_link!="")}}function nne(n,e){if(n&1){let t=Ge();v(0,"button",7),j("click",function(){Ve(t);let i=ie();return Ue(i.getMoreSectorProcedures())}),I(1,"Recupera altre procedure"),w()}}var r$=(()=>{let e=class e{constructor(r,i,s){this.generalService=r,this.router=i,this.route=s,this.documents=new Ae([]),this.lastVisible="",this.nextPageAvailable=!0,this.matchingKeys$=new Ae([]),this.isFolderEmpty=!1,this.isSectorEmpty=!1,this.downloadURL="",this.folderName=""}ngOnInit(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),document.getElementById("folder-name-indicator").innerText="",document.getElementById("sector-name").style.background="yellow",this.generalService.currentSectorId=i,document.getElementById("sector-name").innerText=s,document.getElementById("sector-description").innerText=o,this.getSectorProcedures(),this.getSectorFolders()})}getSectorProcedures(){return this.folderName="",L.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==",this.folderName).limit(4).startAfter(this.lastVisible).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,i.length==0&&(this.isFolderEmpty=!1,this.isSectorEmpty=!0),this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+r.message)})}getMoreSectorProcedures(){!this.lastVisible||!this.nextPageAvailable||L.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).orderBy("timestamp","desc").where("folder_name","==","").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}getSectorFolders(){this.matchingKeys$=new Ae([]),L.firestore().collection("sector_folders").doc("folders").get().then(r=>{if(r.exists){let i=r.data();if(this.matchingKeysUnfiltered=i,i){let s=[];for(let[o,a]of Object.entries(i))if(a===this.generalService.currentSectorId){let c=o.lastIndexOf("-"),l=c===-1?o:o.substring(0,c);s.push(l)}s.sort((o,a)=>o.localeCompare(a)),this.matchingKeys$.next(s),this.generalService.foldersNames}}else console.log("Documento non trovato!")}).catch(r=>{this.generalService.presentToast("Errore nel recuperare le cartelle di questo settore: "+r.message)})}closeAddNewProcedureFolderPopup(){document.getElementById("add-new-procedure-folder-popup").style.display="none"}addNewProcedureFolder(){let r=document.getElementById("add-procedure-folder-name-input");r.value!=""&&r.value!=" "?L.firestore().collection("sector_folders").doc("folders").set({[r.value+"-"+Date.now()]:this.generalService.currentSectorId},{merge:!0}).then(()=>{document.getElementById("add-new-procedure-folder-popup").style.display="none",this.getSectorFolders(),this.generalService.presentToast("Cartella aggiunta con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la creazione della cartella: "+i.message)}):this.generalService.presentToast("Inserire un nome per la cartella")}showAddProcedurePopup(){this.getSectorFolders(),this.generalService.linkObject={},this.generalService.linkCounter=0,this.fillFolderNameSelection(),document.getElementById("add-new-procedure-popup").style.display="flex"}fillFolderNameSelection(){let r=document.getElementById("add-procedure-folder-input");r.innerHTML='<option value="">SELEZIONA</option>',this.matchingKeys$.subscribe(i=>{i.forEach(s=>{let o=s.lastIndexOf("-"),a=o===-1?s:s.substring(0,o),c=document.createElement("option");c.value=a,c.textContent=a,r.appendChild(c)})})}showAddProcedureFolder(){document.getElementById("add-new-procedure-folder-popup").style.display="flex"}getObjectKeys(r){return r?Object.keys(r):[]}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}openSectorFolder(r){this.folderName=r,document.getElementById("folder-name-indicator").innerText="/"+r,document.querySelectorAll(".folder-class1").forEach(i=>{i.style.backgroundColor="transparent"}),document.getElementById(r).style.background="yellow",this.lastVisible="",this.documents=new Ae([]),L.firestore().collection("procedure").where("sector_id","==",this.generalService.currentSectorId).where("folder_name","==",r).orderBy("timestamp","desc").startAfter(this.lastVisible).get().then(i=>{let s=[];if(i.forEach(o=>{s.push(q({id:o.id},o.data()))}),s.length==0)this.isSectorEmpty=!1,this.isFolderEmpty=!0,this.nextPageAvailable=!1;else{this.isSectorEmpty=!1,this.isFolderEmpty=!1,this.nextPageAvailable=!1;let a=[...this.documents.getValue(),...s];this.documents.next(a)}}).catch(i=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 procedure in questo settore: "+i.message)})}showGeneralHiglight(){document.getElementById("folder-name-indicator").innerText="",document.querySelectorAll(".folder-class1").forEach(r=>{r.style.backgroundColor="transparent"}),document.getElementById("sector-name").style.background="yellow"}deleteProcedura(r){confirm("Sei sicuro di voler cancellare questa procedura e tutti i suoi allegati?")&&(document.getElementById("procedure-id-"+r.id).innerHTML="Procedura eliminata",L.firestore().collection("procedure").doc(r.id).delete().then(()=>{if(r.storage_resource_path!=""){let i=fs(L.storage(),r.storage_resource_path);nu(i).then(()=>{this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE FILE ERROR' "+s.message)}).catch(s=>{this.generalService.presentToast("Errore durante l'eliminazione della procedura: 'DELETE DOC ERROR' "+s.message)})}else this.generalService.presentToast("La procedura e i relativi allegati sono stati eliminati con successo")}))}deleteSector(){confirm("Sei sicuro di voler cancellare questo settore?")&&L.firestore().collection("settori").doc(this.generalService.currentSectorId).delete().then(()=>{this.generalService.presentToast("Settore cancellato con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la cancellazione del settore: "+r.message)})}changeSector(){this.route.queryParams.subscribe(r=>{var i=r.sector_id,s=r.sector_name,o=r.sector_description;i==null&&this.router.navigate(["/chat"]),document.getElementById("change-sector-popup").style.display="flex",document.getElementById("change-sector-popup-name-input").value=s,document.getElementById("change-sector-popup-description-input").value=o})}deleteSectorFolder(r){if(confirm("Sei sicuro di voler cancellare questa cartella?")){let s=Object.keys(this.matchingKeysUnfiltered).find(o=>o.includes(r));if(!s){this.generalService.presentToast("Nessuna cartella corrispondente trovata");return}console.log(`Chiave da eliminare: ${s}`),L.firestore().collection("sector_folders").doc("folders").update({[s]:L.firestore.FieldValue.delete()}).then(()=>{this.getSectorFolders(),this.generalService.presentToast("Cartella eliminata con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'eliminazione della cartella: "+o.message)})}}closeAddNewProcedurePopup(){document.getElementById("add-new-procedure-popup").style.display="none"}addNewProcedureLink(){let r=document.getElementById("add-procedure-label-input"),i=document.getElementById("add-procedure-link-input"),s=document.getElementById("add-procedure-links-container"),o={label:r.value,link:i.value};this.generalService.linkObject[`resource${this.generalService.linkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.linkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.linkCounter++,r.value="",i.value=""}addNewProcedure(){let r=document.getElementById("add-procedure-name-input"),i=document.getElementById("add-procedure-description-input"),s=document.getElementById("fileInput2"),o=document.getElementById("uploadProgress"),a=document.getElementById("uploadStatus"),c=document.getElementById("add-procedure-folder-input");if(s.files&&s.files.length>0){let d=s.files[0];var l="files/"+d.name+"-date"+Date.now();let h=fs(L.storage(),l),p=eu(h,d);p.on("state_changed",_=>{let E=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=E),a&&(a.textContent=`Caricamento: ${E.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{console.log("Caricamento completato su Cloud Storage"),tu(p.snapshot.ref).then(_=>{if(this.downloadURL=_,console.log("Url: "+_),a){let E={name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:L.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:this.downloadURL,storage_resource_path:l};L.firestore().collection("procedure").doc().set(E).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.generalService.presentToast("Procedura aggiunta con successo"),this.openSectorFolder(this.folderName),console.log(E)}).catch(A=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+A.message)})}})})}else L.firestore().collection("procedure").doc().set({name:r.value,description:i.value,sector_id:this.generalService.currentSectorId,folder_name:c.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,creator_agency_name:this.generalService.currentUser.agencyName,timestamp:L.firestore.FieldValue.serverTimestamp(),links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-procedure-name-input").value="",document.getElementById("add-procedure-description-input").value="",document.getElementById("add-procedure-label-input").value="",document.getElementById("add-procedure-link-input").value="",document.getElementById("add-procedure-links-container").innerHTML="",document.getElementById("add-new-procedure-popup").style.display="none",this.openSectorFolder(this.folderName),this.generalService.presentToast("Procedura aggiunta con successo")}).catch(d=>{this.generalService.presentToast("Errore durante l'aggiunta della procedura: "+d.message)})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it),Z(jr))},e.\u0275cmp=$e({type:e,selectors:[["app-settori"]],decls:65,vars:11,consts:[["id","add-new-procedure-folder-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-procedure-folder-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],[1,"button",3,"click"],["id","add-new-procedure-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","50rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-procedure-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"margin-top","-0.5rem","margin-bottom","-0.5rem","color","#333"],["id","add-procedure-folder-input",1,"inputGroup1",2,"height","2.5rem","border-radius","0.5rem"],["value",""],["id","add-procedure-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-procedure-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","uploadProgress","value","0","max","100",2,"width","100%"],["id","uploadStatus"],[2,"height","100%","overflow-y","auto","overflow-x","hidden","display","flex","flex-direction","column","padding-left","1rem","padding-right","1rem","margin-bottom","0rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.5rem","cursor","pointer","flex-wrap","wrap",3,"click"],["id","sector-name",1,"folder-class1"],["id","folder-name-indicator",2,"font-size","1rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem","flex-wrap","wrap","margin-top","0.2rem","margin-bottom","0.2rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","cursor","pointer","font-size","1.8rem",3,"click"],["style","color: black; cursor: pointer; font-size: 1.8rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],["id","sector-description",2,"margin-top","0rem"],["style","margin-bottom: 1rem;",4,"ngIf"],["style","width: 100%; display: flex; align-items: center; justify-content: center;",4,"ngIf"],["id","procedure",2,"display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button",3,"click",4,"ngIf"],[2,"margin-bottom","1rem"],[2,"margin-bottom","0.5rem","margin-top","0rem"],["style","display: flex; flex-direction: row; align-items: center; gap: 0.5rem; cursor: pointer; border-radius: 0.5rem; max-width: 50rem;",3,"click",4,"ngFor","ngForOf"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","cursor","pointer","border-radius","0.5rem","max-width","50rem",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[1,"folder-class1",3,"id"],["style","color: #333; font-size: 1.5rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem",3,"click"],[2,"width","100%","display","flex","align-items","center","justify-content","center"],[2,"width","100%","text-align","center"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem",3,"id"],[2,"margin-bottom","0.5rem","display","flex","flex-direction","row","align-items","center"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem","margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer",3,"click"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"h3",2),I(3,"Nuova cartella"),v(4,"span",3),j("click",function(){return s.closeAddNewProcedureFolderPopup()}),I(5,"close"),w()(),v(6,"div",4)(7,"div",5),te(8,"input",6),w()(),v(9,"div",2)(10,"button",7),j("click",function(){return s.closeAddNewProcedureFolderPopup()}),I(11,"Annulla"),w(),v(12,"button",7),j("click",function(){return s.addNewProcedureFolder()}),I(13,"Conferma"),w()()()(),v(14,"div",8)(15,"div",9)(16,"h3",2),I(17,"Nuova procedura"),v(18,"span",3),j("click",function(){return s.closeAddNewProcedurePopup()}),I(19,"close"),w()(),v(20,"div",4)(21,"div",5),te(22,"input",10)(23,"textarea",11),v(24,"p",12),I(25,"Cartella"),w(),v(26,"select",13),te(27,"option",14),w()(),v(28,"div",5),te(29,"input",15)(30,"input",16),v(31,"button",7),j("click",function(){return s.addNewProcedureLink()}),I(32,"Aggiungi Risorsa"),w(),te(33,"div",17)(34,"input",18)(35,"progress",19)(36,"span",20),w()(),v(37,"div",2)(38,"button",7),j("click",function(){return s.closeAddNewProcedurePopup()}),I(39,"Annulla"),w(),v(40,"button",7),j("click",function(){return s.addNewProcedure()}),I(41,"Conferma"),w()()()(),v(42,"div",21)(43,"h2",22),j("click",function(){return s.getSectorProcedures(),s.showGeneralHiglight()}),te(44,"span",23)(45,"span",24),w(),v(46,"h3",25)(47,"span",26),j("click",function(){return s.showAddProcedurePopup()}),I(48,"add_notes"),w(),I(49," | "),v(50,"span",26),j("click",function(){return s.showAddProcedureFolder()}),I(51,"create_new_folder"),w(),I(52," | "),he(53,Mte,2,0,"span",27),I(54," | "),he(55,Ote,2,0,"span",27),w(),te(56,"p",28),he(57,Vte,4,1,"div",29),zn(58,"async"),he(59,Ute,3,0,"div",30)(60,Bte,3,0,"div",30),v(61,"div",31),he(62,tne,12,12,"div",32),zn(63,"async"),he(64,nne,2,0,"button",33),w()()),i&2&&(F(53),G("ngIf",s.generalService.isAdmin==!0),F(2),G("ngIf",s.generalService.isAdmin==!0),F(2),G("ngIf",qn(58,7,s.matchingKeys$)),F(2),G("ngIf",s.isFolderEmpty==!0),F(),G("ngIf",s.isSectorEmpty==!0),F(2),G("ngForOf",qn(63,9,s.documents)),F(2),G("ngIf",s.nextPageAvailable))},dependencies:[mr,Wt,bv,Cv,gr]});let n=e;return n})();var i$=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)(Z(Ke))},e.\u0275cmp=$e({type:e,selectors:[["app-home"]],decls:1,vars:0,consts:[[2,"height","100%","padding-left","1rem","display","flex","flex-direction","row","flex-wrap","wrap"]],template:function(i,s){i&1&&te(0,"div",0)}});let n=e;return n})();function rne(n,e){if(n&1&&(v(0,"p"),I(1),w()),n&2){let t=ie(2).$implicit,r=ie();F(),rE("",t.name," ",t.surname," | ",r.convertTimestampToDate(t.timestamp.seconds)," | ",t.agencyName,"")}}function ine(n,e){if(n&1){let t=Ge();v(0,"span",24),j("click",function(){Ve(t);let i=ie(2).$implicit,s=ie();return Ue(s.openTicketMenuPopup(i))}),I(1,"more_vert"),w()}}function sne(n,e){if(n&1&&(v(0,"div",20)(1,"span",21),I(2,"account_circle"),w(),he(3,rne,2,4,"p",22),te(4,"div",13),he(5,ine,2,0,"span",23),w()),n&2){let t=ie().$implicit,r=ie();F(3),G("ngIf",t),F(2),G("ngIf",r.generalService.isAdmin==!0||r.generalService.currentUser.uid==t.creator_id)}}function one(n,e){n&1&&(v(0,"span"),I(1,"Aperto"),w())}function ane(n,e){n&1&&(v(0,"span"),I(1,"Chiuso"),w())}function cne(n,e){if(n&1&&(v(0,"h3",25),I(1),he(2,one,2,0,"span",22)(3,ane,2,0,"span",22),w()),n&2){let t=ie().$implicit;F(),Xi("",t.argomento," | "),F(),G("ngIf",t.status=="open"),F(),G("ngIf",t.status=="close")}}function lne(n,e){if(n&1&&(v(0,"p",26),I(1),w()),n&2){let t=ie().$implicit;F(),rt(t.descrizione)}}function une(n,e){n&1&&(v(0,"span",33),I(1,"link"),w())}function dne(n,e){n&1&&(v(0,"span",33),I(1,"picture_as_pdf"),w())}function hne(n,e){n&1&&(v(0,"span",33),I(1,"movie"),w())}function fne(n,e){n&1&&(v(0,"span",33),I(1,"movie"),w())}function pne(n,e){n&1&&(v(0,"span",33),I(1,"movie"),w())}function mne(n,e){n&1&&(v(0,"span",33),I(1,"volume_up"),w())}function gne(n,e){if(n&1&&(v(0,"a",30)(1,"div",31),he(2,une,2,0,"span",32)(3,dne,2,0,"span",32)(4,hne,2,0,"span",32)(5,fne,2,0,"span",32)(6,pne,2,0,"span",32)(7,mne,2,0,"span",32),I(8),w()()),n&2){let t=e.$implicit,r=ie(2).$implicit;G("href",r.links[t].link,Yi),F(2),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes(".com")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("pdf")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp4")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mkv")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("wmv")),F(),G("ngIf",r.links[t]==null||r.links[t].link==null?null:r.links[t].link.includes("mp3")),F(),Xi(" ",r.links[t].label," ")}}function _ne(n,e){n&1&&(v(0,"span",33),I(1,"picture_as_pdf"),w())}function yne(n,e){n&1&&(v(0,"span",33),I(1,"movie"),w())}function vne(n,e){n&1&&(v(0,"span",33),I(1,"movie"),w())}function wne(n,e){n&1&&(v(0,"span",33),I(1,"movie"),w())}function Ene(n,e){n&1&&(v(0,"span",33),I(1,"volume_up"),w())}function Ine(n,e){if(n&1&&(v(0,"a",30)(1,"div",31)(2,"span",33),I(3,"draft"),w(),I(4," Download "),he(5,_ne,2,0,"span",32)(6,yne,2,0,"span",32)(7,vne,2,0,"span",32)(8,wne,2,0,"span",32)(9,Ene,2,0,"span",32),w()()),n&2){let t=ie(2).$implicit;ks("href",t.storage_resource_link,Yi),F(5),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("pdf")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp4")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mkv")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("wmv")),F(),G("ngIf",t.storage_resource_link==null?null:t.storage_resource_link.includes("mp3"))}}function bne(n,e){if(n&1&&(v(0,"div",27),he(1,gne,9,8,"a",28)(2,Ine,10,6,"a",29),w()),n&2){let t=ie().$implicit,r=ie();F(),G("ngForOf",r.getObjectKeys(t.links)),F(),G("ngIf",t.storage_resource_link!="")}}function Cne(n,e){if(n&1){let t=Ge();v(0,"div",34)(1,"div",35)(2,"div",36)(3,"span",37),I(4,"forum"),w(),v(5,"input",38),j("keydown.enter",function(){Ve(t);let i=ie().$implicit,s=ie();return Ue(s.addComment(i))}),w()(),v(6,"button",39),j("click",function(){Ve(t);let i=ie().$implicit,s=ie();return Ue(s.addComment(i))}),v(7,"span",40),I(8,"send"),w()()(),v(9,"p",41),j("click",function(){Ve(t);let i=ie().$implicit,s=ie();return Ue(s.getComments(i))}),v(10,"span",42),I(11,"keyboard_arrow_down"),w(),I(12," Vedi risposte "),w(),te(13,"div",43),w()}if(n&2){let t=ie().$implicit;F(5),fn("id","comment-input-",t.id,""),F(5),fn("id","comment-section-arrow-icon-",t.id,""),F(3),fn("id","comment-section-",t.id,"")}}function Tne(n,e){if(n&1&&(v(0,"div",14),he(1,sne,6,2,"div",15)(2,cne,4,3,"h3",16)(3,lne,2,1,"p",17)(4,bne,3,2,"div",18)(5,Cne,14,6,"div",19),w()),n&2){let t=e.$implicit;fn("id","ticket-id-",t.id,""),F(),G("ngIf",t),F(),G("ngIf",t),F(),G("ngIf",t),F(),G("ngIf",t),F(),G("ngIf",t)}}function Sne(n,e){if(n&1){let t=Ge();v(0,"button",44),j("click",function(){Ve(t);let i=ie();return Ue(i.getMoreTickets())}),I(1,"Recupera altri ticket"),w()}}var s$=(()=>{let e=class e{constructor(r){this.generalService=r,this.alredySavedMoreRecentOpenTicket=!1,this.documents=new Ae([]),this.nextPageAvailable=!1,this.comments=new Ae([])}ngOnInit(){this.getOpenTickets(),this.setAllTicketsRead()}getObjectKeys(r){return r?Object.keys(r):[]}setAllTicketsRead(){return g(this,null,function*(){let r=Tr(L.firestore(),"tickets"),i=yield Ua(r);localStorage.setItem("last-ticket-count",i.data().count+""),this.generalService.ticketToRead=!1,localStorage.setItem("last-ticket-check-timestamp",Date.now()+""),document.getElementById("ticket-to-read-sidebar-container").style.display="none"})}openAddTicketPopup(){this.generalService.ticketLinkObject={},this.generalService.ticketLinkCounter=0,document.getElementById("add-ticket-popup").style.display="flex"}openTicketMenuPopup(r){this.generalService.currentTicket=r,document.getElementById("edit-menu-ticket-popup").style.display="flex",r.status=="open"&&(document.getElementById("open-ticket-button").style.display="none",document.getElementById("close-ticket-button").style.display="flex"),r.status=="close"&&(document.getElementById("open-ticket-button").style.display="flex",document.getElementById("close-ticket-button").style.display="none")}showCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="flex"}hideCommentSection(r){document.getElementById("comment-section-"+r.id).style.display="none"}addComment(r){var i=L.auth().currentUser;let s=document.getElementById("comment-input-"+r.id),o=s.value;o.trim()&&(L.database().ref("/comments/"+r.id+"/").push({text:o,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,timestamp:Date.now(),creator_uid:i.uid}),s.value="",this.getComments(r))}getComments(r){let i=document.getElementById("comment-section-arrow-icon-"+r.id),s=document.getElementById("comment-section-"+r.id);s.innerHTML="",s.style.display=="none"?(i.innerText="keyboard_arrow_up",L.database().ref(`/comments/${r.id}/`).once("value").then(o=>{o.forEach(c=>{let l=c.key,d=c.val(),h=document.getElementById("comment-section-"+r.id),p=document.createElement("div");p.className="comment";let _=document.createElement("p");_.style.marginBottom="0.5rem",_.textContent=d.name+" "+d.surname+" | "+d.agencyName+" | "+this.convertTimestamp(d.timestamp);let E=document.createElement("p");E.style.marginBottom="0.5rem",E.textContent=d.text,p.appendChild(_),p.appendChild(E),h.appendChild(p)});let a=document.getElementById("comment-section-"+r.id);a&&(a.style.display="flex")}).catch(o=>{console.error("Errore durante il recupero dei commenti:",o)})):(s.style.display="none",i.innerText="keyboard_arrow_down")}higlightTicketIndicator(r){document.querySelectorAll(".ticket-navigator-button").forEach(i=>{i.style.backgroundColor="transparent",i.style.padding="0.2rem",i.style.borderRadius="1rem"}),document.getElementById("ticket-navigator-button"+r).style.background="yellow",document.getElementById("ticket-navigator-button"+r).style.paddingTop="0.3rem",document.getElementById("ticket-navigator-button"+r).style.paddingBottom="0.3rem",document.getElementById("ticket-navigator-button"+r).style.paddingLeft="0.8rem",document.getElementById("ticket-navigator-button"+r).style.paddingRight="0.8rem",document.getElementById("ticket-navigator-button"+r).style.borderRadius="2rem"}convertTimestampToDate(r){let i=new Date(r*1e3),s=String(i.getDate()).padStart(2,"0"),o=String(i.getMonth()+1).padStart(2,"0"),a=i.getFullYear(),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0"),d=String(i.getSeconds()).padStart(2,"0");return`${s}-${o}-${a} ${c}:${l}:${d}`}convertTimestamp(r){let s=new Date(r).toISOString(),[o,a]=s.split("T"),[c,l,d]=o.split("-"),[h]=a.split(".");return`${d}/${l}/${c} ${h}`}getTickets(){return L.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getOpenTickets(){return this.higlightTicketIndicator(1),this.alredySavedMoreRecentOpenTicket=!1,L.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","open").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket aperti: "+r.message)})}getClosedTickets(){return L.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("status","==","close").onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{this.generalService.presentToast("Errore nel recuperare i ticket chiusi: "+r.message)})}getMyTickets(){var r=L.auth().currentUser;return L.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).where("creator_id","==",r.uid).onSnapshot(i=>{let s=[];i.forEach(o=>{s.push(q({id:o.id},o.data()))}),s.length===4?(this.lastVisible=i.docs[i.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(s)},i=>{this.generalService.presentToast("Errore nel recuperare i tuoi ticket: "+i.message)})}getMoreTickets(){!this.lastVisible||!this.nextPageAvailable||L.firestore().collection("tickets").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke))},e.\u0275cmp=$e({type:e,selectors:[["app-tickets"]],decls:21,vars:4,consts:[[2,"height","100%","display","flex","flex-direction","column","padding-left","1rem","overflow-x","hidden","overflow-y","hidden","overflow-x","hidden","overflow-y","hidden"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","flex-wrap","wrap","margin-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","border-radius","2rem","padding-left","0.5rem","padding-right","0.5rem","padding-top","0.2rem","padding-bottom","0.2rem","height","2.5rem","overflow-y","hidden","overflow-x","auto"],["id","ticket-navigator-button1",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],["id","ticket-navigator-button2",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],["id","ticket-navigator-button3",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],["id","ticket-navigator-button4",1,"ticket-navigator-button",2,"cursor","pointer",3,"click"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-bottom: 1rem;",3,"id",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],[2,"flex","1"],[1,"card",2,"padding-left","1rem","padding-bottom","1rem",3,"id"],["style","display: flex; flex-direction: row; align-items: center; gap: 0.5rem; padding-right: 0.5rem;",4,"ngIf"],["style","margin-top: 0rem; margin-bottom: 0rem;",4,"ngIf"],["style","margin-top: 0.5rem;",4,"ngIf"],["style","display: flex; flex-direction: row; align-items: center; gap: 1rem; margin-bottom: 1rem;",4,"ngIf"],["style","display: flex; flex-direction: column; align-items: center; padding-right: 1rem;",4,"ngIf"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","padding-right","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem"],[4,"ngIf"],["style","color: #333; cursor: pointer; font-size: 1.8rem;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#333","cursor","pointer","font-size","1.8rem",3,"click"],[2,"margin-top","0rem","margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","1rem","margin-bottom","1rem"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngFor","ngForOf"],["target","_blank","style","text-decoration: none;",3,"href",4,"ngIf"],["target","_blank",2,"text-decoration","none",3,"href"],[1,"card",2,"height","2.5rem","display","flex","flex-direction","row","align-items","center","justify-content","center","gap","0.5rem","padding-left","0.5rem","padding-right","0.5rem","border-radius","0.5rem"],["style","color: #313131; font-size: 1.8rem;","class","material-symbols-outlined notranslate",4,"ngIf"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.8rem"],[2,"display","flex","flex-direction","column","align-items","center","padding-right","1rem"],[2,"width","100%","height","3rem","display","flex","flex-direction","row","gap","0.5rem","margin-bottom","1rem"],[1,"input-group",2,"width","calc(100% - 3.5rem)"],[1,"material-symbols-outlined","notranslate"],["type","text","placeholder","Scrivi un commento",1,"input",3,"keydown.enter","id"],[2,"width","3rem","height","3rem","border-radius","50%","background","transparent","cursor","pointer","border","1px solid rgba(0, 0, 0, 0.178)","display","flex","align-items","center","justify-content","center",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333"],[2,"cursor","pointer","display","flex","flex-direction","row","align-items","center","width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","#333",3,"id"],[2,"display","none","flex-direction","column","gap","1rem","width","100%",3,"id"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"h2",2),I(3,"Tickets"),v(4,"span",3),j("click",function(){return s.openAddTicketPopup()}),I(5,"add"),w()(),v(6,"div",4)(7,"h3",5),j("click",function(){return s.getOpenTickets(),s.higlightTicketIndicator(1)}),I(8,"Aperti"),w(),v(9,"h3",6),j("click",function(){return s.getClosedTickets(),s.higlightTicketIndicator(2)}),I(10,"Chiusi"),w(),v(11,"h3",7),j("click",function(){return s.getTickets(),s.higlightTicketIndicator(3)}),I(12,"Tutti"),w(),v(13,"h3",8),j("click",function(){return s.getMyTickets(),s.higlightTicketIndicator(4)}),I(14,"Pubblicati da me"),w()()(),v(15,"div",9)(16,"div",10),he(17,Tne,6,7,"div",11),zn(18,"async"),he(19,Sne,2,0,"button",12),w()(),te(20,"div",13),w()),i&2&&(F(17),G("ngForOf",qn(18,2,s.documents)),F(2),G("ngIf",s.nextPageAvailable))},dependencies:[mr,Wt,gr]});let n=e;return n})();var o$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$e({type:e,selectors:[["app-zoom"]],decls:26,vars:0,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem","padding-right","1rem"],[1,"card",2,"margin-top","1rem","padding-left","1rem","padding-bottom","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","0.5rem"],[2,"width","100%","display","flex","flex-direction","row","align-items","center","gap","0.5rem"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.5rem"],[2,"color","#333","margin-top","0rem","margin-bottom","0rem"],["href","https://zoom.us/it/signin#/login","target","_blank",2,"color","#333","margin-top","0rem","margin-bottom","0rem"],[2,"color","#333","text-decoration","underline","margin-top","0rem","margin-bottom","0rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1)(2,"h3"),I(3,"Chiamata Zoom"),w(),v(4,"div",2)(5,"div",3)(6,"span",4),I(7,"link"),w(),v(8,"p",5),I(9,"Link:"),w(),v(10,"a",6),I(11,"https://zoom.us/it/signin#/login"),w()(),v(12,"div",3)(13,"span",4),I(14,"person"),w(),v(15,"p",5),I(16,"Nome Utente:"),w(),v(17,"p",7),I(18,"erika.c@agenziaautoteam.it"),w()(),v(19,"div",3)(20,"span",4),I(21,"key"),w(),v(22,"p",5),I(23,"Password:"),w(),v(24,"p",7),I(25,"Autoteam2022"),w()()()()())}});let n=e;return n})();function Dne(n,e){n&1&&(v(0,"span",7),I(1,"add_circle"),w())}function Ane(n,e){if(n&1){let t=Ge();v(0,"span",16),j("click",function(){Ve(t);let i=ie().$implicit,s=ie();return Ue(s.openChangeLinkPopup(i))}),I(1,"edit"),w()}}function xne(n,e){if(n&1){let t=Ge();v(0,"span",16),j("click",function(){Ve(t);let i=ie().$implicit,s=ie();return Ue(s.deleteLink(i))}),I(1,"delete"),w()}}function Rne(n,e){if(n&1&&(v(0,"div",8)(1,"p",9)(2,"span",10),I(3,"description"),w(),v(4,"strong"),I(5,"Nome: "),w(),te(6,"span",11),he(7,Ane,2,0,"span",12)(8,xne,2,0,"span",12),w(),v(9,"p",13),I(10),w(),v(11,"p",9)(12,"span",10),I(13,"format_list_bulleted"),w(),v(14,"strong"),I(15,"Descrizione: "),w()(),v(16,"p",13),I(17),w(),v(18,"p",14)(19,"span",10),I(20,"link"),w(),v(21,"strong"),I(22,"Url: "),w()(),v(23,"a",15),I(24),w()()),n&2){let t=e.$implicit,r=ie();F(7),G("ngIf",r.generalService.isAdmin==!0),F(),G("ngIf",r.generalService.isAdmin==!0),F(2),rt(t.name),F(7),rt(t.description),F(6),ks("href",t.url,Yi),F(),rt(t.url)}}function kne(n,e){if(n&1){let t=Ge();v(0,"button",17),j("click",function(){Ve(t);let i=ie();return Ue(i.getMoreUsefulLinks())}),I(1,"Recupera altri link utili"),w()}}var a$=(()=>{let e=class e{ngOnInit(){this.getUsefulLinks()}constructor(r){this.generalService=r,this.documents=new Ae([]),this.nextPageAvailable=!1}getUsefulLinks(){return L.firestore().collection("useful_links").orderBy("timestamp","desc").limit(4).onSnapshot(r=>{let i=[];r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length===4?(this.lastVisible=r.docs[r.docs.length-1],this.nextPageAvailable=!0):this.nextPageAvailable=!1,this.documents.next(i)},r=>{console.error("Error getting documents: ",r)})}getMoreUsefulLinks(){!this.lastVisible||!this.nextPageAvailable||L.firestore().collection("useful_links").orderBy("timestamp","desc").limit(4).startAfter(this.lastVisible).get().then(r=>{let i=[];if(r.forEach(s=>{i.push(q({id:s.id},s.data()))}),i.length>0){let o=[...this.documents.getValue(),...i];this.documents.next(o),i.length===4?this.lastVisible=r.docs[r.docs.length-1]:this.nextPageAvailable=!1}else this.nextPageAvailable=!1}).catch(r=>{this.generalService.presentToast("Errore nel recuperare pi\xF9 ticket: "+r.message),this.nextPageAvailable=!1})}deleteLink(r){confirm("Sei sicuro di voler cancellare questo link?")&&L.firestore().collection("useful_links").doc(r.id).delete().then(()=>{this.generalService.presentToast("Link cancellato con successo")}).catch(i=>{this.generalService.presentToast("Errore durante la cancellazione del link: "+i.message)})}openChangeLinkPopup(r){this.generalService.currentLink=r,document.getElementById("change-new-useful-link-popup").style.display="flex",document.getElementById("change-useful-link-name-input").value=r.name,document.getElementById("change-useful-link-description-input").value=r.description,document.getElementById("change-useful-link-url-input").value=r.url}};e.\u0275fac=function(i){return new(i||e)(Z(Ke))},e.\u0275cmp=$e({type:e,selectors:[["app-links"]],decls:9,vars:5,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-y","auto","overflow-x","hidden","padding-left","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem"],["onclick","document.getElementById('add-new-useful-link-popup').style.display = 'flex'; ","style","color: black; font-size: 1.8rem; cursor: pointer;","class","material-symbols-outlined notranslate",4,"ngIf"],[2,"overflow-y","auto","overflow-x","hidden","padding-bottom","1rem","padding-right","1rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","card","style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem;",4,"ngFor","ngForOf"],["class","button","style","margin-bottom: 1rem; flex-shrink: 0;",3,"click",4,"ngIf"],["onclick","document.getElementById('add-new-useful-link-popup').style.display = 'flex'; ",1,"material-symbols-outlined","notranslate",2,"color","black","font-size","1.8rem","cursor","pointer"],[1,"card",2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.3rem"],[1,"material-symbols-outlined","notranslate",2,"color","#313131","font-size","1.5rem"],[2,"flex","1"],["style","font-size: 1.5rem; color: #333; cursor: pointer; display: flex;","class","material-symbols-outlined notranslate",3,"click",4,"ngIf"],[2,"margin-top","0rem"],[2,"display","flex","flex-direction","row","align-items","center","gap","0.5rem","margin-bottom","0.2rem"],["target","_blank",2,"overflow-wrap","break-word","margin-top","0rem",3,"href"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.5rem","color","#333","cursor","pointer","display","flex",3,"click"],[1,"button",2,"margin-bottom","1rem","flex-shrink","0",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),I(2,"Link utili "),he(3,Dne,2,0,"span",2),w(),v(4,"div",3)(5,"div",4),he(6,Rne,25,6,"div",5),zn(7,"async"),he(8,kne,2,0,"button",6),w()()()),i&2&&(F(3),G("ngIf",s.generalService.isAdmin==!0),F(3),G("ngForOf",qn(7,3,s.documents)),F(2),G("ngIf",s.nextPageAvailable))},dependencies:[mr,Wt,gr]});let n=e;return n})();function Nne(n,e){n&1&&(v(0,"div",13),te(1,"img",14),v(2,"div",15)(3,"div",16)(4,"div",17)(5,"h1",18),I(6,"Migliora la produttivit\xE0"),w(),v(7,"p",19),I(8,"Osserva come le aziende utilizzano le infrastutture digitali per ottimizzare i processi e migliorare l'organizzazione interna"),w(),v(9,"button",20),I(10,"Case studies"),w()()()()())}var c$=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){}changePassword(){let r=document.getElementById("change-password-email-input").value;L.auth().sendPasswordResetEmail(r).then(()=>{document.getElementById("change-password-email-input").value="",this.generalService.presentToast("Link per il cambio password inviato con successo, controlla la tua casella di posta ("+r+")")}).catch(i=>{this.generalService.presentToast("Errore nell'inviare l'email per il cambio password: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke))},e.\u0275cmp=$e({type:e,selectors:[["app-change-password"]],decls:19,vars:1,consts:[[2,"height","100%","width","100%","display","flex","flex-wrap","wrap","flex-direction","row","overflow-y","auto","overflow-x","hidden"],["class","desktop-element","style","flex: 1; max-width: 40rem; min-width: 20rem; border-right: 1px solid rgba(0, 0, 0, 0.122); overflow: hidden; position: relative;",4,"ngIf"],[2,"flex","1","min-width","20rem","display","flex","flex-direction","column","align-items","center","justify-content","center"],[1,"mobile-element",2,"width","100%","display","flex","flex-direction","row","align-items","center","justify-content","start"],["src","assets\\imgs\\movysoft.png","alt","Movysoft logo",2,"width","10rem","margin-left","0.5rem"],[2,"flex","1"],[2,"width","100%","max-width","33rem"],[2,"padding-left","1rem","padding-right","1rem","height","100%","display","flex","flex-direction","column","gap","1rem"],[2,"margin-bottom","0rem"],[1,"input-group"],[1,"material-symbols-outlined","notranslate",2,"color","#333"],["id","change-password-email-input","type","text","placeholder","Email",1,"input"],[1,"button-action",2,"margin-top","1rem","width","100%",3,"click"],[1,"desktop-element",2,"flex","1","max-width","40rem","min-width","20rem","border-right","1px solid rgba(0, 0, 0, 0.122)","overflow","hidden","position","relative"],["src","assets/imgs/photo1.jpeg",2,"height","100%","width","100%","object-fit","cover"],[2,"display","flex","flex-direction","column","align-items","center","justify-content","center","position","absolute","top","0","left","0","width","100%","height","100%","background-color","rgba(71, 69, 69, 0.72)"],[2,"width","100%","max-width","30rem"],[2,"margin","1rem"],[2,"color","white","margin-bottom","0.8rem"],[2,"color","white","margin-top","0rem"],[1,"button-action"]],template:function(i,s){i&1&&(v(0,"div",0),he(1,Nne,11,0,"div",1),v(2,"div",2)(3,"div",3),te(4,"img",4),w(),te(5,"div",5),v(6,"div",6)(7,"div",7)(8,"h2",8),I(9,"Cambio password"),w(),v(10,"small"),I(11,"Inserisci qui l'indirizzo email e ricevi un'email per il cambio della password"),w(),v(12,"div",9)(13,"span",10),I(14,"mail"),w(),te(15,"input",11),w(),v(16,"button",12),j("click",function(){return s.changePassword()}),I(17,"Conferma"),w()()(),te(18,"div",5),w()()),i&2&&(F(),G("ngIf",!s.generalService.isUserLogged))},dependencies:[Wt]});let n=e;return n})();function Pne(n,e){if(n&1&&(v(0,"div",6)(1,"div",7),te(2,"img",8),v(3,"div")(4,"h2",9),I(5),w(),v(6,"p",9),I(7),w()()()()),n&2){let t=ie();F(5),Ko("",t.generalService.currentUser.name," ",t.generalService.currentUser.surname,""),F(2),rt(t.generalService.currentUser.email)}}function Mne(n,e){n&1&&(v(0,"div",10)(1,"h4",11),I(2,"Admin"),w(),v(3,"a",12),I(4,"Vai a utenti e permessi"),w()())}var l$=(()=>{let e=class e{ngOnInit(){}constructor(r,i){this.generalService=r,this.router=i}logout(){window.confirm("Sei sicuro di volerti disconnettere?")&&L.auth().signOut().then(()=>{this.generalService.presentToast("Disconnessione effettuata con successo"),this.router.navigate(["/login"])}).catch(r=>{this.generalService.presentToast("Errore durante la disconnessione: "+r.message)})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-settings"]],decls:11,vars:2,consts:[[2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],["style","margin-top: 1rem;",4,"ngIf"],["class","admin-elements",4,"ngIf"],["routerLink","/change-password",1,"a1",2,"margin-top","0.5rem","color","black"],[1,"a1",2,"margin-top","0.5rem","cursor","pointer","text-decoration","underline",3,"click"],[2,"margin-top","1rem"],[2,"height","100%","width","100%","display","flex","flex-direction","row","align-items","center","gap","1rem"],["src","https://images.pexels.com/photos/91227/pexels-photo-91227.jpeg","alt","Profile image",2,"height","2.5rem","width","2.5rem","border-radius","50%","object-fit","cover"],[2,"margin","0"],[1,"admin-elements"],[2,"margin-bottom","0.5rem"],["href","assets\\settings\\permission-manager.html",1,"a1",2,"margin-top","0rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),I(2,"Account e impostazioni"),w(),he(3,Pne,8,3,"div",2)(4,Mne,5,0,"div",3),v(5,"h4",1),I(6,"Il mio account"),w(),v(7,"a",4),I(8,"Cambio password"),w(),v(9,"a",5),j("click",function(){return s.logout()}),I(10,"Disconnetti"),w()()),i&2&&(F(3),G("ngIf",s.generalService.currentUser),F(),G("ngIf",s.generalService.isAdmin))},dependencies:[Wt,Hc]});let n=e;return n})();function One(n,e){if(n&1){let t=Ge();v(0,"tr",6)(1,"td",8),I(2),w(),v(3,"td",8),I(4),w(),v(5,"td",8),I(6),w(),v(7,"td",8)(8,"select",11),j("change",function(){let i=Ve(t).$implicit,s=ie();return Ue(s.changeUserPermission(i))}),te(9,"option",12),v(10,"option",13),I(11,"Nessuno"),w(),v(12,"option",14),I(13,"Normale"),w(),v(14,"option",15),I(15,"Admin"),w()()(),v(16,"td",8),I(17),w(),v(18,"td",8),I(19),w(),v(20,"td",8)(21,"div",16)(22,"span",17),j("click",function(){let i=Ve(t).$implicit,s=ie();return Ue(s.deleteUser(i))}),I(23,"delete"),w()()()()}if(n&2){let t=e.$implicit,r=ie();F(2),Ko("",t.name," ",t.surname,""),F(2),rt(t.email),F(2),rt(t.agencyName),F(2),fn("id","change-permission-type-input-",t.uid,""),F(9),rt(r.formatFirebaseTimestamp(t.registration_date)),F(2),rt(t.id)}}var u$=(()=>{let e=class e{constructor(r){this.generalService=r}ngOnInit(){this.getUsersList(),setTimeout(()=>{this.getUserPermission()},2e3)}formatFirebaseTimestamp(r){let i=new Date(r.seconds*1e3+r.nanoseconds/1e6),s={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"};return i.toLocaleString("it-IT",s)}getUsersList(){this.users=new Le(r=>Zh(Tr(L.firestore(),"users_data"),s=>{let o=s.docs.map(a=>q({id:a.id},a.data()));r.next(o)},s=>{r.error(s)}))}getUserPermission(){L.firestore().collection("settings").doc("users_permissions").get().then(r=>{if(r.exists){let i=r.data();Object.entries(i).forEach(([s,o])=>{console.log(`Tag: ${s}, Valore: ${o}`),document.getElementById("change-permission-type-input-"+s).value=o})}else console.log("Documento non trovato.")}).catch(r=>{console.log("Errore nel recupero delle autorizzazioni:",r)})}changeUserPermission(r){let i=document.getElementById("change-permission-type-input-"+r.uid);confirm("Sei sicuro di voler modificare i permessi attribuiti a: "+r.email+"?")?i.value!=""&&L.firestore().collection("settings").doc("users_permissions").set({[r.uid]:i.value},{merge:!0}).then(()=>{alert("I permessi dell'utente: "+r.email+" sono stati modificati con successo")}).catch(s=>{alert("Errore durante la modifica dei permessi per questo utente: "+s.message)}):i.value=""}deleteUser(r){confirm("Sei sicuro di voler eliminare e di azzerare tutti i permessi per questo utente?")&&L.firestore().collection("users_data").doc(r.id).delete().then(()=>{L.firestore().collection("settings").doc("users_permissions").set({[r.uid]:"none"},{merge:!0}).catch(i=>{this.generalService.presentToast("Errore durante la modifica dei permessi per questo utente: "+i.message)}),this.generalService.presentToast("Utente e relativi permessi eliminati con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione dell'utente: "+i.message)})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke))},e.\u0275cmp=$e({type:e,selectors:[["app-admin"]],decls:26,vars:3,consts:[["id","settings-popup",2,"height","100%","display","flex","flex-direction","column","overflow-x","hidden","overflow-y","auto","padding-left","1rem","padding-right","1rem"],[2,"margin-bottom","0rem"],[2,"margin-top","0.5rem"],[2,"width","100%","overflow-x","auto","overflow-y","auto","border-radius","0.5rem"],[1,"table"],[1,"table-header"],[1,"table-row"],[1,"table-cell",2,"min-width","12rem"],[1,"table-cell"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],[3,"change","id"],["value",""],["value","none"],["value","normal"],["value","admin"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","center","gap","1rem"],[1,"material-symbols-outlined","notranslate","table-button",3,"click"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"h2",1),I(2,"Impostazioni"),w(),v(3,"p",2),I(4,"Utenti e permessi"),w(),v(5,"div",3)(6,"table",4)(7,"thead",5)(8,"tr",6)(9,"th",7),I(10,"Nome e Cognome"),w(),v(11,"th",8),I(12,"Email"),w(),v(13,"th",8),I(14,"Agenzia"),w(),v(15,"th",8),I(16,"Permessi"),w(),v(17,"th",7),I(18,"Data Registrazione"),w(),v(19,"th",8),I(20,"ID"),w(),v(21,"th",8),I(22,"Azioni"),w()()(),v(23,"tbody",9),he(24,One,24,8,"tr",10),zn(25,"async"),w()()()()),i&2&&(F(24),G("ngForOf",qn(25,1,s.users)))},dependencies:[mr,bv,Cv,gr]});let n=e;return n})();var Fne=[{path:"",redirectTo:"chat",pathMatch:"full"},{path:"login",component:Zj},{path:"register",component:e$},{path:"company",component:n$},{path:"chat",component:t$},{path:"procedure",component:r$},{path:"home",component:i$},{path:"tickets",component:s$},{path:"zoom",component:o$},{path:"links",component:a$},{path:"change-password",component:c$},{path:"settings",component:l$},{path:"settings/admin",component:u$}],d$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$n({type:e}),e.\u0275inj=jn({imports:[yI.forRoot(Fne),yI]});let n=e;return n})();function Lne(n,e){if(n&1){let t=Ge();v(0,"button",9),j("click",function(){let i=Ve(t).$implicit,s=ie();return s.goToRoute("chat","close-sidebar"),Ue(s.openChat(i))}),v(1,"span",10),I(2,"message"),w(),I(3),te(4,"div",14),v(5,"div",16),te(6,"span",17),w()()}if(n&2){let t=e.$implicit;F(3),Xi(" ",t.name," "),F(2),fn("id","",t.id,"-to-read-messages-count"),F(),fn("id","",t.id,"-to-read-messages-count-display")}}function Vne(n,e){if(n&1){let t=Ge();v(0,"button",9),j("click",function(){let i=Ve(t).$implicit,s=ie();return s.goToRoute("settori","close-sidebar"),Ue(s.showSectorProcedures(i))}),v(1,"span",10),I(2,"library_books"),w(),I(3),w()}if(n&2){let t=e.$implicit;F(3),rt(t.name)}}function Une(n,e){if(n&1){let t=Ge();v(0,"div",18),j("click",function(){Ve(t);let i=ie();return Ue(i.goToRoute("settings","close-sidebar"))}),v(1,"div",19),te(2,"img",20),v(3,"div")(4,"h4",21),I(5),w(),v(6,"small"),I(7),w()()()()}if(n&2){let t=ie();F(5),Ko("",t.generalService.currentUser.name," ",t.generalService.currentUser.surname,""),F(2),rt(t.generalService.currentUser.email)}}var h$=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.chatDocuments=new Ae([]),this.documents=new Ae([]),this.chats=new Ae([]),this.count=0}ngOnInit(){document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{this.syncWithChatsCollectionChanges(),this.syncWithNewTickets()},500),this.openCloseChats()})}getOpenTicketsNumber(){return g(this,null,function*(){let r=Tr(L.firestore(),"tickets"),i=Yn(r,Va("status","==","open")),s=yield Ua(i);document.getElementById("open-tickets-sidebar-display").innerText=s.data().count+"",s.data().count!=0?document.getElementById("open-tickets-counter-container").style.display="flex":document.getElementById("open-tickets-counter-container").style.display="none"})}syncWithNewTickets(){L.firestore().collection("tickets").onSnapshot(r=>{r.docChanges().forEach(i=>{i.type==="removed"&&this.checkForNewTickets(),i.type==="added"&&(this.checkForNewTickets(),new Audio("assets/sounds/ticket.mp3").play())})})}goToRoute(r,i){this.closeSidebarMobile(),this.router.navigate(["/"+r])}closeSidebarMobile(){window.innerWidth<=899&&(this.generalService.sidebarOpen=!1)}openChat(r){this.router.navigate(["/chat"],{queryParams:{id:r.id,name:r.name,description:r.description}})}newChat(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-chat-popup").style.display="flex"}newSector(){window.innerWidth<=799&&this.hideOrShowSidebar(),document.getElementById("add-new-sector-popup").style.display="flex"}hideOrShowSidebar(){let r=document.getElementById("sidebar-container");r.style.display=="flex"?r.style.display="none":r.style.display="flex"}showSectorProcedures(r){this.router.navigate(["/procedure"],{queryParams:{sector_id:r.id,sector_name:r.name,sector_description:r.description}})}openCloseSettoriEProcedure(){let r=document.getElementById("settori-menu-container"),i=document.getElementById("open-menu-icon1");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):L.firestore().collection("settori").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(q({id:a.id},a.data()))}),this.documents.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero dei settori: "+s.message)})}getTicketsToReadNumber(){return g(this,null,function*(){let r=Tr(L.firestore(),"tickets"),i=Yn(r,Va("timestamp",">",Number(localStorage.getItem("last-ticket-timestamp")))),s=yield Ua(i)})}checkForNewTickets(){return g(this,null,function*(){this.generalService.getOpenTicketsNumber(),this.getTicketsToReadNumber(),L.firestore().collection("tickets").orderBy("timestamp","desc").limit(1).get().then(r=>{r.forEach(i=>g(this,null,function*(){var s=i.data().timestamp;Number(localStorage.getItem("last-ticket-check-timestamp"))<s.seconds*1e3?(document.getElementById("ticket-to-read-sidebar-container").style.display="flex",this.generalService.ticketToRead=!0,this.getTicketsToReadNumber()):document.getElementById("ticket-to-read-sidebar-container").style.display="none"}))}).catch(r=>{console.log("Error getting more recent tickt timestamp:",r)})})}syncWithChatsCollectionChanges(){L.firestore().collection("chat_messages").limit(1).orderBy("createdAt","desc").onSnapshot(r=>{r.docChanges().forEach(i=>{L.auth().onAuthStateChanged(s=>{i.doc.id!=localStorage.getItem("last_chat_message_fetched_id")&&(i.doc.data().creator_uid!=s.uid&&(localStorage.setItem("last_chat_message_fetched_id",i.doc.id),new Audio("assets/sounds/chat.mp3").play(),Notification.permission==="granted"?this.showChatMessageNotification(i.doc.data()):Notification.permission!=="denied"&&Notification.requestPermission().then(o=>{o==="granted"&&this.showChatMessageNotification(i.doc.data())})),document.getElementById("chats-menu-container").style.display="none",this.openCloseChats())})})},r=>{console.error("Errore nel monitoraggio delle modifiche: ",r)})}showChatMessageNotification(r){let i=new Notification("AutoTeam | Nuovo Messaggio",{body:r.creator_name+" "+r.creator_surname+" | "+r.message,icon:"icon.png"});i.onclick=function(){window.open("https://www.serviziautoteam.it/app/#/chat?id="+r.chat_id)}}openCloseChats(){let r=document.getElementById("chats-menu-container"),i=document.getElementById("open-menu-icon2");r.style.display==="flex"?(r.style.display="none",i.innerText="keyboard_arrow_down"):L.firestore().collection("chats").orderBy("name_query").onSnapshot(s=>{let o=[];s.forEach(a=>{o.push(q({id:a.id},a.data())),this.checkForNewMessages(a.id)}),this.chats.next(o),r.style.display="flex",i.innerText="keyboard_arrow_up"},s=>{this.generalService.presentToast("Errore durante il recupero delle chat: "+s.message)})}checkForNewMessages(r){return g(this,null,function*(){var i=yield this.getRecentDocumentTimestamp(r);if(i!="no_messages"){var s=i.seconds*1e3,o=Number(localStorage.getItem(r+"-last-message-seconds-timestamp-check"))*1e3;o?o<s?(console.log("Hai messaggi nuovi da leggere per la chat: "+r),document.getElementById(r+"-to-read-messages-count").style.display="flex"):document.getElementById(r+"-to-read-messages-count").style.display="none":document.getElementById(r+"-to-read-messages-count").style.display="flex"}})}getRecentDocumentTimestamp(r){return g(this,null,function*(){try{let s=yield L.firestore().collection("chat_messages").where("chat_id","==",r).orderBy("createdAt","desc").limit(1).get();return s.empty?"no_messages":s.docs[0].data().createdAt}catch(i){this.generalService.presentToast("Errore durante il controllo per i nuovi messaggi: "+i.message)}})}formatTimestamp(r){let s=r.seconds*1e3+Math.floor(r.nanoseconds/1e6);return new Date(s).toLocaleString()}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-sidebar"]],decls:41,vars:7,consts:[["id","sidebar",2,"display","flex","flex-direction","column","width","18rem","flex-shrink","0","height","100%","background","white","border-right","1px solid rgba(0, 0, 0, 0.124)","overflow-y","auto","overflow-x","hidden"],["src","assets\\imgs\\movysoft.png",2,"height","7rem","object-fit","contain"],[1,"sidebar-button",3,"click"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.1rem","color","#333"],["id","open-tickets-counter-container",2,"background","rgb(247, 150, 32)","border-radius","50%","width","1.5rem","height","1.5rem","display","none","align-items","center","justify-content","center"],["id","open-tickets-sidebar-display",2,"color","white"],["id","ticket-to-read-sidebar-container",2,"background","red","border-radius","50%","width","1.5rem","height","1.5rem","display","none","align-items","center","justify-content","center"],["id","open-menu-icon2",1,"material-symbols-outlined","notranslate",2,"font-size","1.1rem","color","#333"],["id","chats-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[1,"sidebar-button",2,"width","100%",3,"click"],[1,"material-symbols-outlined","notranslate",2,"color","#333","font-size","1.1rem"],["class","sidebar-button","style","width: 100%;",3,"click",4,"ngFor","ngForOf"],["id","open-menu-icon1",1,"material-symbols-outlined","notranslate",2,"font-size","1.1rem","color","#333"],["id","settori-menu-container",2,"display","none","flex-direction","column","padding-right","2rem","padding-left","1rem"],[2,"flex","1"],["style","padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem; cursor: pointer;",3,"click",4,"ngIf"],[2,"display","none","background","red","border-radius","50%","width","1rem","height","1rem",3,"id"],[2,"color","white",3,"id"],[2,"padding-left","1rem","padding-right","1rem","padding-bottom","1rem","cursor","pointer",3,"click"],[2,"height","100%","width","100%","display","flex","flex-direction","row","align-items","center","gap","1rem"],["src","https://images.pexels.com/photos/91227/pexels-photo-91227.jpeg","alt","Profile image",2,"height","1.8rem","width","1.8rem","border-radius","50%","object-fit","cover"],[2,"margin","0"]],template:function(i,s){i&1&&(v(0,"div",0),te(1,"img",1),v(2,"button",2),j("click",function(){return s.goToRoute("company","close-sidebar")}),v(3,"span",3),I(4,"apartment"),w(),I(5,"Blog interno"),w(),v(6,"button",2),j("click",function(){return s.goToRoute("tickets","close-sidebar")}),v(7,"span",3),I(8,"style"),w(),I(9,"Tickets "),v(10,"div",4),te(11,"span",5),w(),te(12,"div",6),w(),v(13,"button",2),j("click",function(){return s.openCloseChats()}),v(14,"span",7),I(15,"keyboard_arrow_down"),w(),I(16,"Chat"),w(),v(17,"div",8)(18,"button",9),j("click",function(){return s.newChat()}),v(19,"span",10),I(20,"add_circle"),w(),I(21,"Nuova chat"),w(),he(22,Lne,7,5,"button",11),zn(23,"async"),w(),v(24,"button",2),j("click",function(){return s.openCloseSettoriEProcedure()}),v(25,"span",12),I(26,"keyboard_arrow_down"),w(),I(27,"Settori e procedure"),w(),v(28,"div",13)(29,"button",9),j("click",function(){return s.newSector()}),v(30,"span",10),I(31,"add_circle"),w(),I(32,"Nuovo settore"),w(),he(33,Vne,4,1,"button",11),zn(34,"async"),w(),v(35,"button",2),j("click",function(){return s.goToRoute("links","close-sidebar")}),v(36,"span",3),I(37,"link"),w(),I(38,"Link utili"),w(),te(39,"div",14),he(40,Une,8,3,"div",15),w()),i&2&&(F(22),G("ngForOf",qn(23,3,s.chats)),F(11),G("ngForOf",qn(34,5,s.documents)),F(7),G("ngIf",s.generalService.currentUser))},dependencies:[mr,Wt,gr]});let n=e;return n})();function jne(n,e){if(n&1){let t=Ge();v(0,"button",14),j("click",function(){Ve(t);let i=ie();return Ue(i.deleteTicket())}),I(1,"Elimina"),w()}}var f$=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.documents=new Ae([]),this.chatDocuments=new Ae([]),this.ticketDownloadURL=""}ngOnInit(){}openChangeTicketPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none",document.getElementById("change-ticket-argomento-input").value=this.generalService.currentTicket.argomento,document.getElementById("change-ticket-description-input").value=this.generalService.currentTicket.descrizione,document.getElementById("change-ticket-popup").style.display="flex"}closeAddTicketPopup(){document.getElementById("add-ticket-popup").style.display="none"}closeTicketMenuPopup(){document.getElementById("edit-menu-ticket-popup").style.display="none"}closeAddNewSectorPopup(){document.getElementById("add-new-sector-popup").style.display="none"}closeChangeSectorPopup(){document.getElementById("change-sector-popup").style.display="none"}closeAddNewUsefulLinkPopup(){document.getElementById("add-new-useful-link-popup").style.display="none"}closeAddNewChatPopup(){document.getElementById("add-new-chat-popup").style.display="none"}closeChangeTicketPopup(){document.getElementById("change-ticket-popup").style.display="none"}closeChangeUsefulLinkPopup(){document.getElementById("change-new-useful-link-popup").style.display="none"}closeChangeChatPopup(){document.getElementById("change-chat-popup").style.display="none"}changeTicket(){let r=document.getElementById("change-ticket-argomento-input").value,i=document.getElementById("change-ticket-description-input").value;L.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({argomento:r,descrizione:i},{merge:!0}).then(s=>{document.getElementById("change-ticket-popup").style.display="none",this.generalService.presentToast("Ticket salvato con successo")}).catch(s=>{this.generalService.presentToast("Errore durante il salvataggio del ticket: "+s.message)})}saveChat(){let r=document.getElementById("change-chat-name-input"),i=document.getElementById("change-chat-description-input");L.firestore().collection("chats").doc(this.generalService.currentChatId).set({name:r.value,description:i.value},{merge:!0}).then(()=>{document.getElementById("open-chat-name-display").innerText=r.value,document.getElementById("change-chat-popup").style.display="none",this.router.navigate(["/chat"],{queryParams:{id:this.generalService.currentChatId,name:r.value,description:i.value}}),this.generalService.presentToast("Chat modificata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante il salvataggio delle modifiche per la chat: "+s.message)})}sendTicketEmail(r){fetch("https://gestionale-backend-iqnz.onrender.com/email/addTicket",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ticket:r})}).then(i=>i.json()).then(i=>{console.log("Risposta dal server:",i)}).catch(i=>{console.error("Errore durante l'invio dell'email:",i)})}deleteTicket(){confirm("Sei sicuro di voler cancellare questo ticket e tutti i suoi allegati?")&&L.firestore().collection("tickets").doc(this.generalService.currentTicket.id).delete().then(()=>{if(this.generalService.currentTicket.storage_resource_path!=""){let r=fs(L.storage(),this.generalService.currentTicket.storage_resource_path);nu(r).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.getOpenTicketsNumber(),this.generalService.presentToast("Il ticket e i relativi allegati sono stati eliminati con successo")}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: 'DELETE FILE ERROR' "+i.message)}).catch(i=>{this.generalService.presentToast("Errore durante l'eliminazione del ticket: 'DELETE DOC ERROR' "+i.message)})}else document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.getOpenTicketsNumber(),this.generalService.presentToast("Il ticket e i relativi allegati sono stati eliminati con successo")})}openTicket(){L.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"open"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aperto con successo")}).catch(r=>{this.generalService.presentToast("Errore durante l'apertura del ticket: "+r.message)})}closeTicket(){L.firestore().collection("tickets").doc(this.generalService.currentTicket.id).set({status:"close"},{merge:!0}).then(()=>{document.getElementById("edit-menu-ticket-popup").style.display="none",this.generalService.presentToast("Ticket chiuso con successo")}).catch(r=>{this.generalService.presentToast("Errore durante la chiusura del ticket: "+r.message)})}addNewSector(){let r=document.getElementById("add-sector-name-input"),i=document.getElementById("add-sector-description-input");var s=L.auth().currentUser;L.firestore().collection("settori").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,timestamp:L.firestore.FieldValue.serverTimestamp(),creator_id:s.uid}).then(()=>{document.getElementById("add-new-sector-popup").style.display="none",this.generalService.presentToast("Settore aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del settore: "+o.message)})}addNewTicketLink(){let r=document.getElementById("add-ticket-label-input"),i=document.getElementById("add-ticket-link-input"),s=document.getElementById("add-ticket-links-container"),o={label:r.value,link:i.value};this.generalService.ticketLinkObject[`resource${this.generalService.ticketLinkCounter}`]=o;let a=document.createElement("div");a.className="card",a.id=`entry${this.generalService.ticketLinkCounter}`,a.style.paddingLeft="0.8rem",a.style.borderRadius="0.5rem";let c=document.createElement("div");c.className="card-body";let l=document.createElement("h5");l.className="card-title",l.innerText=r.value,l.style.marginTop="0.5rem",l.style.marginBottom="0.5rem";let d=document.createElement("a");d.className="card-link",d.href=i.value,d.innerText=i.value,d.target="_blank",d.style.marginBottom="0.5rem",c.appendChild(l),c.appendChild(d),a.appendChild(c),s.appendChild(a),this.generalService.ticketLinkCounter++,r.value="",i.value=""}addTicket(){let r=document.getElementById("add-ticket-argomento-input").value,i=document.getElementById("add-ticket-description-input").value,s=document.getElementById("ticket-fileInput2"),o=document.getElementById("ticket-uploadProgress"),a=document.getElementById("ticket-uploadStatus");var c=L.auth().currentUser;if(s.files&&s.files.length>0){let d=s.files[0];var l="ticket-files/"+d.name+"-date"+Date.now();let h=fs(L.storage(),l),p=eu(h,d);p.on("state_changed",_=>{let E=_.bytesTransferred/_.totalBytes*100;switch(o&&(o.value=E),a&&(a.textContent=`Caricamento: ${E.toFixed(2)}%`),_.state){case"paused":console.log("Caricamento in pausa");break;case"running":console.log("Caricamento in corso");break}},_=>{console.error("Errore nel caricamento:",_),a&&(a.textContent="Errore nel caricamento")},()=>{tu(p.snapshot.ref).then(_=>{this.ticketDownloadURL=_,a&&L.firestore().collection("tickets").doc().set({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:L.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.ticketLinkObject,links_counter:this.generalService.ticketLinkCounter,storage_resource_link:this.ticketDownloadURL,storage_resource_path:l}).then(()=>{document.getElementById("add-ticket-label-input").value="",document.getElementById("add-ticket-link-input").value="",document.getElementById("add-ticket-links-container").innerHTML="",document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo"),this.sendTicketEmail({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:L.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.ticketLinkObject,links_counter:this.generalService.ticketLinkCounter,storage_resource_link:this.ticketDownloadURL,storage_resource_path:l})}).catch(E=>{console.error(E),this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+E.message)})})})}else L.firestore().collection("tickets").doc().set({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:L.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.ticketLinkObject,links_counter:this.generalService.ticketLinkCounter,storage_resource_link:"",storage_resource_path:""}).then(()=>{document.getElementById("add-ticket-label-input").value="",document.getElementById("add-ticket-link-input").value="",document.getElementById("add-ticket-links-container").innerHTML="",document.getElementById("add-ticket-popup").style.display="none",this.generalService.presentToast("Ticket aggiunto con successo"),this.sendTicketEmail({argomento:r,descrizione:i,name:this.generalService.currentUser.name,surname:this.generalService.currentUser.surname,agencyName:this.generalService.currentUser.agencyName,email:c.email,creator_id:c.uid,timestamp:L.firestore.FieldValue.serverTimestamp(),status:"open",links:this.generalService.linkObject,links_counter:this.generalService.linkCounter,storage_resource_link:"",storage_resource_path:""})}).catch(d=>{console.error(d),this.generalService.presentToast("Errore durante l'aggiunta del ticket: "+d.message)})}addNewChat(){let r=document.getElementById("add-chat-name-input"),i=document.getElementById("add-chat-description-input");L.firestore().collection("chats").doc().set({name:r.value,name_query:r.value.toLowerCase(),description:i.value,creator_uid:this.generalService.currentUser.uid,creator_name:this.generalService.currentUser.name,creator_surname:this.generalService.currentUser.surname,timestamp:L.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-chat-name-input").value="",document.getElementById("add-chat-description-input").value="",document.getElementById("add-new-chat-popup").style.display="none",this.generalService.presentToast("Chat creata con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la creazione della chat: "+s.message)})}addNewUsefulLink(){let r=document.getElementById("add-useful-link-name-input"),i=document.getElementById("add-useful-link-description-input"),s=document.getElementById("add-useful-link-url-input");L.firestore().collection("useful_links").doc().set({name:r.value,description:i.value,url:s.value,timestamp:L.firestore.FieldValue.serverTimestamp()}).then(()=>{document.getElementById("add-new-useful-link-popup").style.display="none",this.generalService.presentToast("Link utile aggiunto con successo")}).catch(o=>{this.generalService.presentToast("Errore durante l'aggiunta del link utile: "+o.message)})}changeSector(){let r=document.getElementById("change-sector-popup-name-input"),i=document.getElementById("change-sector-popup-description-input");L.firestore().collection("settori").doc(this.generalService.currentSectorId).set({name:r.value,description:i.value},{merge:!0}).then(()=>{document.getElementById("sector-name").innerText=r.value,document.getElementById("sector-description").innerText=i.value,document.getElementById("change-sector-popup").style.display="none",this.generalService.presentToast("Settore modificato con successo")}).catch(s=>{this.generalService.presentToast("Errore durante la modifica del settore: "+s.message)})}changeLink(){let r=document.getElementById("change-useful-link-name-input"),i=document.getElementById("change-useful-link-description-input"),s=document.getElementById("change-useful-link-url-input");L.firestore().collection("useful_links").doc(this.generalService.currentLink.id).set({name:r.value,description:i.value,url:s.value},{merge:!0}).then(()=>{document.getElementById("change-new-useful-link-popup").style.display="none",this.generalService.presentToast("Modifiche salvate con successo")}).catch(o=>{this.generalService.presentToast("Errore durante il salvataggio delle modifiche del link: "+o.message)})}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-popups"]],decls:143,vars:1,consts:[["id","toast-message",2,"height","100%","width","100%","display","none","flex-direction","column","pointer-events","none","background","transparent","z-index","99999999","position","absolute","align-items","center","justify-content","end"],[1,"toastMessage",2,"pointer-events","all"],["id","toast-message-text",2,"width","100%"],["id","add-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","40rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","row","align-items","center","justify-content","space-between"],[1,"material-symbols-outlined","notranslate",2,"font-size","1.8rem","color","black","cursor","pointer",3,"click"],[2,"width","100%","display","flex","flex-direction","row","flex-wrap","wrap","gap","1rem"],[2,"width","100%","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],[2,"flex","1","min-width","15rem","display","flex","flex-direction","column","gap","1rem","margin-bottom","1rem"],["id","add-ticket-label-input","type","text","placeholder","Etichetta",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-ticket-link-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],[1,"button",3,"click"],["id","add-ticket-links-container",2,"display","flex","flex-direction","column","gap","0.5rem"],["id","ticket-fileInput2","type","file",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","padding-top","1rem"],["id","ticket-uploadProgress","value","0","max","100",2,"width","100%"],["id","ticket-uploadStatus"],["id","edit-menu-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"min-width","18rem","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],[2,"display","flex","flex-direction","column","gap","1rem"],["class","button",3,"click",4,"ngIf"],["id","open-ticket-button",1,"button",3,"click"],["id","close-ticket-button",1,"button",3,"click"],["id","add-new-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","change-chat-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-chat-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","change-chat-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","add-sector-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-sector-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","change-sector-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-sector-popup-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","change-sector-popup-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"],["id","add-new-useful-link-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],[1,"card",2,"max-width","30rem","width","100%","height","min-content","background","white","padding-bottom","1rem","padding-left","1rem","padding-right","1rem","margin-top","8rem","margin-bottom","3rem"],["id","add-useful-link-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","add-useful-link-description-input","type","text","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","min-height","5.5rem","border-radius","0.5rem","resize","vertical"],["id","add-useful-link-url-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","change-new-useful-link-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-useful-link-name-input","type","text","placeholder","Nome",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","change-useful-link-description-input","type","text","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","min-height","5.5rem","border-radius","0.5rem","resize","vertical"],["id","change-useful-link-url-input","type","text","placeholder","Link",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","change-ticket-popup",2,"width","100%","height","100%","display","none","justify-content","center","background","rgba(0, 0, 0, 0.282)","z-index","999","position","absolute","overflow-x","hidden","overflow-y","auto"],["id","change-ticket-argomento-input","type","text","placeholder","Argomento",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem"],["id","change-ticket-description-input","placeholder","Descrizione",2,"border-radius","2rem","border","1px solid rgba(0, 0, 0, 0.192)","padding-left","1rem","font-family","'Inter'","height","2.5rem","border-radius","0.5rem","resize","vertical","min-height","5rem"]],template:function(i,s){i&1&&(v(0,"div",0)(1,"div",1),te(2,"p",2),w()(),v(3,"div",3)(4,"div",4)(5,"h3",5),I(6,"Nuovo Ticket"),v(7,"span",6),j("click",function(){return s.closeAddTicketPopup()}),I(8,"close"),w()(),v(9,"div",7)(10,"div",8),te(11,"input",9)(12,"textarea",10),w(),v(13,"div",11),te(14,"input",12)(15,"input",13),v(16,"button",14),j("click",function(){return s.addNewTicketLink()}),I(17,"Aggiungi Risorsa"),w(),te(18,"div",15)(19,"input",16)(20,"progress",17)(21,"span",18),w()(),v(22,"div",5)(23,"button",14),j("click",function(){return s.closeAddTicketPopup()}),I(24,"Annulla"),w(),v(25,"button",14),j("click",function(){return s.addTicket()}),I(26,"Pubblica"),w()()()(),v(27,"div",19)(28,"div",20)(29,"h3",5),I(30,"Men\xF9 ticket"),v(31,"span",6),j("click",function(){return s.closeTicketMenuPopup()}),I(32,"close"),w()(),v(33,"div",21)(34,"button",14),j("click",function(){return s.openChangeTicketPopup()}),I(35,"Modifica"),w(),he(36,jne,2,0,"button",22),v(37,"button",23),j("click",function(){return s.openTicket()}),I(38,"Apri Ticket"),w(),v(39,"button",24),j("click",function(){return s.closeTicket()}),I(40,"Chiudi Ticket"),w()()()(),v(41,"div",25)(42,"div",20)(43,"h3",5),I(44,"Nuova Chat"),v(45,"span",6),j("click",function(){return s.closeAddNewChatPopup()}),I(46,"close"),w()(),v(47,"div",8),te(48,"input",26)(49,"textarea",27),w(),v(50,"div",5)(51,"button",14),j("click",function(){return s.closeAddNewChatPopup()}),I(52,"Annulla"),w(),v(53,"button",14),j("click",function(){return s.addNewChat()}),I(54,"Aggiungi"),w()()()(),v(55,"div",28)(56,"div",20)(57,"h3",5),I(58,"Modifica Chat"),v(59,"span",6),j("click",function(){return s.closeChangeChatPopup()}),I(60,"close"),w()(),v(61,"div",8),te(62,"input",29)(63,"textarea",30),w(),v(64,"div",5)(65,"button",14),j("click",function(){return s.closeChangeChatPopup()}),I(66,"Annulla"),w(),v(67,"button",14),j("click",function(){return s.saveChat()}),I(68,"Salva"),w()()()(),v(69,"div",31)(70,"div",20)(71,"h3",5),I(72,"Nuovo settore"),v(73,"span",6),j("click",function(){return s.closeAddNewSectorPopup()}),I(74,"close"),w()(),v(75,"div",8),te(76,"input",32)(77,"textarea",33),w(),v(78,"div",5)(79,"button",14),j("click",function(){return s.closeAddNewSectorPopup()}),I(80,"Annulla"),w(),v(81,"button",14),j("click",function(){return s.addNewSector()}),I(82,"Aggiungi"),w()()()(),v(83,"div",34)(84,"div",20)(85,"h3",5),I(86,"Modifica settore"),v(87,"span",6),j("click",function(){return s.closeChangeSectorPopup()}),I(88,"close"),w()(),v(89,"div",8),te(90,"input",35)(91,"textarea",36),w(),v(92,"div",5)(93,"button",14),j("click",function(){return s.closeChangeSectorPopup()}),I(94,"Annulla"),w(),v(95,"button",14),j("click",function(){return s.changeSector()}),I(96,"Salva"),w()()()(),v(97,"div",37)(98,"div",38)(99,"h3",5),I(100,"Nuovo link"),v(101,"span",6),j("click",function(){return s.closeAddNewUsefulLinkPopup()}),I(102,"close"),w()(),v(103,"div",7)(104,"div",11),te(105,"input",39)(106,"textarea",40)(107,"input",41),w()(),v(108,"div",5)(109,"button",14),j("click",function(){return s.closeAddNewUsefulLinkPopup()}),I(110,"Annulla"),w(),v(111,"button",14),j("click",function(){return s.addNewUsefulLink()}),I(112,"Conferma"),w()()()(),v(113,"div",42)(114,"div",38)(115,"h3",5),I(116,"Modifica link"),v(117,"span",6),j("click",function(){return s.closeChangeUsefulLinkPopup()}),I(118,"close"),w()(),v(119,"div",7)(120,"div",11),te(121,"input",43)(122,"textarea",44)(123,"input",45),w()(),v(124,"div",5)(125,"button",14),j("click",function(){return s.closeChangeUsefulLinkPopup()}),I(126,"Annulla"),w(),v(127,"button",14),j("click",function(){return s.changeLink()}),I(128,"Salva"),w()()()(),v(129,"div",46)(130,"div",38)(131,"h3",5),I(132,"Modifica Ticket"),v(133,"span",6),j("click",function(){return s.closeChangeTicketPopup()}),I(134,"close"),w()(),v(135,"div",8),te(136,"input",47)(137,"textarea",48),w(),v(138,"div",5)(139,"button",14),j("click",function(){return s.closeChangeTicketPopup()}),I(140,"Annulla"),w(),v(141,"button",14),j("click",function(){return s.changeTicket()}),I(142,"Salva"),w()()()()),i&2&&(F(36),G("ngIf",s.generalService.isAdmin==!0))},dependencies:[Wt]});let n=e;return n})();function Hne(n,e){n&1&&(v(0,"span",6),I(1,"menu"),w())}function zne(n,e){n&1&&(v(0,"span",6),I(1,"close"),w())}var p$=(()=>{let e=class e{constructor(r,i){this.generalService=r,this.router=i,this.title="app",this.initFirebase(),this.generalService.getUserData()}ngOnInit(){L.auth().onAuthStateChanged(r=>{r?(this.getUserPremissionState(),this.generalService.sidebarOpen=!0):(this.generalService.sidebarOpen=!1,this.router.navigate(["/login"]))})}getUserPremissionState(){return g(this,null,function*(){let i=L.auth().currentUser;i?(yield i.getIdTokenResult()).claims.role=="admin"?this.generalService.isAdmin=!0:this.generalService.isAdmin=!1:(this.router.navigate(["/login"]),console.log("Log in to fetch your current user permission state"),this.generalService.presentToast("Utente non loggato"))})}initFirebase(){let r={apiKey:"AIzaSyDDHTEBrsp3FEjAwcIRQ4VfIGMyi4mXvz4",authDomain:"gestionale-57acc.firebaseapp.com",databaseURL:"https://gestionale-57acc-default-rtdb.europe-west1.firebasedatabase.app",projectId:"gestionale-57acc",storageBucket:"gestionale-57acc.firebasestorage.app",messagingSenderId:"197843860118",appId:"1:197843860118:web:84fdf3618985abf469e0b7",measurementId:"G-LEMKV1J9QD"};L.initializeApp(r)}openCloseSidebar(){this.generalService.openCloseSidebar()}};e.\u0275fac=function(i){return new(i||e)(Z(Ke),Z(it))},e.\u0275cmp=$e({type:e,selectors:[["app-root"]],decls:9,vars:3,consts:[[2,"height","100%","width","100%","display","flex","flex-direction","column","align-items","end","justify-content","end","position","absolute","z-index","9999999999999","pointer-events","none"],[2,"height","3rem","width","3rem","flex-shrink","0","border-radius","50%","background","#0f0f0f","pointer-events","all","margin-right","1rem","margin-bottom","1rem","color","whitesmoke","display","flex","flex-direction","column","align-items","center","justify-content","center","cursor","pointer",3,"click"],["class","material-symbols-outlined notranslate",4,"ngIf"],[2,"width","100%","height","100%","display","flex","flex-direction","row"],[3,"hidden"],[2,"height","100%","flex","1"],[1,"material-symbols-outlined","notranslate"]],template:function(i,s){i&1&&(te(0,"app-popups"),v(1,"div",0)(2,"div",1),j("click",function(){return s.generalService.openCloseSidebar()}),he(3,Hne,2,0,"span",2)(4,zne,2,0,"span",2),w()(),v(5,"div",3),te(6,"app-sidebar",4),v(7,"div",5),te(8,"router-outlet"),w()()),i&2&&(F(3),G("ngIf",!s.generalService.sidebarOpen),F(),G("ngIf",s.generalService.sidebarOpen),F(2),G("hidden",!s.generalService.sidebarOpen))},dependencies:[Wt,dI,h$,f$]});let n=e;return n})();var m$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$n({type:e,bootstrap:[p$]}),e.\u0275inj=jn({providers:[{provide:Ur,useClass:$m}],imports:[F1,Xj,d$]});let n=e;return n})();O1().bootstrapModule(m$).catch(n=>console.error(n));
